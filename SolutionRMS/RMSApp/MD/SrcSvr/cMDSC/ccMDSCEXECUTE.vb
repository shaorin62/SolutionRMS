'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커 - 한화 S&C
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccMDCMEXECUTE.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2004-03-30 오전 10:32:13 By MakeSFARV.2.0.0
'                  2) 2004-03-30 오전 10:32:13 By 작성자명을 씁니다.
'****************************************************************************************

Imports System.Xml                        ' XML처리 
Imports SCGLControl                       ' ControlClass의 Base Class 
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr            '오류처리 클래스
Imports SCGLUtil.cbSCGLXml           'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil            '기타유틸리티 클래스
Imports System.Math

' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트

Public Class ccMDSCEXECUTE
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccMDSCEXECUTE"                  '자신의 클래스명
#End Region

#Region "GROUP BLOCK : Property 선언"
#End Region

#Region "GROUP BLOCK : Event 선언"
#End Region


#Region "21. 인쇄 매체의 광고주 선택 조회"

    ' =============== SelectRtnSample Code
    Public Function GetPRINTCLIENT_LIST(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByVal strFPUB_DATE As String, _
                                        ByVal strTPUB_DATE As String, _
                                        ByVal strCLIENTCODE As String, _
                                        ByVal strCLIENTNAME As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3, Con4 As String
        Dim vntData As Object
        Dim strFPUB_DATE1, strTPUB_DATE1

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = ""

                strFPUB_DATE1 = Replace(strFPUB_DATE, "-", "")
                strTPUB_DATE1 = Replace(strTPUB_DATE, "-", "")

                If strFPUB_DATE1 <> "" Then Con1 = String.Format(" AND (PUB_DATE >= '{0}')", strFPUB_DATE1)
                If strTPUB_DATE1 <> "" Then Con2 = String.Format(" AND (PUB_DATE <= '{0}')", strTPUB_DATE1)
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTNAME <> "" Then Con4 = String.Format(" AND (DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) LIKE '%{0}%')", strCLIENTNAME)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4)

                strFormet = "   SELECT '" & strFPUB_DATE & "' FPUB_DATE, '" & strTPUB_DATE & "' TPUB_DATE, "
                strFormet = strFormet & "   CLIENTCODE,"
                strFormet = strFormet & "   DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "   WHERE 1=1 AND GFLAG IN('J','S') AND TRU_TRANS_NO IS NOT NULL {0}"
                strFormet = strFormet & "   GROUP BY CLIENTCODE"
                strFormet = strFormet & "   ORDER BY "
                strFormet = strFormet & "   CASE SUBSTRING(LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)),1,3) "
                strFormet = strFormet & "   WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)))) "
                strFormet = strFormet & "   WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & "   WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & "   WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & "   WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),5,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & "   WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & "   ELSE LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)) END"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTCLIENT_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "22. 인쇄 매체의 매체명 선택 조회"

    ' =============== SelectRtnSample Code
    Public Function GetPRINTMED_LIST(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strFPUB_DATE As String, _
                                     ByVal strTPUB_DATE As String, _
                                     ByVal strMEDCODE As String, _
                                     ByVal strMEDNAME As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3, Con4 As String
        Dim vntData As Object
        Dim strFPUB_DATE1, strTPUB_DATE1

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = ""

                strFPUB_DATE1 = Replace(strFPUB_DATE, "-", "")
                strTPUB_DATE1 = Replace(strTPUB_DATE, "-", "")

                If strFPUB_DATE1 <> "" Then Con1 = String.Format(" AND (PUB_DATE >= '{0}')", strFPUB_DATE1)
                If strTPUB_DATE1 <> "" Then Con2 = String.Format(" AND (PUB_DATE <= '{0}')", strTPUB_DATE1)
                If strMEDCODE <> "" Then Con3 = String.Format(" AND (MEDCODE = '{0}')", strMEDCODE)
                If strMEDNAME <> "" Then Con4 = String.Format(" AND (DBO.SC_GET_CUSTNAME_FUN(MEDCODE) LIKE '%{0}%')", strMEDNAME)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4)

                strFormet = "   SELECT '" & strFPUB_DATE & "' FPUB_DATE, '" & strTPUB_DATE & "' TPUB_DATE, "
                strFormet = strFormet & "   MEDCODE,"
                strFormet = strFormet & "   DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "   WHERE 1=1 AND GFLAG IN('J','S') AND TRU_TRANS_NO IS NOT NULL {0}"
                strFormet = strFormet & "   GROUP BY MEDCODE"
                strFormet = strFormet & "   ORDER BY "
                strFormet = strFormet & "   CASE SUBSTRING(LTRIM(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)),1,3) "
                strFormet = strFormet & "   WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)))) "
                strFormet = strFormet & "   WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                strFormet = strFormet & "   WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                strFormet = strFormet & "   WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                strFormet = strFormet & "   WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),5,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                strFormet = strFormet & "   WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                strFormet = strFormet & "   ELSE LTRIM(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)) END"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTCLIENT_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "23. 인쇄 매체의 팀 선택 조회"

    ' =============== SelectRtnSample Code
    Public Function GetPRINTTIM_LIST(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strFPUB_DATE As String, _
                                     ByVal strTPUB_DATE As String, _
                                     ByVal strCLIENTCODE As String, _
                                     ByVal strCLIENTNAME As String, _
                                     ByVal strTIMCODE As String, _
                                     ByVal strTIMNAME As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3, Con4, Con5, Con6 As String
        Dim vntData As Object
        Dim strFPUB_DATE1, strTPUB_DATE1

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = "" : Con5 = "" : Con6 = ""

                strFPUB_DATE1 = Replace(strFPUB_DATE, "-", "")
                strTPUB_DATE1 = Replace(strTPUB_DATE, "-", "")

                If strFPUB_DATE1 <> "" Then Con1 = String.Format(" AND (PUB_DATE >= '{0}')", strFPUB_DATE1)
                If strTPUB_DATE1 <> "" Then Con2 = String.Format(" AND (PUB_DATE <= '{0}')", strTPUB_DATE1)
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTNAME <> "" Then Con4 = String.Format(" AND (DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) LIKE '%{0}%')", strCLIENTNAME)
                If strTIMCODE <> "" Then Con5 = String.Format(" AND (TIMCODE = '{0}')", strTIMCODE)
                If strTIMNAME <> "" Then Con6 = String.Format(" AND (DBO.SC_GET_CUSTNAME_FUN(TIMCODE) LIKE '%{0}%')", strTIMNAME)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5, Con6)

                strFormet = "   SELECT '" & strFPUB_DATE & "' FPUB_DATE, '" & strTPUB_DATE & "' TPUB_DATE, "
                strFormet = strFormet & "   TIMCODE,"
                strFormet = strFormet & "   DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME,"
                strFormet = strFormet & "   CLIENTCODE,"
                strFormet = strFormet & "   DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "   WHERE 1=1 AND GFLAG IN('J','S') AND TRU_TRANS_NO IS NOT NULL {0}"
                strFormet = strFormet & "   GROUP BY TIMCODE, CLIENTCODE"
                strFormet = strFormet & "   ORDER BY "
                strFormet = strFormet & "   CASE SUBSTRING(LTRIM(DBO.SC_GET_CUSTNAME_FUN(TIMCODE)),1,3) "
                strFormet = strFormet & "   WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE)))) "
                strFormet = strFormet & "   WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE))))"
                strFormet = strFormet & "   WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE))))"
                strFormet = strFormet & "   WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE))))"
                strFormet = strFormet & "   WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),5,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE))))"
                strFormet = strFormet & "   WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(TIMCODE))))"
                strFormet = strFormet & "   ELSE LTRIM(DBO.SC_GET_CUSTNAME_FUN(TIMCODE)) END"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTTIM_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "5. 월간 집행 개요"
    Public Function SelectRtn_PRINTMONEXE_VOCH(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal strYEAR As String, _
                                               ByVal strMEDFLAG As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                If strMEDFLAG <> "" Then Con2 = String.Format(" AND (MED_FLAG = '{0}')", strMEDFLAG)


                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT "
                strFormet = strFormet & "  VOCH_TYPE,"
                strFormet = strFormet & "  VOCH_TYPENAME,"
                strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "  	SELECT "
                strFormet = strFormet & " 	VOCH_TYPE,"
                strFormet = strFormet & " 	CASE VOCH_TYPE "
                strFormet = strFormet & " 	WHEN '0' THEN '위수탁'"
                strFormet = strFormet & " 	WHEN '1' THEN '협찬'"
                strFormet = strFormet & " 	WHEN '2' THEN '일반'"
                strFormet = strFormet & " 	END AS VOCH_TYPENAME, "
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "  	SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "  	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "  	WHERE 1=1 "
                strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                strFormet = strFormet & " 	{0} "
                strFormet = strFormet & "  	GROUP BY VOCH_TYPE"
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by VOCH_TYPE"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTMONEXE_VOCH")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_PRINTMONEXE_DTL(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strVOCH_TYPE As String, _
                                              ByVal strFLAG As String, _
                                              ByVal strMEDFLAG As String, _
                                              ByVal strCOMMISSION As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = "" : Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)
                If strVOCH_TYPE <> "" Then Con2 = String.Format(" AND (VOCH_TYPE = '{0}')", strVOCH_TYPE)

                If strMEDFLAG <> "" Then Con3 = String.Format(" AND (MED_FLAG = '{0}')", strMEDFLAG)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                If strFLAG = "CUST" Then
                    If strCOMMISSION = True Then
                        strFormet = " SELECT "
                        strFormet = strFormet & "  CUSTNAME,"
                        strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                        strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                        strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                        strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                        strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                        strFormet = strFormet & "  FROM ("
                        strFormet = strFormet & "  	SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, "
                        strFormet = strFormet & "  	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME2, "
                        strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(COMMISSION,0) ELSE 0 END) A1,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(COMMISSION,0) ELSE 0 END) A2,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(COMMISSION,0) ELSE 0 END) A3,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(COMMISSION,0) ELSE 0 END) A4,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(COMMISSION,0) ELSE 0 END) A5,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(COMMISSION,0) ELSE 0 END) A6,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(COMMISSION,0) ELSE 0 END) A7,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(COMMISSION,0) ELSE 0 END) A8,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(COMMISSION,0) ELSE 0 END) A9,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(COMMISSION,0) ELSE 0 END) A10,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(COMMISSION,0) ELSE 0 END) A11,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(COMMISSION,0) ELSE 0 END) A12,"
                        strFormet = strFormet & "  	SUM(ISNULL(COMMISSION,0)) SUMAMT"
                        strFormet = strFormet & "  	FROM MD_BOOKING_MEDIUM"
                        strFormet = strFormet & "  	WHERE 1=1 "
                        strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                        strFormet = strFormet & " 	{0} "
                        strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                        strFormet = strFormet & "  ) AAA "
                        strFormet = strFormet & "  order by CUSTNAME2"
                    Else
                        strFormet = " SELECT "
                        strFormet = strFormet & "  CUSTNAME,"
                        strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                        strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                        strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                        strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                        strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                        strFormet = strFormet & "  FROM ("
                        strFormet = strFormet & "  	SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, "
                        strFormet = strFormet & "  	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME2, "
                        strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                        strFormet = strFormet & "  	SUM(ISNULL(AMT,0)) SUMAMT"
                        strFormet = strFormet & "  	FROM MD_BOOKING_MEDIUM"
                        strFormet = strFormet & "  	WHERE 1=1 "
                        strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                        strFormet = strFormet & " 	{0} "
                        strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                        strFormet = strFormet & "  ) AAA "
                        strFormet = strFormet & "  order by CUSTNAME2"
                    End If

                Else
                    If strCOMMISSION = True Then
                        strFormet = " SELECT "
                        strFormet = strFormet & "  CUSTNAME,"
                        strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                        strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                        strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                        strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                        strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                        strFormet = strFormet & "  FROM ("
                        strFormet = strFormet & "  	SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUSTNAME, "
                        strFormet = strFormet & "  	DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUSTNAME2, "
                        strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(COMMISSION,0) ELSE 0 END) A1,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(COMMISSION,0) ELSE 0 END) A2,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(COMMISSION,0) ELSE 0 END) A3,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(COMMISSION,0) ELSE 0 END) A4,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(COMMISSION,0) ELSE 0 END) A5,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(COMMISSION,0) ELSE 0 END) A6,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(COMMISSION,0) ELSE 0 END) A7,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(COMMISSION,0) ELSE 0 END) A8,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(COMMISSION,0) ELSE 0 END) A9,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(COMMISSION,0) ELSE 0 END) A10,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(COMMISSION,0) ELSE 0 END) A11,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(COMMISSION,0) ELSE 0 END) A12,"
                        strFormet = strFormet & "  	SUM(ISNULL(COMMISSION,0)) SUMAMT"
                        strFormet = strFormet & "  	FROM MD_BOOKING_MEDIUM"
                        strFormet = strFormet & "  	WHERE 1=1 "
                        strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                        strFormet = strFormet & " 	{0} "
                        strFormet = strFormet & "  	GROUP BY REAL_MED_CODE"
                        strFormet = strFormet & "  ) AAA "
                        strFormet = strFormet & "  order by CUSTNAME2"
                    Else
                        strFormet = " SELECT "
                        strFormet = strFormet & "  CUSTNAME,"
                        strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                        strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                        strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                        strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                        strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                        strFormet = strFormet & "  FROM ("
                        strFormet = strFormet & "  	SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUSTNAME, "
                        strFormet = strFormet & "  	DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUSTNAME2, "
                        strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                        strFormet = strFormet & "  	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                        strFormet = strFormet & "  	SUM(ISNULL(AMT,0)) SUMAMT"
                        strFormet = strFormet & "  	FROM MD_BOOKING_MEDIUM"
                        strFormet = strFormet & "  	WHERE 1=1 "
                        strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                        strFormet = strFormet & " 	{0} "
                        strFormet = strFormet & "  	GROUP BY REAL_MED_CODE"
                        strFormet = strFormet & "  ) AAA "
                        strFormet = strFormet & "  order by CUSTNAME2"
                    End If
                End If


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTMONEXE_DTL")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "5. 월간 매체사별 집행현황"
    Public Function SelectRtn_PRINTMONREALLIST(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal strYEAR As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = " SELECT REAL_MED_NAME,MEDCODE,MEDNAME,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,SUMAMT FROM "
                strFormet = strFormet & " ("
                strFormet = strFormet & " 	SELECT	 "
                strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & " 	MEDCODE,"
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE 1=1 "
                strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                strFormet = strFormet & " 	{0} "
                strFormet = strFormet & " 	GROUP BY MEDCODE,DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & " 	'ZZZZ' MEDCODE,"
                strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) + '(소계)' MEDNAME,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE 1=1 "
                strFormet = strFormet & " 	AND GFLAG IN('J','S')"
                strFormet = strFormet & " 	{0} "
                strFormet = strFormet & " 	GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)"
                strFormet = strFormet & " ) A"
                strFormet = strFormet & " GROUP BY REAL_MED_NAME,MEDCODE,MEDNAME,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,SUMAMT"
                strFormet = strFormet & " "
                strFormet = strFormet & " UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " '(총계)' REAL_MED_NAME,"
                strFormet = strFormet & " 	'ZZZZ' MEDCODE,"
                strFormet = strFormet & " 	'' MEDNAME,"
                strFormet = strFormet & " SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " WHERE 1=1 "
                strFormet = strFormet & " AND GFLAG IN('J','S')"
                strFormet = strFormet & " {0} "

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTMONREALLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_INTERNETMONREALLIST(ByVal strInfoXML As String, _
                                                  ByRef intRowCnt As Integer, _
                                                  ByRef intColCnt As Integer, _
                                                  ByVal strYEAR As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = "  SELECT "
                strFormet = strFormet & "  REAL_MED_NAME,"
                strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "       SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & "       DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_INTERNET_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(TRU_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "       GROUP BY REAL_MED_CODE"
                strFormet = strFormet & "       UNION ALL"
                strFormet = strFormet & "       SELECT '합계' REAL_MED_NAME,"
                strFormet = strFormet & "       'ZZZZZZZZZZ' REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_INTERNET_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(TRU_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by REAL_MED_NAME2"
                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTMONREALLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_CATVMONREALLIST(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal strYEAR As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = "  SELECT "
                strFormet = strFormet & "  REAL_MED_NAME,"
                strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "       SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & "       DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_CATV_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(TRU_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "       GROUP BY REAL_MED_CODE"
                strFormet = strFormet & "       UNION ALL"
                strFormet = strFormet & "       SELECT '합계' REAL_MED_NAME,"
                strFormet = strFormet & "       'ZZZZZZZZZZ' REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_CATV_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(TRU_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by REAL_MED_NAME2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTMONREALLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_OUTDOORMONREALLIST(ByVal strInfoXML As String, _
                                                 ByRef intRowCnt As Integer, _
                                                 ByRef intColCnt As Integer, _
                                                 ByVal strYEAR As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = "  SELECT "
                strFormet = strFormet & "  REAL_MED_NAME,"
                strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "       SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & "       DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_OUTDOOR_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "       GROUP BY REAL_MED_CODE"
                strFormet = strFormet & "       UNION ALL"
                strFormet = strFormet & "       SELECT '합계' REAL_MED_NAME,"
                strFormet = strFormet & "       'ZZZZZZZZZZ' REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_OUTDOOR_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by REAL_MED_NAME2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_OUTDOORMONREALLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_OUTDOORMONOUTALLLIST(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strYEAR As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = "  SELECT "
                strFormet = strFormet & "  REAL_MED_NAME,"
                strFormet = strFormet & "  ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & "  ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & "  ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & "  ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & "  ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "       SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
                strFormet = strFormet & "       DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(OUT_AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_OUTDOOR_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "       GROUP BY REAL_MED_CODE"
                strFormet = strFormet & "       UNION ALL"
                strFormet = strFormet & "       SELECT '합계' REAL_MED_NAME,"
                strFormet = strFormet & "       'ZZZZZZZZZZ' REAL_MED_NAME2,"
                strFormet = strFormet & "       SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & "       SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(OUT_AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & "       SUM(ISNULL(OUT_AMT,0)) SUMAMT"
                strFormet = strFormet & "       FROM MD_OUTDOOR_MEDIUM"
                strFormet = strFormet & "       WHERE 1=1 "
                strFormet = strFormet & "       AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & "       {0}"
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by REAL_MED_NAME2"
                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_OUTDOORMONOUTALLLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    'MPP 별 월간 광고내역 
    Public Function SelectRtn_MPPLIST(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByVal strYEAR As String) As Object

        Dim strSQL As String
        Dim strFormet As String
        Dim strWhere As String
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1)

                strFormet = " SELECT"
                strFormet = strFormet & " MPP_NAME,CLIENTNAME,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	SELECT  "
                strFormet = strFormet & " 	DENSE_RANK()OVER(ORDER BY ISNULL(MPP,'') DESC) RANK,"
                strFormet = strFormet & " 	CASE ISNULL(MPP,'') WHEN '' THEN '기타' ELSE DBO.SC_GET_HIGHCUSTNAME_FUN(ISNULL(MPP,'')) END MPP_NAME,"
                strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME ,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT,"
                strFormet = strFormet & " 	'1' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CATV_MEDIUM"
                strFormet = strFormet & " 	WHERE 1=1"
                strFormet = strFormet & " 	AND (ISNULL(TRU_TAX_NO,'') <> '' OR ISNULL(COMMI_TAX_NO,'')<>'')"
                strFormet = strFormet & "   {0}"
                strFormet = strFormet & " 	GROUP BY ISNULL(MPP,''), CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT  "
                strFormet = strFormet & " 	'' RANK,"
                strFormet = strFormet & " 	'총계' MPP_NAME,"
                strFormet = strFormet & " 	'' CLIENTNAME ,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT,"
                strFormet = strFormet & " 	'2' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CATV_MEDIUM"
                strFormet = strFormet & " 	WHERE 1=1"
                strFormet = strFormet & " 	AND (ISNULL(TRU_TAX_NO,'') <> '' OR ISNULL(COMMI_TAX_NO,'')<>'')"
                strFormet = strFormet & "   {0}"
                strFormet = strFormet & " ) A "
                strFormet = strFormet & " ORDER BY SORTGBN , RANK"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MPPLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


#End Region

#Region "6. 케이블 계열/비계열 집행현황"
    '광고주별 계열구분 광고비 내역
    Public Function SelectRtn_CATVCUSTLIST(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByVal strYEAR As String, _
                                           ByVal strCLIENTCODE As String, _
                                           ByVal strCUSTTYPE As String) As Object
        Dim strSQL As String
        Dim strFormet As String
        Dim strWhere As String
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = "" : Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(A.DEMANDDAY,1,4) = '{0}')", strYEAR)
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (A.CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCUSTTYPE <> "" Then Con3 = String.Format(" AND (B.CUSTTYPE = '{0}')", strCUSTTYPE)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = " SELECT "
                strFormet = strFormet & " CLIENTCODE,"
                strFormet = strFormet & " CLIENTNAME,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & " SUMAMT"
                strFormet = strFormet & " FROM "
                strFormet = strFormet & " ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	A.CLIENTCODE,"
                strFormet = strFormet & " 	B.CUSTNAME CLIENTNAME,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '01' THEN ISNULL(A.AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '02' THEN ISNULL(A.AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '03' THEN ISNULL(A.AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '04' THEN ISNULL(A.AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '05' THEN ISNULL(A.AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '06' THEN ISNULL(A.AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '07' THEN ISNULL(A.AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '08' THEN ISNULL(A.AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '09' THEN ISNULL(A.AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '10' THEN ISNULL(A.AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '11' THEN ISNULL(A.AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '12' THEN ISNULL(A.AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(A.AMT,0))SUMAMT,"
                strFormet = strFormet & " 	'1' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CATV_MEDIUM A "
                strFormet = strFormet & " 	LEFT JOIN SC_CUST_HDR B ON A.CLIENTCODE = B.HIGHCUSTCODE "
                strFormet = strFormet & " 	AND B.MEDFLAG = 'A'"
                strFormet = strFormet & " 	WHERE 1=1 "
                strFormet = strFormet & " 	{0}	"
                strFormet = strFormet & " 	AND (ISNULL(A.TRU_TAX_NO,'') <> '' OR ISNULL(A.COMMI_TAX_NO,'')<>'')"
                strFormet = strFormet & " 	GROUP BY A.CLIENTCODE, B.CUSTNAME"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	'' CLIENTCODE,"
                strFormet = strFormet & " 	'총 계' CLIENTNAME,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '01' THEN ISNULL(A.AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '02' THEN ISNULL(A.AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '03' THEN ISNULL(A.AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '04' THEN ISNULL(A.AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '05' THEN ISNULL(A.AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '06' THEN ISNULL(A.AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '07' THEN ISNULL(A.AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '08' THEN ISNULL(A.AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '09' THEN ISNULL(A.AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '10' THEN ISNULL(A.AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '11' THEN ISNULL(A.AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE when SUBSTRING(A.DEMANDDAY,5,2) = '12' THEN ISNULL(A.AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(A.AMT,0))SUMAMT,"
                strFormet = strFormet & " 	'2' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CATV_MEDIUM A "
                strFormet = strFormet & " 	LEFT JOIN SC_CUST_HDR B ON A.CLIENTCODE = B.HIGHCUSTCODE "
                strFormet = strFormet & " 	AND B.MEDFLAG = 'A'"
                strFormet = strFormet & " 	WHERE 1=1"
                strFormet = strFormet & " 	{0}	"
                strFormet = strFormet & " 	AND (ISNULL(A.TRU_TAX_NO,'') <> '' OR ISNULL(A.COMMI_TAX_NO,'')<>'')"
                strFormet = strFormet & " )A "
                strFormet = strFormet & " ORDER BY SORTGBN, CLIENTNAME"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CATVCUSTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "7. 월간 클라우드 광고주별 집행현황"

    Public Function SelectRtn_CLOUDCLIENT(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal strYEAR As String, _
                                               ByVal strCLIENTCODE As String, _
                                               ByVal strCLIENTNAME As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim Con1, Con2 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = "" : Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTNAME <> "" Then Con2 = String.Format(" AND (CLIENTNAME LIKE '%{0}%')", strCLIENTNAME)

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT "
                strFormet = strFormet & " CLIENTCODE,CLIENTNAME,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,SUMAMT"
                strFormet = strFormet & " FROM "
                strFormet = strFormet & " ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	CLIENTCODE,"
                strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, '1' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CLOUD_AMT"
                strFormet = strFormet & " 	WHERE 1=1"
                strFormet = strFormet & " 	AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & " 	AND SUBSTRING(DEMANDDAY,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	'' CLIENTCODE,"
                strFormet = strFormet & " 	'합 계' CLIENTNAME,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(DEMANDDAY,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, '2' SORTGBN"
                strFormet = strFormet & " 	FROM MD_CLOUD_AMT"
                strFormet = strFormet & " 	WHERE 1=1"
                strFormet = strFormet & " 	AND ISNULL(COMMI_TRANS_NO,'') <> ''"
                strFormet = strFormet & " 	AND SUBSTRING(DEMANDDAY,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & " )A "
                strFormet = strFormet & " WHERE 1=1"
                strFormet = strFormet & " {0}"
                strFormet = strFormet & " ORDER BY SORTGBN, CLIENTNAME"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLOUDCLIENT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : 외부에 공개 Method"

    ' =============== SelectRtnSample Code
    Public Function SelectRtn_Client(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strFPUB_DATE As String, _
                                     ByVal strTPUB_DATE As String, _
                                     ByVal strCLIENTCODE As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strFPUB_DATE <> "" Then Con1 = "AND PUB_DATE >='" & strFPUB_DATE.Substring(0, 4) & strFPUB_DATE.Substring(5, 2) & strFPUB_DATE.Substring(8, 2) & "'"
                If strTPUB_DATE <> "" Then Con2 = "AND PUB_DATE <='" & strTPUB_DATE.Substring(0, 4) & strTPUB_DATE.Substring(5, 2) & strTPUB_DATE.Substring(8, 2) & "'"
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = " SELECT PUB_DATE , REAL_MED_CODE, SC_GET_HIGHCOMPANYNAME_FUN(REAL_MED_CODE) REAL_MED_NAME , PROGRAM_NAME , COL_DEG , PUB_FACE ,"
                strFormet = strFormet & " MD_GETPUBNAME_FUN(PUB_FACE) PUB_FACENAME,  "
                strFormet = strFormet & " DECODE(STD_STEP,'','', STD_STEP || '단') || DECODE(STD_CM,'','', STD_CM || 'cm') STD,"
                strFormet = strFormet & " PRICE , AMOUNT , NOTE, 1 SORTGBN"
                strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " WHERE 1=1 AND GFLAG IN('J','S') AND TRU_TRANS_NO IS NOT NULL {0} "
                strFormet = strFormet & " UNION ALL "
                strFormet = strFormet & " SELECT '' PUB_DATE ,  REAL_MED_CODE, '' REAL_MED_NAME , '' PROGRAM_NAME , '' COL_DEG , '' PUB_FACE ,"
                strFormet = strFormet & " SC_GET_HIGHCOMPANYNAME_FUN(REAL_MED_CODE)  PUB_FACENAME,  "
                strFormet = strFormet & " '소계' STD,"
                strFormet = strFormet & " NULL PRICE , SUM(AMOUNT) , '' NOTE , 2 SORTGBN"
                strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " WHERE 1=1 AND GFLAG IN('J','S') AND TRU_TRANS_NO IS NOT NULL {0} "
                strFormet = strFormet & " GROUP BY REAL_MED_CODE"
                strFormet = strFormet & " ORDER BY REAL_MED_CODE, SORTGBN "

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_PUBDATALIST(ByVal strInfoXML As String, _
                                          ByRef intRowCnt As Integer, _
                                          ByRef intColCnt As Integer, _
                                          ByVal strFPUB_DATE As String, _
                                          ByVal strTPUB_DATE As String, _
                                          ByVal strCLIENTCODE As String, _
                                          ByVal strMEDCODE As String, _
                                          ByVal strCLIENTSUBCODE As String, _
                                          ByVal strMEDFLAG As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3, Con4, Con5 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""
                Con4 = ""
                Con5 = ""

                If strFPUB_DATE <> "" Then Con1 = "AND PUB_DATE >='" & strFPUB_DATE.Substring(0, 4) & strFPUB_DATE.Substring(5, 2) & strFPUB_DATE.Substring(8, 2) & "'"
                If strTPUB_DATE <> "" Then Con2 = "AND PUB_DATE <='" & strTPUB_DATE.Substring(0, 4) & strTPUB_DATE.Substring(5, 2) & strTPUB_DATE.Substring(8, 2) & "'"
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strMEDCODE <> "" Then Con4 = String.Format(" AND (MEDCODE = '{0}')", strMEDCODE)
                If strCLIENTSUBCODE <> "" Then Con5 = String.Format(" AND (CLIENTSUBCODE = '{0}')", strCLIENTSUBCODE)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5)

                If strMEDFLAG = "MP01" Then
                    strFormet = " SELECT PUB_DATE , DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, PROGRAM_NAME , STD_STEP, '단' DAN, STD_CM, COL_DEG, AMOUNT"
                    strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                    strFormet = strFormet & " WHERE 1=1 AND GFLAG IN('J','S') AND ISNULL(TRU_TRANS_NO,'') <> '' {0} "
                    strFormet = strFormet & " AND MED_FLAG = 'MP01' "
                    strFormet = strFormet & " ORDER BY PUB_DATE "
                Else
                    strFormet = " SELECT PUB_DATE , DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, PROGRAM_NAME , STD, STD_STEP, 'P' PAGE , COL_DEG, AMOUNT"
                    strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                    strFormet = strFormet & " WHERE 1=1 AND GFLAG IN('J','S') AND ISNULL(TRU_TRANS_NO,'') <> '' {0} "
                    strFormet = strFormet & " AND MED_FLAG = 'MP02' "
                    strFormet = strFormet & " ORDER BY PUB_DATE "
                End If

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PUBDATALIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_CLIENTSUBCNT(ByVal strInfoXML As String, _
                                           ByVal strYEARMON As String, _
                                           ByVal strWhere As String) As String
        Dim strSQL As String
        Dim strFormat As String
        Dim strRtn

        SetConfig(strInfoXML)

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                strFormat = strFormat & " select isnull(count(*),0) cnt"
                strFormat = strFormat & " from ("
                strFormat = strFormat & " 	SELECT YEARMON,"
                strFormat = strFormat & " 	DBO.SC_GET_CUSTNAME_FUN(TIMCODE) CLIENTSUBNAME"
                strFormat = strFormat & " 	FROM MD_REPORT_MST_V"
                strFormat = strFormat & " 	WHERE 1=1"
                strFormat = strFormat & " 	AND yearmon = '" & strYEARMON & "'"
                strFormat = strFormat & " 	{0} "
                strFormat = strFormat & " 	GROUP BY YEARMON, TIMCODE"
                strFormat = strFormat & " ) aaa"

                strSQL = String.Format(strFormat, strWhere)

                ' ------ Array 데이터 조회 (True 일때 헤더정보 포함 조회(Sheet Data Binding 할 경우 사용), False 일때 데이터만 조회)
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)
                Return strRtn
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTSUBCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function




    Public Function SelectRtn_MONAMTLIST(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strYEARMONLIST As String, _
                                         ByVal strCLIENTCODE As String, _
                                         ByVal strCLIENTSUBLIST As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strFormet2, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim objYEARMON
        Dim intCUSTRows
        Dim i
        Dim intcnt
        Dim strSQLtemp

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTSUBLIST <> "" Then Con2 = String.Format(" AND (TIMCODE IN({0}))", strCLIENTSUBLIST) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                objYEARMON = Split(strYEARMONLIST, "|")

                intCUSTRows = UBound(objYEARMON, 1)

                For i = 0 To intCUSTRows
                    If i <> 0 Then
                        strFormet = strFormet & " UNION ALL"
                    End If
                    strFormet = strFormet & " SELECT YEARMON YEARMONFLAG,"
                    strFormet = strFormet & " dbo.sc_get_highcompanyname_fun(clientcode) clientname,"
                    strFormet = strFormet & " dbo.sc_get_highcompanyname_fun(clientcode) clientname2,"
                    strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(TIMCODE) CLIENTSUBNAME,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) TV,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) RD,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) DMB,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) CATV,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'T' THEN ISNULL(AMT,0) ELSE 0 END) TOTAL,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) MP01,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) MP02,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) INTERNET,"
                    strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) OUTDOOR,"
                    strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT"
                    strFormet = strFormet & " FROM MD_REPORT_MST_V"
                    strFormet = strFormet & " WHERE 1=1 {0}"
                    strFormet = strFormet & " AND yearmon = '" & objYEARMON(i) & "'"
                    strFormet = strFormet & " GROUP BY YEARMON, clientcode, TIMCODE"

                    intcnt = 0
                    intcnt = SelectRtn_CLIENTSUBCNT(strInfoXML, objYEARMON(i), strWhere)

                    If intcnt > 1 Then
                        strFormet = strFormet & " UNION ALL "
                        strFormet = strFormet & " SELECT YEARMON YEARMONFLAG, "
                        strFormet = strFormet & " '' clientname,"
                        strFormet = strFormet & " 'zzzzzzz' clientname2,"
                        strFormet = strFormet & " CASE YEARMON WHEN '" & objYEARMON(i) & "' THEN '총합계' END AS CLIENTSUBNAME,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) TV,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) RD,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) DMB,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) CATV,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'T' THEN ISNULL(AMT,0) ELSE 0 END) TOTAL,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) MP01,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) MP02,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) INTERNET,"
                        strFormet = strFormet & " SUM(CASE WHEN MED_FLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) OUTDOOR,"
                        strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT"
                        strFormet = strFormet & " FROM MD_REPORT_MST_V"
                        strFormet = strFormet & " WHERE 1=1 {0}"
                        strFormet = strFormet & " AND yearmon = '" & objYEARMON(i) & "'"
                        strFormet = strFormet & " GROUP BY YEARMON"
                    End If
                Next


                strFormet2 = "select yearmonflag, clientname, clientsubname, tv, rd, dmb, catv, total, mp01, mp02, internet, outdoor, SUMAMT from ( {0} ) a"
                strFormet2 = strFormet2 & " ORDER BY yearmonflag, clientname2"

                strSQLtemp = String.Format(strFormet, strWhere)
                strSQL = String.Format(strFormet2, strSQLtemp)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MONAMTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '===================광고주 한건에 매체사 한건조회
    Public Function SelectRtn_OneAndOne(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strFPUB_DATE As String, _
                                     ByVal strTPUB_DATE As String, _
                                     ByVal strCLIENTCODE As String, _
                                     ByVal strMEDCODE As String, _
                                     ByVal strTIMCODE As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3, Con4, Con5 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try

                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""
                Con4 = ""
                Con5 = ""

                If strFPUB_DATE <> "" Then Con1 = "AND PUB_DATE >='" & strFPUB_DATE.Substring(0, 4) & strFPUB_DATE.Substring(5, 2) & strFPUB_DATE.Substring(8, 2) & "'"
                If strTPUB_DATE <> "" Then Con2 = "AND PUB_DATE <='" & strTPUB_DATE.Substring(0, 4) & strTPUB_DATE.Substring(5, 2) & strTPUB_DATE.Substring(8, 2) & "'"
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strMEDCODE <> "" Then Con4 = String.Format(" AND (MEDCODE = '{0}')", strMEDCODE)
                If strTIMCODE <> "" Then Con5 = String.Format(" AND (TIMCODE = '{0}')", strTIMCODE)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5)

                strFormet = "   SELECT "
                strFormet = strFormet & "   PUB_DATE , "
                strFormet = strFormet & "   DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME , "
                strFormet = strFormet & "   DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME ,"
                strFormet = strFormet & "   DBO.MD_GET_MATTERNAME_FUN(MATTERCODE) MATTERNAME,"
                strFormet = strFormet & "   COL_DEG , "
                strFormet = strFormet & "   EXECUTE_FACE,"
                strFormet = strFormet & "   Case MED_FLAG"
                strFormet = strFormet & "   WHEN 'MP01' THEN"
                strFormet = strFormet & "       CASE ISNULL(CAST(STD_STEP AS NVARCHAR(10)),'')"
                strFormet = strFormet & "       WHEN '' THEN ''"
                strFormet = strFormet & "   	ELSE "
                strFormet = strFormet & "           CASE ISNULL(CAST(STD_CM AS NVARCHAR(10)),'')"
                strFormet = strFormet & "           WHEN '' THEN "
                strFormet = strFormet & "   			CASE ISNULL(CAST(STD_FACE AS NVARCHAR(10)),'')"
                strFormet = strFormet & "   			WHEN '' THEN ISNULL(CAST(STD_STEP AS NVARCHAR(10)),'') + '단'"
                strFormet = strFormet & "   			ELSE ISNULL(CAST(STD_STEP AS NVARCHAR(10)),'') + '단' + ISNULL(CAST(STD_FACE AS NVARCHAR(10)),'') + '면'"
                strFormet = strFormet & "   			END"
                strFormet = strFormet & "           ELSE "
                strFormet = strFormet & "   			CASE ISNULL(CAST(STD_FACE AS NVARCHAR(10)),'')"
                strFormet = strFormet & "   			WHEN '' THEN ISNULL(CAST(STD_STEP AS NVARCHAR(10)),'') + '단' + ISNULL(CAST(STD_CM AS NVARCHAR(10)),'') + 'cm'"
                strFormet = strFormet & "   			ELSE ISNULL(CAST(STD_STEP AS NVARCHAR(10)),'') + '단' + ISNULL(CAST(STD_CM AS NVARCHAR(10)),'') + 'cm' + ISNULL(CAST(STD_FACE AS NVARCHAR(10)),'') + '면'"
                strFormet = strFormet & "   			END"
                strFormet = strFormet & "   		End"
                strFormet = strFormet & "   	End"
                strFormet = strFormet & "   ELSE"
                strFormet = strFormet & "       CASE ISNULL(CAST(STD AS NVARCHAR(10)),'')"
                strFormet = strFormet & "       WHEN '' THEN"
                strFormet = strFormet & "   		CASE ISNULL(CAST(STD_PAGE AS NVARCHAR(10)),'')"
                strFormet = strFormet & "   		WHEN '' THEN ''"
                strFormet = strFormet & "   		ELSE ISNULL(CAST(STD_PAGE AS NVARCHAR(10)),'') + '페이지'"
                strFormet = strFormet & "   		END"
                strFormet = strFormet & "       ELSE "
                strFormet = strFormet & "   		CASE ISNULL(CAST(STD_PAGE AS NVARCHAR(10)),'')"
                strFormet = strFormet & "   		WHEN '' THEN ISNULL(CAST(STD AS NVARCHAR(10)),'')"
                strFormet = strFormet & "   		ELSE ISNULL(CAST(STD AS NVARCHAR(10)),'') + ' ' + ISNULL(CAST(STD_PAGE AS NVARCHAR(10)),'') + '페이지'"
                strFormet = strFormet & "   		END"
                strFormet = strFormet & "   	End"
                strFormet = strFormet & "   END AS STD,"
                strFormet = strFormet & "   ISNULL(PRICE,0) PRICE, "
                strFormet = strFormet & "   ISNULL(AMT,0) AMT , "
                strFormet = strFormet & "   MEMO, "
                strFormet = strFormet & "   1 SORTGBN, "
                strFormet = strFormet & "   DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME2"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM "
                strFormet = strFormet & "   WHERE 1=1  "
                strFormet = strFormet & "   AND ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & "   {0} "
                strFormet = strFormet & "   UNION ALL"
                strFormet = strFormet & "   SELECT "
                strFormet = strFormet & "   '' PUB_DATE, "
                strFormet = strFormet & "   '' CLIENTNAME, "
                strFormet = strFormet & "   '' MEDNAME,"
                strFormet = strFormet & "   '' MATTERNAME, "
                strFormet = strFormet & "   '' COL_DEG, "
                strFormet = strFormet & "   '' EXECUTE_FACE,   "
                strFormet = strFormet & "   '소계' STD, "
                strFormet = strFormet & "   NULL PRICE, "
                strFormet = strFormet & "   SUM(ISNULL(AMT,0)) AMT, "
                strFormet = strFormet & "   '' MEMO, "
                strFormet = strFormet & "   2 SORTGBN, "
                strFormet = strFormet & "   DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME2"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "   WHERE 1=1 "
                strFormet = strFormet & "   AND ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & "   {0} "
                strFormet = strFormet & "   GROUP BY DBO.SC_GET_CUSTNAME_FUN(MEDCODE)"
                strFormet = strFormet & "   UNION ALL"
                strFormet = strFormet & "   SELECT "
                strFormet = strFormet & "   '' PUB_DATE , "
                strFormet = strFormet & "   '' CLIENTNAME , "
                strFormet = strFormet & "   '' MEDNAME ,"
                strFormet = strFormet & "   '' MATTERNAME , "
                strFormet = strFormet & "   '' COL_DEG, "
                strFormet = strFormet & "   '' EXECUTE_FACE,   "
                strFormet = strFormet & "   '합계' STD, "
                strFormet = strFormet & "   NULL PRICE , "
                strFormet = strFormet & "   SUM(ISNULL(AMT,0)) , "
                strFormet = strFormet & "   '' MEMO, "
                strFormet = strFormet & "   3 SORTGBN, "
                strFormet = strFormet & "   'ZZZZZZZZ' MEDNAME2"
                strFormet = strFormet & "   FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & "   WHERE 1=1 "
                strFormet = strFormet & "   AND ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & "   {0} "
                strFormet = strFormet & "   ORDER BY MEDNAME2, SORTGBN, PUB_DATE"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function




#End Region

#Region "GROUP BLOCK : 외부에 비공개 Method"

    ' Private FunctionInsertRtn_XXX(ByVal xmlRoot As XmlElement) As Integer
    '     '해당 엔티티 클래스 Maker에서 기본 코드 제공(XML)
    ' End Function
    ' Private Function UpdateRtn_XXX(ByValxmlRoot As XmlElement) As Integer
    '      '해당엔티티 클래스 Maker에서 기본코드 제공(XML)
    ' End Function
    ' Private Function InsertRtn_XXX(ByVal vntData As Object,ByVal intColCnt As Integer, ByVal intRow As Integer) As Integer
    '     '해당 엔티티 클래스Maker에서 기본 코드 제공(Sheet)
    ' End Function
    ' Private Function UpdateRtn_XXX(ByVal vntData As Object,ByVal intColCnt As Integer, ByVal intRow As Integer) As Integer
    '     '해당 엔티티 클래스Maker에서 기본코드 제공(Sheet)
    ' End Function

#End Region
End Class