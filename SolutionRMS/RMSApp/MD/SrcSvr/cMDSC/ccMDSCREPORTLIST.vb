'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커 - 한화 S&C
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccMDCMEXECUTE.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2004-03-30 오전 10:32:13 By MakeSFARV.2.0.0
'                  2) 2004-03-30 오전 10:32:13 By 작성자명을 씁니다.
'****************************************************************************************

Imports System.Xml                        ' XML처리 
Imports SCGLControl                       ' ControlClass의 Base Class 
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr            '오류처리 클래스
Imports SCGLUtil.cbSCGLXml           'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil            '기타유틸리티 클래스
Imports eMDCO

' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트

Public Class ccMDSCREPORTLIST
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccMDSCREPORTLIST"                  '자신의 클래스명
    'Private Const .DBConnStr = "Provider=SQLOLEDB;Data Source=10.110.10.86;Initial Catalog=MCDEV;DSN=MCDEV;UID=devadmin;Pwd=password"
    Private mobjceMD_REPORT_MST As eMDCO.ceMD_REPORT_MST   '사용할 Entity 변수 선언
    Private mobjceMD_REPORTINCOME_MST As eMDCO.ceMD_REPORTINCOME_MST    '사용할 Entity 변수 선언

#End Region

#Region "GROUP BLOCK : Property 선언"
#End Region

#Region "GROUP BLOCK : Event 선언"
    ' =============== SelectRtnSample Code
    Public Function GetCLIENTSUBLIST(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object
        Dim strHIGH As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                .mobjSCGLSql.SQLConnect(.DBConnStr)


                If strCLIENTCODE <> "" Then
                    strHIGH = SelectRtn_HIGH(strCLIENTCODE)
                End If

                If strHIGH <> "" Then Con1 = String.Format(" AND (HIGHCUSTCODE LIKE '%{0}%')", strHIGH)
                strWhere = BuildFields(" ", Con1)

                strSelFields = "CUSTCODE, CUSTNAME"

                strFormet = "select {0} from SC_CUST_TEMP where 1=1 AND CUSTCODE LIKE 'A%' AND ATTR10 =1 {1}  ORDER BY CUSTCODE"
                'strFormet = strFormet & " CASE SUBSTRING(LTRIM(CUSTNAME),1,3) WHEN '(주)' THEN LTRIM(SUBSTRING(CUSTNAME,4,LEN(CUSTNAME))) "
                'strFormet = strFormet & " WHEN '(사)' THEN LTRIM(SUBSTRING(CUSTNAME,4,LEN(CUSTNAME))) "
                'strFormet = strFormet & " WHEN '(유)' THEN LTRIM(SUBSTRING(CUSTNAME,4,LEN(CUSTNAME))) "
                'strFormet = strFormet & " WHEN '(재)' THEN LTRIM(SUBSTRING(CUSTNAME,4,LEN(CUSTNAME))) "
                'strFormet = strFormet & " WHEN '(사단' THEN LTRIM(SUBSTRING(CUSTNAME,5,LEN(CUSTNAME))) "
                'strFormet = strFormet & " WHEN '(학)' THEN LTRIM(SUBSTRING(CUSTNAME,4,LEN(CUSTNAME))) "
                'strFormet = strFormet & " ELSE LTRIM(CUSTNAME) END "


                strSQL = String.Format(strFormet, strSelFields, strWhere)


                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function GetCLIENTSUBLIST2(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByVal strCLIENTCODE As String, _
                                      ByVal strFYEARMON As String, _
                                      ByVal strTYEARMON As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim strHIGH As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                .mobjSCGLSql.SQLConnect(.DBConnStr)

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strFYEARMON <> "" Then Con2 = String.Format(" AND (YEARMON >= '{0}')", strFYEARMON)
                If strTYEARMON <> "" Then Con3 = String.Format(" AND (YEARMON <= '{0}')", strTYEARMON)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = strFormet & " SELECT CASE WHEN LEN(ISNULL(TIMCODE,''))=0 THEN '없음' ELSE TIMCODE END AS CUSTCODE, CASE WHEN LEN(ISNULL(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),''))=0 THEN '없음' ELSE DBO.SC_GET_CUSTNAME_FUN(TIMCODE) END AS CUSTNAME "
                strFormet = strFormet & " FROM MD_REPORT_MST_V"
                strFormet = strFormet & " WHERE 1=1"
                strFormet = strFormet & " {0}"
                strFormet = strFormet & " GROUP BY TIMCODE  ORDER BY TIMCODE"


                strSQL = String.Format(strFormet, strWhere)


                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function GetCLIENTSUBLIST3(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByVal strCLIENTCODE As String, _
                                      ByVal strYEAR As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim strHIGH As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                .mobjSCGLSql.SQLConnect(.DBConnStr)

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)

                strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " SELECT CASE WHEN LEN(ISNULL(TIMCODE,'')) = 0 THEN '없음' ELSE TIMCODE END AS CUSTCODE, CASE WHEN LEN(ISNULL(DBO.SC_GET_CUSTNAME_FUN(TIMCODE),''))=0 THEN '없음' ELSE DBO.SC_GET_CUSTNAME_FUN(TIMCODE) END AS CUSTNAME "
                strFormet = strFormet & " FROM V_MD_REPORTCOMMI_MST('" & strYEAR & "')"
                strFormet = strFormet & " WHERE 1=1"
                strFormet = strFormet & " {0}"
                strFormet = strFormet & " GROUP BY TIMCODE  ORDER BY TIMCODE"


                strSQL = String.Format(strFormet, strWhere)


                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    Public Function GetCLIENTSUBLISTONE(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByVal strCLIENTCODE As String, _
                                      ByVal strYEAR As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim strHIGH As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                .mobjSCGLSql.SQLConnect(.DBConnStr)

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strYEAR <> "" Then Con2 = String.Format(" AND (SUBSTRING(YEARMON,1,4) = '{0}')", strYEAR)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = strFormet & " SELECT TIMCODE CUSTCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) CUSTNAME "
                strFormet = strFormet & " FROM MD_REPORT_MST_V"
                strFormet = strFormet & " WHERE 1=1 AND MED_FLAG = 'O' "
                strFormet = strFormet & " {0}"
                strFormet = strFormet & " GROUP BY TIMCODE   ORDER BY TIMCODE"


                strSQL = String.Format(strFormet, strWhere)


                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetCUSTCHKLIST(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strCUSTNAME As String, _
                                   ByVal strCUSTFLAG As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""

                If strCUSTNAME <> "" Then Con1 = String.Format(" AND (CUSTNAME LIKE '%{0}%')", strCUSTNAME)
                strWhere = BuildFields(" ", Con1)

                strFormet = " SELECT"
                strFormet = strFormet & "  0 CHK,"
                strFormet = strFormet & "  HIGHCUSTCODE CUSTCODE,"
                strFormet = strFormet & "  CUSTNAME, BUSINO"
                strFormet = strFormet & "  FROM SC_CUST_HDR"

                If strCUSTFLAG = "CLIENT" Then
                    strFormet = strFormet & "  WHERE MEDFLAG = 'A' {0}"
                ElseIf strCUSTFLAG = "MED" Then
                    strFormet = strFormet & "  WHERE MEDFLAG = 'B' AND ISNULL(USE_FLAG,0) = 1 {0}"
                End If

                strFormet = strFormet & "  ORDER BY CUSTNAME "

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCUSTCHKLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_HIGH(ByVal strCUSTCODE As String) As String
        '여기부터 단순조회
        Dim strSQL, strFormat, strRtn As String

        'SetConfig(strInfoXML) '기본정보 Setting

        With mobjSCGLConfig '기본정보 Config 개체

            Try
                strSQL = String.Format("SELECT HIGHCUSTCODE FROM SC_CUST_TEMP WHERE CUSTCODE = '" & strCUSTCODE & "'")
                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)
                Return strRtn
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_SEQNO")
            Finally
            End Try
        End With
        '여기까지 단순조회
    End Function

#End Region

#Region "GROUP BLOCK : 저장로직"
    Public Function ProcessRtn_DETAIL_ONE(ByVal vntData As Object) As String

        Dim intRtn As Integer
        Dim i, intColCnt, intRows As Integer
        Dim strBOOKINGDATE
        Dim strPUB_DATE
        Dim strDEMANDDAY
        Dim strDUTYFLAG

        With mobjSCGLConfig
            Try
                If IsArray(vntData) Then
                    '''사용할 Entity 개체생성(Config 정보를 넘겨생성)
                    mobjceMD_REPORT_MST = New ceMD_REPORT_MST(mobjSCGLConfig)
                    '''vntData의 컬럼수, 로우수를 변수입력
                    intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)
                    '''해당하는Row 만큼 Loop

                    For i = 1 To intRows
                        intRtn = InsertRtn_MD_REPORT_MST(vntData, intColCnt, i)
                    Next
                End If

                Return intRows
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_DETAIL_ONE")
            Finally
                mobjceMD_REPORT_MST.Dispose()
            End Try
        End With
    End Function


    Public Function ProcessRtn(ByVal strInfoXML As String, _
                               ByVal vntData As Object) As String '데이터 INSERT/UPDATE 인수는 마지막에만 ByVal 이며 중간 경유는 ByRef

        Dim intRtn As Integer '결과값 변수  
        Dim i, intColCnt, intRows As Integer '루프, 컬럼Cnt, 로우Cnt 변수
        Dim strGFLAG

        SetConfig(strInfoXML) '기본정보 Setting

        With mobjSCGLConfig '기본정보를 가지고 있는 Config 개체
            Try
                'DB접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()

                'DetailOne 데이터 처리
                If IsArray(vntData) Then
                    intRtn = ProcessRtn_DETAIL_ONE(vntData)
                End If

                '트랜잭션Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn")
            Finally
                'Resource해제
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function DeleteRtn(ByVal strInfoXML As String, _
                              ByVal strYEARMON As String) As Integer   '데이터 DELETE

        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )
        Dim intColCnt, intRows
        Dim strTRUST_SEQ
        Dim strSEQ
        Dim strTRUST_YEARMON
        Dim i

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceMD_REPORT_MST = New ceMD_REPORT_MST(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출

                intRtn = mobjceMD_REPORT_MST.DeleteDo(strYEARMON)

                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceMD_REPORT_MST.Dispose()
            End Try
        End With
    End Function

    Public Function ProcessRtn_INCOMEDETAIL_ONE(ByVal vntData As Object) As String

        Dim intRtn As Integer
        Dim i, intColCnt, intRows As Integer
        Dim strBOOKINGDATE
        Dim strPUB_DATE
        Dim strDEMANDDAY
        Dim strDUTYFLAG

        With mobjSCGLConfig
            Try
                If IsArray(vntData) Then
                    '''사용할 Entity 개체생성(Config 정보를 넘겨생성)
                    mobjceMD_REPORTINCOME_MST = New ceMD_REPORTINCOME_MST(mobjSCGLConfig)
                    '''vntData의 컬럼수, 로우수를 변수입력
                    intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)
                    '''해당하는Row 만큼 Loop

                    For i = 1 To intRows
                        intRtn = InsertRtn_MD_REPORTINCOME_MST(vntData, intColCnt, i)
                    Next
                End If

                Return intRows
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_INCOMEDETAIL_ONE")
            Finally
                mobjceMD_REPORTINCOME_MST.Dispose()
            End Try
        End With
    End Function


    Public Function ProcessRtn_INCOME(ByVal strInfoXML As String, _
                                      ByVal vntData As Object) As String

        Dim intRtn As Integer '결과값 변수  
        Dim i, intColCnt, intRows As Integer '루프, 컬럼Cnt, 로우Cnt 변수
        Dim strGFLAG

        SetConfig(strInfoXML) '기본정보 Setting

        With mobjSCGLConfig '기본정보를 가지고 있는 Config 개체
            Try
                'DB접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()

                'DetailOne 데이터 처리
                If IsArray(vntData) Then
                    intRtn = ProcessRtn_INCOMEDETAIL_ONE(vntData)
                End If

                '트랜잭션Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn")
            Finally
                'Resource해제
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function DeleteRtn_INCOME(ByVal strInfoXML As String, _
                                     ByVal strYEARMON As String) As Integer   '데이터 DELETE

        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )
        Dim intColCnt, intRows
        Dim strTRUST_SEQ
        Dim strSEQ
        Dim strTRUST_YEARMON
        Dim i

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceMD_REPORTINCOME_MST = New ceMD_REPORTINCOME_MST(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출

                intRtn = mobjceMD_REPORTINCOME_MST.DeleteDo(strYEARMON)

                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceMD_REPORTINCOME_MST.Dispose()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : 외부에 공개 Method"
    ' =============== 광고 매체 거래명세표
    Public Function SelectRtn_MONMEDLIST(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strYEARMON As String, _
                                         ByVal strCLIENTCODE As String, _
                                         ByVal strCLIENTSUBCODE As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTSUBCODE <> "" Then Con2 = String.Format(" AND (CLIENTSUBCODE = '{0}')", strCLIENTSUBCODE)

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " select "
                strFormet = strFormet & " input_medname, "
                strFormet = strFormet & " medname, "
                strFormet = strFormet & " sumamt, "
                strFormet = strFormet & " sumamtvat, "
                strFormet = strFormet & " real_med_name"
                strFormet = strFormet & " from ("
                strFormet = strFormet & " select 'TV' input_medname, dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat, "
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strFormet = strFormet & " 1 sortgbn,"
                strFormet = strFormet & " input_medflag,"
                strFormet = strFormet & " medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium "
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag = '01' "
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by input_medflag, real_med_code, medcode, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'RADIO' input_medname, dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat, "
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strFormet = strFormet & " 1 sortgbn,"
                strFormet = strFormet & " 'RADIO' input_medflag,"
                strFormet = strFormet & " medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('02', '03')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by real_med_code, medcode, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'DMB' input_medname, dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strFormet = strFormet & " 1 sortgbn ,"
                strFormet = strFormet & " 'DMB' input_medflag,"
                strFormet = strFormet & " medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('10', '20')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by real_med_code, medcode, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'CATV' input_medname, dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, sum(amt)sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strFormet = strFormet & " 1 sortgbn,"
                strFormet = strFormet & " 'ZZZZZZ' input_medflag,"
                strFormet = strFormet & " medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_catvtrans_dtl"
                strFormet = strFormet & " where transyearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " group by real_med_code, medcode, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'TV' input_medname, '소계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 2 sortgbn,"
                strFormet = strFormet & " input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag = '01'"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by input_medflag, real_med_code, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'RADIO' input_medname, '소계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 2 sortgbn,"
                strFormet = strFormet & " 'RADIO' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('02', '03')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by real_med_code, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'DMB' input_medname, '소계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 2 sortgbn,"
                strFormet = strFormet & " 'DMB' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('10', '20')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by real_med_code, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'CATV' input_medname, '소계' medname, sum(amt)sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 2 sortgbn,"
                strFormet = strFormet & " 'ZZZZZZ' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " real_med_code"
                strFormet = strFormet & " from md_catvtrans_dtl"
                strFormet = strFormet & " where transyearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " group by real_med_code, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'TV' input_medname, '합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 3 sortgbn,"
                strFormet = strFormet & " input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " 'zzzzzz' real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag = '01'"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by input_medflag, tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'RADIO' input_medname, '합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 3 sortgbn,"
                strFormet = strFormet & " 'RADIO' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " 'zzzzzz' real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('02', '03')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'DMB' input_medname, '합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 3 sortgbn,"
                strFormet = strFormet & " 'DMB' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " 'zzzzzz' real_med_code"
                strFormet = strFormet & " from md_electric_medium"
                strFormet = strFormet & " where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " and input_medflag in('10', '20')"
                strFormet = strFormet & " and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " group by tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select 'CATV' input_medname, '합계' medname, sum(amt)sumamt, "
                strFormet = strFormet & " case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat,"
                strFormet = strFormet & " '' real_med_name,"
                strFormet = strFormet & " 3 sortgbn,"
                strFormet = strFormet & " 'ZZZZZZ' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode, "
                strFormet = strFormet & " 'zzzzzz' real_med_code"
                strFormet = strFormet & " from md_catvtrans_dtl"
                strFormet = strFormet & " where transyearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " group by tru_tax_flag"
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select '' input_medname, '총합계' medname, sum(sumamt) sumamt, sum(sumamtvat) sumamtvat, '' real_med_name,"
                strFormet = strFormet & " 4 sortgbn,"
                strFormet = strFormet & " 'zzzzzz' input_medflag,"
                strFormet = strFormet & " 'zzzzzz' medcode,"
                strFormet = strFormet & " 'zzzzzz' real_med_code"
                strFormet = strFormet & " from ("
                strFormet = strFormet & " 	select '' input_medname, '총합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " 	case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat"
                strFormet = strFormet & " 	from md_electric_medium"
                strFormet = strFormet & " 	where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " 	and input_medflag = '01'"
                strFormet = strFormet & "   and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " 	group by input_medflag, tru_tax_flag"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '' input_medname, '총합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " 	case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat"
                strFormet = strFormet & " 	from md_electric_medium"
                strFormet = strFormet & " 	where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " 	and input_medflag in('02', '03')"
                strFormet = strFormet & "   and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " 	group by tru_tax_flag"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '' input_medname, '총합계' medname, sum(amt) sumamt, "
                strFormet = strFormet & " 	case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat"
                strFormet = strFormet & " 	from md_electric_medium"
                strFormet = strFormet & " 	where yearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " 	and input_medflag in('10', '20')"
                strFormet = strFormet & "   and ISNULL(TRU_TRANS_NO,'') <> '' "
                strFormet = strFormet & " 	group by tru_tax_flag"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '' input_medname, '총합계' medname, sum(amt)sumamt, "
                strFormet = strFormet & " 	case isnull(tru_tax_flag,'N') when 'Y' then sum(amt)+(sum(amt/10)) else sum(amt) end as sumamtvat"
                strFormet = strFormet & " 	from md_catvtrans_dtl"
                strFormet = strFormet & " 	where transyearmon = '" & strYEARMON & "' {0}"
                strFormet = strFormet & " 	group by tru_tax_flag"
                strFormet = strFormet & " 	)b"
                strFormet = strFormet & " ) a  order by input_medflag, real_med_code, medcode, sortgbn"



                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' CATV 부문별 실집행 광고비 MDCMCLIENTSUBCATVLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTSUBCATVLIST(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal strYEAR As String, _
                                                ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon , 1,4)='{0}'", strYEAR)
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE)

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT "
                strFormet = strFormet & " TIMNAME, MEDNAME,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, ISNULL(SUMAMT,0) SUMAMT "
                strFormet = strFormet & " FROM"
                strFormet = strFormet & " ("
                strFormet = strFormet & " "
                strFormet = strFormet & " SELECT DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, TIMCODE, "
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " from MD_REPORT_MST_V"
                strFormet = strFormet & " where 1=1 "
                strFormet = strFormet & " AND MED_FLAG = 'A2'  {0}"
                strFormet = strFormet & " GROUP BY TIMCODE, MEDCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " SELECT DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, TIMCODE, "
                strFormet = strFormet & " '소계' MEDNAME, 'ZZZZZZ' MEDCODE,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT, 2 SORTGBN"
                strFormet = strFormet & " from MD_REPORT_MST_V"
                strFormet = strFormet & " where 1=1  "
                strFormet = strFormet & " AND MED_FLAG = 'A2'  {0}"
                strFormet = strFormet & " GROUP BY TIMCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " SELECT 'TOTAL' TIMNAME,  'ZZZZZZZ' TIMCODE, "
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '12' THEN AMT ELSE 0 END ) A12,"
                strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT, 3 SORTGBN"
                strFormet = strFormet & " from MD_REPORT_MST_V"
                strFormet = strFormet & " where 1=1  "
                strFormet = strFormet & " AND MED_FLAG = 'A2'  {0}"
                strFormet = strFormet & " GROUP BY MEDCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " SELECT 'TOTAL' TIMNAME,  'ZZZZZZZ' TIMCODE, "
                strFormet = strFormet & " '합계' MEDNAME, '' MEDCODE,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '12' THEN AMT ELSE 0 END ) A12,"
                strFormet = strFormet & " SUM(ISNULL(AMT,0)) SUMAMT, 3 SORTGBN"
                strFormet = strFormet & " from MD_REPORT_MST_V"
                strFormet = strFormet & " where 1=1  "
                strFormet = strFormet & " AND MED_FLAG = 'A2' {0}"
                strFormet = strFormet & " "
                strFormet = strFormet & " ) A ORDER BY TIMCODE, SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTSUBCATVLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 인쇄 부문별 실집행 광고비 MDCMCLIENTSUBPRINTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTSUBPRINTLIST(ByVal strInfoXML As String, _
                                                 ByRef intRowCnt As Integer, _
                                                 ByRef intColCnt As Integer, _
                                                 ByVal strYEAR As String, _
                                                 ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR)
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE)

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT"
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME, TIMCODE TIMNAME, MED_FLAGNAME,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	SELECT CLIENTCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE, "
                strFormet = strFormet & " 	'신문' MED_FLAGNAME, 'B' MED_FLAG, TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	'신문' MED_FLAGNAME2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' and MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B' ,'C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0 {0}"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	SELECT CLIENTCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE, "
                strFormet = strFormet & " 	'잡지' MED_FLAGNAME, 'C' MED_FLAG, TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	 '잡지' MED_FLAGNAME2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' and MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	FROM  MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B','C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0 {0}	    "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	SELECT CLIENTCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 소계' MED_FLAGNAME, 'Z' MED_FLAG,  TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	 'YYYYYY' MED_FLAGNAME2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B','C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0 {0}"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " "
                strFormet = strFormet & " 	SELECT CLIENTCODE, DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) +' 합계' TIMCODE, "
                strFormet = strFormet & " 	'' MED_FLAGNAME, 'Z' MED_FLAG, 'ZZZZZZ' TIMCODE2, 'ZZZZZZ' MED_FLAGNAME2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B','C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0 {0}"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " ) AA"
                strFormet = strFormet & " ORDER BY CLIENTCODE, TIMCODE2, MED_FLAGNAME2, MED_FLAG"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTSUBPRINTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    '*************************************************************************************************************'
    ' 월별 (AGENCY) 공중파 광고정상 MDCMBRANDAGENCYLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_BRANDAGENCYLIST(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal strYEARMON As String, _
                                              ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and YEARMON = '{0}'", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " TIMCODE,"
                strFormet = strFormet & " SUBSEQ2,"
                strFormet = strFormet & " EXCLIENTCODE,"
                strFormet = strFormet & " MED_FLAG,"
                strFormet = strFormet & " A1,"
                strFormet = strFormet & " A2,"
                strFormet = strFormet & " A3,"
                strFormet = strFormet & " A4,"
                strFormet = strFormet & " A5,"
                strFormet = strFormet & " A6,"
                strFormet = strFormet & " SUMAMT,"
                strFormet = strFormet & " SUMAMTVAT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	TIMCODE,"
                strFormet = strFormet & " 	TIMCODE2,"
                strFormet = strFormet & " 	SUBSEQ2,"
                strFormet = strFormet & " 	SUBSEQ,"
                strFormet = strFormet & " 	EXCLIENTCODE,"
                strFormet = strFormet & " 	EXCLIENTCODE2,"
                strFormet = strFormet & " 	MED_FLAG,"
                strFormet = strFormet & " 	SORTGBN,"
                strFormet = strFormet & " 	A1,"
                strFormet = strFormet & " 	A2,"
                strFormet = strFormet & " 	A3,"
                strFormet = strFormet & " 	A4,"
                strFormet = strFormet & " 	A5,"
                strFormet = strFormet & " 	A6,"
                strFormet = strFormet & "   SUMAMT,"
                strFormet = strFormet & "   SUMAMTVAT"
                strFormet = strFormet & " 	FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) EXCLIENTCODE,"
                strFormet = strFormet & " 		EXCLIENTCODE EXCLIENTCODE2,"
                strFormet = strFormet & " 		'TV' MED_FLAG,"
                strFormet = strFormet & " 		1 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ,EXCLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE)EXCLIENTCODE,"
                strFormet = strFormet & " 		EXCLIENTCODE EXCLIENTCODE2,"
                strFormet = strFormet & " 		'Radio' MED_FLAG,"
                strFormet = strFormet & " 		2 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ,EXCLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE)EXCLIENTCODE,"
                strFormet = strFormet & " 		EXCLIENTCODE EXCLIENTCODE2,"
                strFormet = strFormet & " 		'부분합' MED_FLAG,"
                strFormet = strFormet & " 		3 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ,EXCLIENTCODE"
                strFormet = strFormet & " 	) A"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	TIMCODE,"
                strFormet = strFormet & " 	TIMCODE2,"
                strFormet = strFormet & " 	SUBSEQ2,"
                strFormet = strFormet & " 	SUBSEQ,"
                strFormet = strFormet & " 	EXCLIENTCODE,"
                strFormet = strFormet & " 	EXCLIENTCODE2,"
                strFormet = strFormet & " 	MED_FLAG,"
                strFormet = strFormet & " 	SORTGBN,"
                strFormet = strFormet & " 	A1,"
                strFormet = strFormet & " 	A2,"
                strFormet = strFormet & " 	A3,"
                strFormet = strFormet & " 	A4,"
                strFormet = strFormet & " 	A5,"
                strFormet = strFormet & " 	A6,"
                strFormet = strFormet & " 	SUMAMT,"
                strFormet = strFormet & " 	SUMAMTVAT"
                strFormet = strFormet & " 	FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQ2,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) + ' Total' EXCLIENTCODE,"
                strFormet = strFormet & " 		'yyyyyyy' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'TV' MED_FLAG,"
                strFormet = strFormet & " 		1 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ)  SUBSEQ2,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) + ' Total' EXCLIENTCODE,"
                strFormet = strFormet & " 		'yyyyyyy' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'Radio' MED_FLAG,"
                strFormet = strFormet & " 		2 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		SUBSEQ,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQ2,"
                strFormet = strFormet & " 		dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) + ' Total' EXCLIENTCODE,"
                strFormet = strFormet & " 		'yyyyyyy' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'부분합' MED_FLAG,"
                strFormet = strFormet & " 		3 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE,SUBSEQ"
                strFormet = strFormet & " 	) A"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	TIMCODE,"
                strFormet = strFormet & " 	TIMCODE2,"
                strFormet = strFormet & " 	SUBSEQ2,"
                strFormet = strFormet & " 	SUBSEQ,"
                strFormet = strFormet & " 	EXCLIENTCODE,"
                strFormet = strFormet & " 	EXCLIENTCODE2,"
                strFormet = strFormet & " 	MED_FLAG,"
                strFormet = strFormet & " 	SORTGBN,"
                strFormet = strFormet & " 	A1,"
                strFormet = strFormet & " 	A2,"
                strFormet = strFormet & " 	A3,"
                strFormet = strFormet & " 	A4,"
                strFormet = strFormet & " 	A5,"
                strFormet = strFormet & " 	A6,"
                strFormet = strFormet & " 	SUMAMT,"
                strFormet = strFormet & " 	SUMAMTVAT"
                strFormet = strFormet & " 	FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		'zzzzzzz' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE)  + ' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'zzzzzz' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'TV' MED_FLAG,"
                strFormet = strFormet & " 		1 SORTGBN, "
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		'zzzzzzz' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE)  + ' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'zzzzzz' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'Radio' MED_FLAG,"
                strFormet = strFormet & " 		2 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 		TIMCODE TIMCODE2,"
                strFormet = strFormet & " 		'zzzzzzz' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE) SUBSEQ2,"
                strFormet = strFormet & " 		DBO.SC_GET_CUSTNAME_FUN(TIMCODE)  + ' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'zzzzzz' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'부분합' MED_FLAG,"
                strFormet = strFormet & " 		3 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE,TIMCODE"
                strFormet = strFormet & " 	) A"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	TIMCODE,"
                strFormet = strFormet & " 	TIMCODE2,"
                strFormet = strFormet & " 	SUBSEQ2,"
                strFormet = strFormet & " 	SUBSEQ,"
                strFormet = strFormet & " 	EXCLIENTCODE,"
                strFormet = strFormet & " 	EXCLIENTCODE2,"
                strFormet = strFormet & " 	MED_FLAG,"
                strFormet = strFormet & " 	SORTGBN,"
                strFormet = strFormet & " 	A1,"
                strFormet = strFormet & " 	A2,"
                strFormet = strFormet & " 	A3,"
                strFormet = strFormet & " 	A4,"
                strFormet = strFormet & " 	A5,"
                strFormet = strFormet & " 	A6,"
                strFormet = strFormet & " 	SUMAMT,"
                strFormet = strFormet & " 	SUMAMTVAT"
                strFormet = strFormet & " 	FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		YEARMON TIMCODE,"
                strFormet = strFormet & " 		'ZZZZZZZ' TIMCODE2,"
                strFormet = strFormet & " 		'' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) SUBSEQ2,"
                strFormet = strFormet & " 		' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'TV' MED_FLAG,"
                strFormet = strFormet & " 		1 SORTGBN, "
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and MED_FLAG = '01'  THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		YEARMON TIMCODE,"
                strFormet = strFormet & " 		'ZZZZZZZ' TIMCODE2,"
                strFormet = strFormet & " 		'' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) SUBSEQ2,"
                strFormet = strFormet & " 		' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'Radio' MED_FLAG,"
                strFormet = strFormet & " 		2 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112'  AND (MED_FLAG = '02' OR MED_FLAG = '03')  THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		YEARMON TIMCODE,"
                strFormet = strFormet & " 		'ZZZZZZZ' TIMCODE2,"
                strFormet = strFormet & " 		'' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) SUBSEQ2,"
                strFormet = strFormet & " 		' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'부분합' MED_FLAG,"
                strFormet = strFormet & " 		3 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 		YEARMON,"
                strFormet = strFormet & " 		CLIENTCODE,"
                strFormet = strFormet & " 		YEARMON TIMCODE,"
                strFormet = strFormet & " 		'ZZZZZZZ' TIMCODE2,"
                strFormet = strFormet & " 		'' SUBSEQ,"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) SUBSEQ2,"
                strFormet = strFormet & " 		' TOTAL' EXCLIENTCODE,"
                strFormet = strFormet & " 		'' EXCLIENTCODE2,"
                strFormet = strFormet & " 		'VAT포함' MED_FLAG,"
                strFormet = strFormet & " 		3 SORTGBN,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00107' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A1,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00111' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A2,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00109' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A3,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00108' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A4,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00110' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A5,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE = 'B00112' AND (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS A6,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN AMT + (AMT * 0.1) ELSE 0 END),0) AS SUMAMT,"
                strFormet = strFormet & " 		ISNULL(SUM(CASE WHEN REAL_MED_CODE in ('B00107','B00111','B00109','B00108','B00110','B00112') and (MED_FLAG = '01' OR MED_FLAG = '02' OR MED_FLAG = '03') THEN (AMT + (AMT * 0.1)) + ((AMT + (AMT * 0.1)) * 0.1) ELSE 0 END),0) AS SUMAMTVAT"
                strFormet = strFormet & " 	FROM dbo.MD_REPORT_MST_V"
                strFormet = strFormet & " 	WHERE ISNULL(AMT,0) <> 0  {0}"
                strFormet = strFormet & " 	AND MED_FLAG IN('01','02','03')"
                strFormet = strFormet & " 	GROUP BY YEARMON,CLIENTCODE"
                strFormet = strFormet & " 	) A"
                strFormet = strFormet & " ) C"
                strFormet = strFormet & " ORDER BY TIMCODE2,SUBSEQ, EXCLIENTCODE2, SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 년도별 소속사별 실집행광고비 MDCMCLIENTSUBSEQMEDLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTSUBSEQMEDLIST(ByVal strInfoXML As String, _
                                                  ByRef intRowCnt As Integer, _
                                                  ByRef intColCnt As Integer, _
                                                  ByVal strYEAR As String, _
                                                  ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2)


                'TV : KBS2, MBC, SBS, others / RD : KBS2, MBC, SBS, CBS, others

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " dbo.SC_GET_HIGHCUSTNAME_FUN(clientcode) clientname,"
                strFormet = strFormet & " SUBSEQ, medflag, MEDNAME,"
                strFormet = strFormet & " A1,"
                strFormet = strFormet & " A2,"
                strFormet = strFormet & " A3,"
                strFormet = strFormet & " A4,"
                strFormet = strFormet & " A5,"
                strFormet = strFormet & " A6,"
                strFormet = strFormet & " A7,"
                strFormet = strFormet & " A8,"
                strFormet = strFormet & " A9,"
                strFormet = strFormet & " A10,"
                strFormet = strFormet & " A11,"
                strFormet = strFormet & " A12,"
                strFormet = strFormet & " SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select 1 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, 'TV' medflag, "
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS-2TV'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC-TV'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS-TV'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end as medname,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end as medname2,	"
                strFormet = strFormet & " 	TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'AAAAAA' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end ) A12,"
                strFormet = strFormet & "     sum(isnull(amt,0)) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag = '01'"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 "
                strFormet = strFormet & " 	{0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) , "
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS-2TV'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC-TV'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS-TV'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 1 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, case when med_flag in('02','03') then 'radio' end AS medflag,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS2'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'CBS'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end as medname,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'DDD'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end as medname2,"
                strFormet = strFormet & " 	TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'BBBBBB' medflag2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end ) A12,"
                strFormet = strFormet & "     sum(isnull(amt,0)) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('02','03')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) , case when med_flag in('02','03') then 'radio' end, "
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS2'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'CBS'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'DDD'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 1 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, case when med_flag in('10','20') then 'DMB' end AS medflag,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS2'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'CBS'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end as medname,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'DDD'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end as medname2,"
                strFormet = strFormet & " 	TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'CCCCCC' medflag2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end ) A12,"
                strFormet = strFormet & "     sum(isnull(amt,0)) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('10','20')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) , case when med_flag in('10','20') then 'DMB' end, "
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'KBS2'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'MBC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'SBS'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'CBS'"
                strFormet = strFormet & " 	else 'Other'"
                strFormet = strFormet & " 	end,"
                strFormet = strFormet & " 	case "
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'KBS-2%' then 'AAA'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'MBC%' then 'BBB'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'SBS%' then 'CCC'"
                strFormet = strFormet & " 	when dbo.SC_GET_CUSTNAME_FUN(MEDCODE) like 'CBS%' then 'DDD'"
                strFormet = strFormet & " 	else 'EEE'"
                strFormet = strFormet & " 	end"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 2 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, 'TV 요약' medflag, "
                strFormet = strFormet & " 	'' medname, 'ffffff' medname2, TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'AAAAAA' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then amt else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then amt else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then amt else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then amt else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then amt else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then amt else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then amt else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then amt else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then amt else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then amt else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then amt else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then amt else 0 end ) A12,"
                strFormet = strFormet & "     sum(amt) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag = '01'"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 2 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, "
                strFormet = strFormet & " 	case when med_flag in('02','03') then 'radio 요약' end as medflag,"
                strFormet = strFormet & " 	'' medname, 'ffffff' medname2, TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'BBBBBB' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then amt else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then amt else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then amt else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then amt else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then amt else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then amt else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then amt else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then amt else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then amt else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then amt else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then amt else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then amt else 0 end ) A12,"
                strFormet = strFormet & "     sum(amt) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('02','03')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) , case when med_flag in('02','03') then 'radio 요약' end"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 2 sortgbn, clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq, "
                strFormet = strFormet & " 	case when med_flag in('10','20') then 'DMB 요약' end as medflag,"
                strFormet = strFormet & " 	'' medname, 'ffffff' medname2, TIMCODE TIMCODE2, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) subseq2, 'CCCCCC' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then amt else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then amt else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then amt else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then amt else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then amt else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then amt else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then amt else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then amt else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then amt else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then amt else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then amt else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then amt else 0 end ) A12,"
                strFormet = strFormet & "     sum(amt) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('10','20')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) , case when med_flag in('10','20') then 'DMB 요약' end"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 3 sortgbn, clientcode, TIMCODE, dbo.SC_GET_CUSTNAME_FUN(TIMCODE) +' 합계' subseq, '' medflag, "
                strFormet = strFormet & "     '' medname, 'zzzzzz' medname2, TIMCODE TIMCODE2, 'zzzzzz' subseq2, 'zzzzzz' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then amt else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then amt else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then amt else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then amt else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then amt else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then amt else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then amt else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then amt else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then amt else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then amt else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then amt else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then amt else 0 end ) A12,"
                strFormet = strFormet & "     sum(amt) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('01','02','03','10','20')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode, TIMCODE"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select 4 sortgbn, clientcode, '총합계' TIMCODE, '총합계' subseq, '' medflag, "
                strFormet = strFormet & " 	'' medname, 'zzzzzz' medname2, 'zzzzzz' TIMCODE2, 'zzzzzz' subseq2, 'zzzzzz' medflag2,"
                strFormet = strFormet & "     sum(case when substring(yearmon,5,2) = '01' then amt else 0 end ) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then amt else 0 end ) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then amt else 0 end ) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then amt else 0 end ) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then amt else 0 end ) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then amt else 0 end ) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then amt else 0 end ) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then amt else 0 end ) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then amt else 0 end ) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then amt else 0 end ) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then amt else 0 end ) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then amt else 0 end ) A12,"
                strFormet = strFormet & "     sum(amt) sumamt"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where med_flag in('01','02','03','10','20')"
                strFormet = strFormet & " 	and isnull(amt,0) <> 0 {0}"
                strFormet = strFormet & " 	group by clientcode"
                strFormet = strFormet & " ) A"
                strFormet = strFormet & " ORDER BY clientcode, TIMCODE2, SUBSEQ2, medflag2, medname2, sortgbn"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_EXISTREPORT(ByVal strInfoXML As String, _
                                          ByRef intRowCnt As Integer, _
                                          ByRef intColCnt As Integer, _
                                          ByVal strYEARMON As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and YEARMON ='{0}'", strYEARMON) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " YEARMON,"
                strFormet = strFormet & " VOCH_GBN"
                strFormet = strFormet & " FROM MD_REPORT_MST_V WHERE 1=1 {0}"
                strFormet = strFormet & " GROUP BY YEARMON, VOCH_GBN"
                strFormet = strFormet & " order by yearmon"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_REPORT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_EXISTREPORTINCOME(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal strYEARMON As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and YEARMON ='{0}'", strYEARMON) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " YEARMON,"
                strFormet = strFormet & " VOCH_GBN"
                strFormet = strFormet & " FROM MD_REPORTINCOME_MST WHERE 1=1 {0}"
                strFormet = strFormet & " GROUP BY YEARMON, VOCH_GBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_EXISTREPORTINCOME")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_LOW(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByVal strYEARMON As String, _
                                  ByVal strVOCH_GBN As String) As Object
        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = " SELECT YEARMON,"
                strSQL = strSQL & " VOCH_GBNNAME,"
                strSQL = strSQL & " CLIENTNAME, MEDNAME, REAL_MED_NAME, CLIENTSUBNAME,"
                strSQL = strSQL & " SUBSEQNAME, MEDFLAGNAME, EXCLIENTCODE, AMT, VAT, CLIENTCODE, "
                strSQL = strSQL & " MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, MEDFLAG,"
                strSQL = strSQL & " VOCH_GBN,TRU_TAX_FLAG, PROGNAME, MPP"
                strSQL = strSQL & " FROM("
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	SUBSTRING(DEMANDDAY,1,6) YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	CASE MED_FLAG WHEN 'MP01' THEN '신문'"
                strSQL = strSQL & " 	WHEN 'MP02' THEN '잡지'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAGNAME, EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(AMOUNT) AMT,"
                strSQL = strSQL & " 	SUM(CASE ISNULL(TRU_TAX_FLAG,'N') WHEN 'Y' THEN AMOUNT * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	CASE MED_FLAG WHEN 'MP01' THEN 'B'"
                strSQL = strSQL & " 	WHEN 'MP02' THEN 'C'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGRAM_NAME,'') PROGNAME, '' MPP"
                strSQL = strSQL & " 	FROM MD_BOOKING_MEDIUM"
                strSQL = strSQL & " 	WHERE SUBSTRING(DEMANDDAY,1,6) = '" & strYEARMON & "'"


                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY SUBSTRING(DEMANDDAY,1,6), "
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	MED_FLAG, EXCLIENTCODE, TRU_TAX_FLAG, ISNULL(PROGRAM_NAME,'')"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'CATV' MEDFLAGNAME,EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(AMT) AMT,"
                strSQL = strSQL & " 	SUM(CASE ISNULL(TRU_TAX_FLAG,'N') WHEN 'Y' THEN AMT * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	'A2' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGNAME,'') PROGNAME, MPP"
                strSQL = strSQL & " 	FROM MD_CATV_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,EXCLIENTCODE, "
                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGNAME,''), MPP"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'인터넷' MEDFLAGNAME,EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(AMT) AMT,"
                strSQL = strSQL & " 	SUM(CASE ISNULL(TRU_TAX_FLAG,'N') WHEN 'Y' THEN AMT * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	'O' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGRAM_NAME,'') PROGNAME, '' MPP"
                strSQL = strSQL & " 	FROM MD_INTERNET_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,EXCLIENTCODE, "
                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGRAM_NAME,'')"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	CASE INPUT_MEDFLAG WHEN '01' THEN 'TV'"
                strSQL = strSQL & " 	WHEN '02' THEN 'RD'"
                strSQL = strSQL & " 	WHEN '03' THEN 'RD'"
                strSQL = strSQL & " 	WHEN '10' THEN 'DMB'"
                strSQL = strSQL & " 	WHEN '20' THEN 'DMB'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAGNAME,EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(AMT) AMT,"
                strSQL = strSQL & " 	SUM(CASE ISNULL(TRU_TAX_FLAG,'N') WHEN 'Y' THEN AMT * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	INPUT_MEDFLAG  MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If

                strSQL = strSQL & " 	TRU_TAX_FLAG, ISNULL(PROGNAME,'') PROGNAME, '' MPP"
                strSQL = strSQL & " 	FROM MD_ELECTRIC_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON, "
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,EXCLIENTCODE, "
                strSQL = strSQL & " 	INPUT_MEDFLAG, TRU_TAX_FLAG, ISNULL(PROGNAME,'')"


                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'옥외' MEDFLAGNAME,'' EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(AMT) AMT,"
                strSQL = strSQL & " 	SUM(CASE ISNULL(TRU_TAX_FLAG,'N') WHEN 'Y' THEN AMT * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	'D' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	COMMI_TAX_FLAG TRU_TAX_FLAG, ISNULL(PROGNAME,'') PROGNAME, '' MPP"
                strSQL = strSQL & " 	FROM MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, MEDCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	COMMI_TAX_FLAG, ISNULL(PROGNAME,'')"

                strSQL = strSQL & " ) A"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    Public Function SelectRtn_REPORT(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strYEARMON As String, _
                                     ByVal strVOCH_GBN As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and YEARMON ='{0}'", strYEARMON) '년월
                If strVOCH_GBN <> "" Then Con2 = String.Format(" AND (VOCH_GBN = '{0}')", strVOCH_GBN) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                'YEARMON|VOCH_GBNNAME|CLIENTNAME|MEDNAME|REAL_MED_NAME|CLIENTSUBNAME|SUBSEQNAME|MEDFLAGNAME|
                'AMT|VAT|CLIENTCODE|MEDCODE|REAL_MED_CODE|CLIENTSUBCODE|SUBSEQ|MEDFLAG|VOCH_GBN|TRU_TAX_FLAG

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " YEARMON,"
                strFormet = strFormet & " CASE VOCH_GBN WHEN 'VOCH' THEN '확정분'"
                strFormet = strFormet & " ELSE '미확정분'"
                strFormet = strFormet & " END AS VOCH_GBNNAME,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strFormet = strFormet & " DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strFormet = strFormet & " CASE MEDFLAG "
                strFormet = strFormet & " WHEN '01' THEN 'TV'"
                strFormet = strFormet & " WHEN '02' THEN 'RD'"
                strFormet = strFormet & " WHEN '03' THEN 'RD'"
                strFormet = strFormet & " WHEN '10' THEN 'DMB'"
                strFormet = strFormet & " WHEN '20' THEN 'DMB'"
                strFormet = strFormet & " WHEN 'A2' THEN 'CATV'"
                strFormet = strFormet & " WHEN 'B' THEN '신문'"
                strFormet = strFormet & " WHEN 'C' THEN '잡지'"
                strFormet = strFormet & " WHEN 'O' THEN '인터넷'"
                strFormet = strFormet & " WHEN 'D' THEN '옥외'"
                strFormet = strFormet & " ELSE ''"
                strFormet = strFormet & " END MEDFLAGNAME,EXCLIENTCODE, "
                strFormet = strFormet & " AMT, VAT, "
                strFormet = strFormet & " CLIENTCODE,"
                strFormet = strFormet & " MEDCODE,"
                strFormet = strFormet & " REAL_MED_CODE,"
                strFormet = strFormet & " CLIENTSUBCODE,"
                strFormet = strFormet & " SUBSEQ,"
                strFormet = strFormet & " MEDFLAG,"
                strFormet = strFormet & " VOCH_GBN,"
                strFormet = strFormet & " TRU_TAX_FLAG,"
                strFormet = strFormet & " PROGNAME, MPP"
                strFormet = strFormet & " FROM MD_REPORT_MST_V WHERE 1=1 {0}"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_REPORT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    Public Function SelectRtn_LOWINCOME(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByVal strYEARMON As String, _
                                        ByVal strVOCH_GBN As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = " SELECT YEARMON,"
                strSQL = strSQL & " VOCH_GBNNAME,"
                strSQL = strSQL & " CLIENTNAME, REAL_MED_NAME, CLIENTSUBNAME, SUBSEQNAME,"
                strSQL = strSQL & " MEDFLAGNAME, EXCLIENTCODE, AMT, COMMISSION, VAT, EXSUSU, MCSUSU, CLIENTCODE, "
                strSQL = strSQL & " REAL_MED_CODE, MEDFLAG, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " VOCH_GBN,COMMI_TAX_FLAG"
                strSQL = strSQL & " FROM("
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	SUBSTRING(DEMANDDAY,1,6) YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	CASE MED_FLAG WHEN 'MP01' THEN '신문'"
                strSQL = strSQL & " 	WHEN 'MP02' THEN '잡지'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAGNAME, EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(ISNULL(AMOUNT,0)) AMT,"
                strSQL = strSQL & " 	SUM(ISNULL(COMMISSION,0)) COMMISSION,"
                strSQL = strSQL & " 	SUM(ISNULL(EXSUSU,0)) EXSUSU,"
                strSQL = strSQL & " 	SUM(ISNULL(MCSUSU,0)) MCSUSU,"

                strSQL = strSQL & " 	SUM(CASE ISNULL(COMMI_TAX_FLAG,'N') WHEN 'Y' THEN COMMISSION * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, REAL_MED_CODE,CLIENTSUBCODE, SUBSEQ,"
                strSQL = strSQL & " 	CASE MED_FLAG WHEN 'MP01' THEN 'B'"
                strSQL = strSQL & " 	WHEN 'MP02' THEN 'C'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	COMMI_TAX_FLAG"
                strSQL = strSQL & " 	FROM MD_BOOKING_MEDIUM"
                strSQL = strSQL & " 	WHERE SUBSTRING(DEMANDDAY,1,6) = '" & strYEARMON & "'"


                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY SUBSTRING(DEMANDDAY,1,6), "
                strSQL = strSQL & " 	CLIENTCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	MED_FLAG, EXCLIENTCODE, COMMI_TAX_FLAG"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'CATV' MEDFLAGNAME,EXCLIENTCODE, "

                strSQL = strSQL & " 	SUM(ISNULL(AMT,0)) AMT,"
                strSQL = strSQL & " 	SUM(ISNULL(COMMISSION,0)) COMMISSION,"
                strSQL = strSQL & " 	SUM(ISNULL(EXSUSU,0)) EXSUSU,"
                strSQL = strSQL & " 	SUM(ISNULL(MCSUSU,0)) MCSUSU,"

                strSQL = strSQL & " 	SUM(CASE ISNULL(COMMI_TAX_FLAG,'N') WHEN 'Y' THEN COMMISSION * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	'A2' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	COMMI_TAX_FLAG"
                strSQL = strSQL & " 	FROM MD_CATV_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, EXCLIENTCODE, "
                strSQL = strSQL & " 	COMMI_TAX_FLAG"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'인터넷' MEDFLAGNAME,EXCLIENTCODE, "

                strSQL = strSQL & " 	SUM(ISNULL(AMT,0)) AMT,"
                strSQL = strSQL & " 	SUM(ISNULL(COMMISSION,0)) COMMISSION,"
                strSQL = strSQL & " 	SUM(ISNULL(EXSUSU,0)) EXSUSU,"
                strSQL = strSQL & " 	SUM(ISNULL(MCSUSU,0)) MCSUSU,"

                strSQL = strSQL & " 	SUM(CASE ISNULL(COMMI_TAX_FLAG,'N') WHEN 'Y' THEN COMMISSION * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	'O' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	COMMI_TAX_FLAG"
                strSQL = strSQL & " 	FROM MD_INTERNET_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, EXCLIENTCODE, "
                strSQL = strSQL & " 	COMMI_TAX_FLAG"


                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	'' REAL_MED_NAME,"
                strSQL = strSQL & " 	'' CLIENTSUBNAME,"
                strSQL = strSQL & " 	'' SUBSEQNAME,"
                strSQL = strSQL & " 	CASE INPUT_MEDFLAG WHEN '01' THEN 'TV'"
                strSQL = strSQL & " 	WHEN '02' THEN 'RD'"
                strSQL = strSQL & " 	WHEN '03' THEN 'RD'"
                strSQL = strSQL & " 	WHEN '10' THEN 'DMB'"
                strSQL = strSQL & " 	WHEN '20' THEN 'DMB'"
                strSQL = strSQL & " 	ELSE ''"
                strSQL = strSQL & " 	END AS MEDFLAGNAME, EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(ISNULL(AMT,0)) AMT,"
                strSQL = strSQL & " 	SUM(ISNULL(COMMITION,0)) COMMISSION,"
                strSQL = strSQL & " 	SUM(ISNULL(EXCOMMITION,0)) EXSUSU,"
                strSQL = strSQL & " 	SUM(ISNULL(MCCOMMITION,0)) MCSUSU,"
                strSQL = strSQL & " 	SUM(COMMITION * 0.1)  VAT,"
                strSQL = strSQL & " 	CLIENTCODE, '' REAL_MED_CODE, '' CLIENTSUBCODE, '' SUBSEQ, "
                strSQL = strSQL & " 	INPUT_MEDFLAG AS MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If

                strSQL = strSQL & " 	'Y' COMMI_TAX_FLAG"
                strSQL = strSQL & " 	FROM V_EXCLIENT"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(VOCHFLAG,0)) = 1 "
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON, "
                strSQL = strSQL & " 	CLIENTCODE, EXCLIENTCODE, "
                strSQL = strSQL & " 	INPUT_MEDFLAG"

                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT "
                strSQL = strSQL & " 	YEARMON,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'전표확정분' VOCH_GBNNAME,"
                Else
                    strSQL = strSQL & " 	'전표미확정분' VOCH_GBNNAME,"
                End If

                strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strSQL = strSQL & " 	DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strSQL = strSQL & " 	DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strSQL = strSQL & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strSQL = strSQL & " 	'옥외' MEDFLAGNAME,'' EXCLIENTCODE, "
                strSQL = strSQL & " 	SUM(ISNULL(AMT,0)) AMT,"
                strSQL = strSQL & " 	SUM(ISNULL(AMT,0)) COMMISSION,"
                strSQL = strSQL & " 	SUM(ISNULL(OUT_AMT,0)) EXSUSU,"
                strSQL = strSQL & " 	SUM(ISNULL(COMMISSION,0)) MCSUSU,"

                strSQL = strSQL & " 	SUM(CASE ISNULL(COMMI_TAX_FLAG,'N') WHEN 'Y' THEN COMMISSION * 0.1 ELSE 0 END) AS VAT,"
                strSQL = strSQL & " 	CLIENTCODE, REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	'D' MEDFLAG,"
                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	'VOCH' VOCH_GBN,"
                Else
                    strSQL = strSQL & " 	'NOVOCH' VOCH_GBN,"
                End If
                strSQL = strSQL & " 	COMMI_TAX_FLAG"
                strSQL = strSQL & " 	FROM MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " 	WHERE YEARMON = '" & strYEARMON & "'"

                If strVOCH_GBN = "VOCH" Then
                    strSQL = strSQL & " 	AND (ISNULL(TRU_VOCH_NO,'') <> '' OR ISNULL(COMMI_VOCH_NO,'') <> '')"
                End If

                strSQL = strSQL & " 	GROUP BY YEARMON,"
                strSQL = strSQL & " 	CLIENTCODE, "
                strSQL = strSQL & " 	REAL_MED_CODE, CLIENTSUBCODE, SUBSEQ, "
                strSQL = strSQL & " 	COMMI_TAX_FLAG"


                strSQL = strSQL & " ) A"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_LOWINCOME")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_STATECHK(ByVal strInfoXML As String, _
                                       ByRef intRowCnt As Integer, _
                                       ByRef intColCnt As Integer, _
                                       ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = " select yearmon, voch_gbn, cdate"
                strSQL = strSQL & " from "
                strSQL = strSQL & " ("
                strSQL = strSQL & " 	select '01' yearmon,case when substring(yearmon,5,2) = '01' then voch_gbn else '' end voch_gbn,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '01' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '02' yearmon,case when substring(yearmon,5,2) = '02' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '02' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '03' yearmon,case when substring(yearmon,5,2) = '03' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '03' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '04' yearmon,case when substring(yearmon,5,2) = '04' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '04' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '05' yearmon,case when substring(yearmon,5,2) = '05' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '05' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '06' yearmon,case when substring(yearmon,5,2) = '06' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '06' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '07' yearmon,case when substring(yearmon,5,2) = '07' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '07' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '08' yearmon,case when substring(yearmon,5,2) = '08' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '08' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '09' yearmon,case when substring(yearmon,5,2) = '09' then voch_gbn else '' end voch_gbn,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '09' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '10' yearmon,case when substring(yearmon,5,2) = '10' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '10' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '11' yearmon,case when substring(yearmon,5,2) = '11' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '11' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '12' yearmon,case when substring(yearmon,5,2) = '12' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '12' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from MD_REPORT_MST_V where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " ) aaa"
                strSQL = strSQL & " GROUP BY yearmon, voch_gbn, cdate"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_STATECHKINCOME(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = " select yearmon, voch_gbn, cdate"
                strSQL = strSQL & " from "
                strSQL = strSQL & " ("
                strSQL = strSQL & " 	select '01' yearmon,case when substring(yearmon,5,2) = '01' then voch_gbn else '' end voch_gbn,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '01' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '02' yearmon,case when substring(yearmon,5,2) = '02' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '02' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '03' yearmon,case when substring(yearmon,5,2) = '03' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '03' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '04' yearmon,case when substring(yearmon,5,2) = '04' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '04' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '05' yearmon,case when substring(yearmon,5,2) = '05' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '05' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '06' yearmon,case when substring(yearmon,5,2) = '06' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '06' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '07' yearmon,case when substring(yearmon,5,2) = '07' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '07' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '08' yearmon,case when substring(yearmon,5,2) = '08' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '08' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '09' yearmon,case when substring(yearmon,5,2) = '09' then voch_gbn else '' end voch_gbn,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '09' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '10' yearmon,case when substring(yearmon,5,2) = '10' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '10' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '11' yearmon,case when substring(yearmon,5,2) = '11' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '11' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " 	union all"
                strSQL = strSQL & " 	select '12' yearmon,case when substring(yearmon,5,2) = '12' then voch_gbn else '' end voch_gbn ,  "
                strSQL = strSQL & " 	case when substring(yearmon,5,2) = '12' then convert(char(10),cdate,112) else '' end cdate"
                strSQL = strSQL & " 	from md_reportincome_mst where substring(yearmon,1,4) = '" & strYEAR & "' group by yearmon, voch_gbn, convert(char(10),cdate,112)"
                strSQL = strSQL & " ) aaa"
                strSQL = strSQL & " GROUP BY yearmon, voch_gbn, cdate"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_STATECHKINCOME")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_REPORTINCOME(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByVal strYEARMON As String, _
                                           ByVal strVOCH_GBN As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and YEARMON ='{0}'", strYEARMON) '년월
                If strVOCH_GBN <> "" Then Con2 = String.Format(" AND (VOCH_GBN = '{0}')", strVOCH_GBN) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " YEARMON,"
                strFormet = strFormet & " CASE VOCH_GBN WHEN 'VOCH' THEN '확정분'"
                strFormet = strFormet & " ELSE '미확정분'"
                strFormet = strFormet & " END AS VOCH_GBNNAME,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormet = strFormet & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME,"
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strFormet = strFormet & " DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strFormet = strFormet & " CASE MEDFLAG "
                strFormet = strFormet & " WHEN '01' THEN 'TV'"
                strFormet = strFormet & " WHEN '02' THEN 'RD'"
                strFormet = strFormet & " WHEN '03' THEN 'RD'"
                strFormet = strFormet & " WHEN '10' THEN 'DMB'"
                strFormet = strFormet & " WHEN '20' THEN 'DMB'"
                strFormet = strFormet & " WHEN 'A2' THEN 'CATV'"
                strFormet = strFormet & " WHEN 'B' THEN '신문'"
                strFormet = strFormet & " WHEN 'C' THEN '잡지'"
                strFormet = strFormet & " WHEN 'O' THEN '인터넷'"
                strFormet = strFormet & " WHEN 'D' THEN '옥외'"
                strFormet = strFormet & " ELSE ''"
                strFormet = strFormet & " END MEDFLAGNAME,EXCLIENTCODE, "
                strFormet = strFormet & " AMT, COMMISSION, VAT, EXSUSU, MCSUSU"
                strFormet = strFormet & " CLIENTCODE,"
                strFormet = strFormet & " REAL_MED_CODE,"
                strFormet = strFormet & " MEDFLAG,"
                strFormet = strFormet & " CLIENTSUBCODE,"
                strFormet = strFormet & " SUBSEQ,"
                strFormet = strFormet & " VOCH_GBN,"
                strFormet = strFormet & " COMMI_TAX_FLAG"
                strFormet = strFormet & " FROM MD_REPORTINCOME_MST WHERE 1=1 {0}"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_REPORT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 인쇄 세부 집행내역 MDCMPUBYEARMONAMTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_PUBYEARMONAMTLIST(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal strYEARMON As String, _
                                                ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" and substring(PUB_DATE , 1,6)='{0}'", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT "
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME, "
                strFormet = strFormet & " TIMCODE TIMNAME, "
                strFormet = strFormet & " SUBSEQ SUBSEQNAME, "
                strFormet = strFormet & " MATTERNAME,"
                strFormet = strFormet & " PUB_DATE, "
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, "
                strFormet = strFormet & " STD_STEP, "
                strFormet = strFormet & " DAN, "
                strFormet = strFormet & " STD_CM, "
                strFormet = strFormet & " COL_DEG, "
                strFormet = strFormet & " DBO.MD_GETPUBNAME_FUN(PUB_FACE) PUB_FACENAME, "
                strFormet = strFormet & " AMT, "
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) EXCLIENTNAME, "
                strFormet = strFormet & " DEMANDDAY, "
                strFormet = strFormet & " MEMO"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	CLIENTCODE, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 	TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQ,"
                strFormet = strFormet & " 	ISNULL(SUBSEQ,'') SUBSEQ2,"
                strFormet = strFormet & " 	DBO.MD_GET_MATTERNAME_FUN(MATTERCODE) MATTERNAME,"
                strFormet = strFormet & " 	DBO.MD_GET_MATTERNAME_FUN(MATTERCODE)  MATTERNAME2,"
                strFormet = strFormet & " 	PUB_DATE,"
                strFormet = strFormet & " 	MEDCODE,"
                strFormet = strFormet & " 	STD_STEP,"
                strFormet = strFormet & " 	'단' DAN,"
                strFormet = strFormet & " 	STD_CM,"
                strFormet = strFormet & " 	COL_DEG,"
                strFormet = strFormet & " 	PUB_FACE,"
                strFormet = strFormet & " 	SUM(AMT) AMT,"
                strFormet = strFormet & " 	EXCLIENTCODE,"
                strFormet = strFormet & " 	DEMANDDAY,"
                strFormet = strFormet & " 	MEMO, 1 SORTGBN"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE 1=1 {0} "
                strFormet = strFormet & " 	AND MED_FLAG = 'MP01'"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE, TIMCODE, "
                strFormet = strFormet & " 	ISNULL(SUBSEQ,''),MATTERCODE , PUB_DATE, MEDCODE,"
                strFormet = strFormet & " 	STD_STEP, STD_CM, COL_DEG, PUB_FACE, EXCLIENTCODE, "
                strFormet = strFormet & " 	DEMANDDAY, MEMO"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	CLIENTCODE, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMCODE,"
                strFormet = strFormet & " 	TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQ,"
                strFormet = strFormet & " 	ISNULL(SUBSEQ,'') SUBSEQ2,"
                strFormet = strFormet & " 	DBO.MD_GET_MATTERNAME_FUN(MATTERCODE)  + ' 합계' MATTERNAME,"
                strFormet = strFormet & " 	DBO.MD_GET_MATTERNAME_FUN(MATTERCODE)  MATTERNAME2,"
                strFormet = strFormet & " 	'' PUB_DATE,"
                strFormet = strFormet & " 	'' MEDCODE,"
                strFormet = strFormet & " 	NULL STD_STEP,"
                strFormet = strFormet & " 	'' DAN,"
                strFormet = strFormet & " 	NULL STD_CM,"
                strFormet = strFormet & " 	'' COL_DEG,"
                strFormet = strFormet & " 	'' PUB_FACE,"
                strFormet = strFormet & " 	SUM(AMT) AMT,"
                strFormet = strFormet & " 	'' EXCLIENTCODE,"
                strFormet = strFormet & " 	'' DEMANDDAY,"
                strFormet = strFormet & " 	'' MEMO, 2 SORTGBN"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE  1=1 {0} "
                strFormet = strFormet & " 	AND MED_FLAG = 'MP01'"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE, TIMCODE, ISNULL(SUBSEQ,''),MATTERCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	CLIENTCODE, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+ ' 요약'  TIMCODE,"
                strFormet = strFormet & " 	TIMCODE TIMCODE2,"
                strFormet = strFormet & " 	'' SUBSEQ,"
                strFormet = strFormet & " 	'ZZZZZZ' SUBSEQ2,"
                strFormet = strFormet & " 	'' MATTERNAME,"
                strFormet = strFormet & " 	'' MATTERNAME2,"
                strFormet = strFormet & " 	'' PUB_DATE,"
                strFormet = strFormet & " 	'' MEDCODE,"
                strFormet = strFormet & " 	NULL STD_STEP,"
                strFormet = strFormet & " 	'' DAN,"
                strFormet = strFormet & " 	NULL STD_CM,"
                strFormet = strFormet & " 	'' COL_DEG,"
                strFormet = strFormet & " 	'' PUB_FACE,"
                strFormet = strFormet & " 	SUM(AMT) AMT,"
                strFormet = strFormet & " 	'' EXCLIENTCODE,"
                strFormet = strFormet & " 	'' DEMANDDAY,"
                strFormet = strFormet & " 	'' MEMO, 3 SORTGBN"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE  1=1 {0} "
                strFormet = strFormet & " 	AND MED_FLAG = 'MP01'"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE, TIMCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT "
                strFormet = strFormet & " 	CLIENTCODE, "
                strFormet = strFormet & " 	'TOTAL' TIMCODE,"
                strFormet = strFormet & " 	'ZZZZZZ' TIMCODE2,"
                strFormet = strFormet & " 	'' SUBSEQ,"
                strFormet = strFormet & " 	'ZZZZZZ' SUBSEQ2,"
                strFormet = strFormet & " 	'' MATTERNAME,"
                strFormet = strFormet & " 	'' MATTERNAME2,"
                strFormet = strFormet & " 	'' PUB_DATE,"
                strFormet = strFormet & " 	'' MEDCODE,"
                strFormet = strFormet & " 	NULL STD_STEP,"
                strFormet = strFormet & " 	'' DAN,"
                strFormet = strFormet & " 	NULL STD_CM,"
                strFormet = strFormet & " 	'' COL_DEG,"
                strFormet = strFormet & " 	'' PUB_FACE,"
                strFormet = strFormet & " 	SUM(AMT) AMT,"
                strFormet = strFormet & " 	'' EXCLIENTCODE,"
                strFormet = strFormet & " 	'' DEMANDDAY,"
                strFormet = strFormet & " 	'' MEMO, 4 SORTGBN"
                strFormet = strFormet & " 	FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " 	WHERE  1=1 {0} "
                strFormet = strFormet & " 	AND MED_FLAG = 'MP01'"
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " ) AAA"
                strFormet = strFormet & " ORDER BY CLIENTCODE, TIMCODE2, SUBSEQ2, "
                strFormet = strFormet & " MATTERNAME2, MATTERNAME, PUB_DATE, "
                strFormet = strFormet & " MEDCODE, SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PUBYEARMONAMTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 인쇄 매체별 집행 내역 MDCMPRINTMEDAMTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_PRINTMEDAMTLIST(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strLIST As String, _
                                              ByVal strFROMMON As String, _
                                              ByVal strTOMON As String, _
                                              ByVal strMONCNT As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strMON
        Dim strFMON, strTMON
        Dim striLEN
        Dim strFLEN
        Dim strTLEN

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월
                If strLIST <> "" Then Con2 = String.Format(" AND (CLIENTCODE IN({0}))", strLIST) '년월

                strFLEN = Len(strFROMMON.ToString)
                strTLEN = Len(strTOMON.ToString)
                If strFROMMON <> "" And strTOMON <> "" Then
                    If strFLEN = 1 Then
                        strFMON = "0" & strFROMMON
                    Else
                        strFMON = strFROMMON
                    End If
                    If strTLEN = 1 Then
                        strTMON = "0" & strTOMON
                    Else
                        strTMON = strTOMON
                    End If

                    Con3 = String.Format(" AND SUBSTRING(YEARMON, 5,2) BETWEEN '{0}' AND '{1}'", strFMON, strTMON)
                End If

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = " SELECT CASE WHEN MEDFLAGNAME = 'ZZZZZZ' THEN DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)+ ' 합계' ELSE DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) END AS CLIENTNAME,"
                strFormet = strFormet & " MEDFLAGNAME, MEDCODE, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'신문' MEDFLAGNAME, '신문' MEDFLAGNAME2, 'B' MEDFLAG, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'잡지' MEDFLAGNAME, '잡지' MEDFLAGNAME2, 'C' MEDFLAG, "
                strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'신문 소계' MEDFLAGNAME, '신문' MEDFLAGNAME2, 'B' MEDFLAG, "
                strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'잡지 소계' MEDFLAGNAME, '잡지' MEDFLAGNAME2, 'C' MEDFLAG, "
                strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'합계' MEDFLAGNAME, 'ZZZZZZ' MEDFLAGNAME2, 'Z' MEDFLAG, "
                strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG in ('C','B') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B','C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " ) AA"
                strFormet = strFormet & " ORDER BY CLIENTCODE, MEDFLAGNAME2, MEDCODE2, MEDFLAG"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 월별세부 매체별 광고비 MDCMMONMEDLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_MONMEDLIST2(ByVal strInfoXML As String, _
                                          ByRef intRowCnt As Integer, _
                                          ByRef intColCnt As Integer, _
                                          ByVal strYEAR As String, _
                                          ByVal strCLIENTCODE As String, _
                                          ByVal strFROMMON As String, _
                                          ByVal strTOMON As String, _
                                          ByVal strMONCNT As String, _
                                          ByVal strMEDFLAGALL As String, _
                                          ByVal strMEDFLAG1 As String, _
                                          ByVal strMEDFLAG2 As String, _
                                          ByVal strMEDFLAG3 As String, _
                                          ByVal strMEDFLAG4 As String, _
                                          ByVal strMEDFLAG5 As String, _
                                          ByVal strMEDFLAG6 As String, _
                                          ByVal strMEDFLAG7 As String, _
                                          ByVal strMEDFLAG8 As String, _
                                          ByVal strMEDFLAG9 As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strMON
        Dim strFMON, strTMON
        Dim striLEN

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = "" : Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                Dim strFLEN
                Dim strTLEN
                strFLEN = Len(strFROMMON.ToString)
                strTLEN = Len(strTOMON.ToString)
                If strFROMMON <> "" And strTOMON <> "" Then
                    If strFLEN = 1 Then
                        strFMON = "0" & strFROMMON
                    Else
                        strFMON = strFROMMON
                    End If
                    If strTLEN = 1 Then
                        strTMON = "0" & strTOMON
                    Else
                        strTMON = strTOMON
                    End If

                    Con3 = String.Format(" AND SUBSTRING(YEARMON, 5,2) BETWEEN '{0}' AND '{1}' ", strFMON, strTMON)

                End If

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = " SELECT CASE WHEN MEDFLAGNAME = 'ZZZZZZ' THEN DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)+ ' 합계' ELSE DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) END AS CLIENTNAME, "
                strFormet = strFormet & " MEDFLAGNAME, MEDCODE, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, SUMAMT"
                strFormet = strFormet & " FROM ("


                If strMEDFLAGALL = "1" Or strMEDFLAG3 = "1" Then
                    'TV
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'TV' MEDFLAGNAME, 'AAAAAA' MEDFLAGNAME2, '01' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('01')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"


                    strFormet = strFormet & " 	UNION ALL"
                    'TV소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'TV 소계' MEDFLAGNAME, 'AAAAAA' MEDFLAGNAME2, '01' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('01')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG4 = "1" Then
                    'RD
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'Radio' MEDFLAGNAME, 'BBBBBB' MEDFLAGNAME2, '02' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('02', '03')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    'RD소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'Radio 소계' MEDFLAGNAME, 'BBBBBB' MEDFLAGNAME2, '02' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('02','03')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG5 = "1" Then
                    '지상파DMB
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'지상파DMB' MEDFLAGNAME, 'CCCCCC' MEDFLAGNAME2, '10' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('10', '20')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    '지상파DMB 소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'지상파DMB 소계' MEDFLAGNAME, 'CCCCCC' MEDFLAGNAME2, '10' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('10','20')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG6 = "1" Then
                    'CATV
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'CATV' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'A2' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('A2')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    'CATV소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'CATV 소계' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'A2' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('A2')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG9 = "1" Then
                    '종합편성방송
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'종합편성방송' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'T' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2, "

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'T' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('T') "
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    'CATV소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'종합편성방송 소계' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'T' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('T') "
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If

                If strMEDFLAGALL = "1" Or strMEDFLAG1 = "1" Then
                    '신문
                    strFormet = strFormet & " SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'신문' MEDFLAGNAME, 'EEEEEE' MEDFLAGNAME2, 'B' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('B')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    '신문소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'신문 소계' MEDFLAGNAME, 'EEEEEE' MEDFLAGNAME2, 'B' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('B')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG2 = "1" Then
                    '잡지
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'잡지' MEDFLAGNAME, 'FFFFFF' MEDFLAGNAME2, 'C' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('C')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    '잡지소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'잡지 소계' MEDFLAGNAME, 'FFFFFF' MEDFLAGNAME2, 'C' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('C')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                If strMEDFLAGALL = "1" Or strMEDFLAG7 = "1" Then
                    '인터넷
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'인터넷' MEDFLAGNAME, 'GGGGGG' MEDFLAGNAME2, 'O' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('O')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    '인터넷 소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'인터넷 소계' MEDFLAGNAME, 'GGGGGG' MEDFLAGNAME2, 'O' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('O')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If

                If strMEDFLAGALL = "1" Or strMEDFLAG8 = "1" Then
                    '옥외
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'옥외' MEDFLAGNAME, 'HHHHHH' MEDFLAGNAME2, 'D' MEDFLAG, "
                    strFormet = strFormet & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(MEDCODE) MEDCODE, MEDCODE MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('D')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE,MEDCODE"

                    strFormet = strFormet & " 	UNION ALL"
                    '옥외소계
                    strFormet = strFormet & " 	SELECT CLIENTCODE, "
                    strFormet = strFormet & " 	'옥외 소계' MEDFLAGNAME, 'HHHHHH' MEDFLAGNAME2, 'D' MEDFLAG, "
                    strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                    For i = 1 To 12
                        If i = 10 Or i = 11 Or i = 12 Then
                            strMON = i
                        Else
                            strMON = "0" & i
                        End If

                        If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        Else
                            strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                        End If
                    Next

                    strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                    strFormet = strFormet & " 	from MD_REPORT_MST_V"
                    strFormet = strFormet & " 	where 1=1 "
                    strFormet = strFormet & " 	AND MED_FLAG IN('D')"
                    strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                    strFormet = strFormet & " 	{0}  "
                    strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                    strFormet = strFormet & " 	UNION ALL"
                End If


                strFormet = strFormet & " 	SELECT CLIENTCODE, "
                strFormet = strFormet & " 	'합계' MEDFLAGNAME, 'ZZZZZZ' MEDFLAGNAME2, 'Z' MEDFLAG, "
                strFormet = strFormet & " 	'' MEDCODE, 'ZZZZZZ' MEDCODE2,"

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from MD_REPORT_MST_V"
                strFormet = strFormet & " 	where 1=1 "
                Dim strMED
                If strMEDFLAGALL <> 1 Then


                    If strMEDFLAG1 = 1 And strMED = "" Then
                        strMED = "'B'"
                    ElseIf strMEDFLAG1 = 1 And strMED <> "" Then
                        strMED = strMED & ",'B'"
                    End If

                    If strMEDFLAG2 = 1 And strMED = "" Then
                        strMED = "'C'"
                    ElseIf strMEDFLAG2 = 1 And strMED <> "" Then
                        strMED = strMED & ",'C'"
                    End If

                    If strMEDFLAG3 = 1 And strMED = "" Then
                        strMED = "'01'"
                    ElseIf strMEDFLAG3 = 1 And strMED <> "" Then
                        strMED = strMED & ",'01'"
                    End If

                    If strMEDFLAG4 = 1 And strMED = "" Then
                        strMED = "'02','03'"
                    ElseIf strMEDFLAG4 = 1 And strMED <> "" Then
                        strMED = strMED & ",'02','03'"
                    End If

                    If strMEDFLAG5 = 1 And strMED = "" Then
                        strMED = "'10','20'"
                    ElseIf strMEDFLAG5 = 1 And strMED <> "" Then
                        strMED = strMED & ",'10','20'"
                    End If

                    If strMEDFLAG6 = 1 And strMED = "" Then
                        strMED = "'A2'"
                    ElseIf strMEDFLAG6 = 1 And strMED <> "" Then
                        strMED = strMED & ",'A2'"
                    End If

                    If strMEDFLAG7 = 1 And strMED = "" Then
                        strMED = "'O'"
                    ElseIf strMEDFLAG7 = 1 And strMED <> "" Then
                        strMED = strMED & ",'O'"
                    End If

                    If strMEDFLAG8 = 1 And strMED = "" Then
                        strMED = "'D'"
                    ElseIf strMEDFLAG8 = 1 And strMED <> "" Then
                        strMED = strMED & ",'D'"
                    End If

                    If strMEDFLAG9 = 1 And strMED = "" Then
                        strMED = "'T'"
                    ElseIf strMEDFLAG9 = 1 And strMED <> "" Then
                        strMED = strMED & ",'T'"
                    End If

                    strFormet = strFormet & " 	AND MED_FLAG IN(" & strMED & ")"

                End If

                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY CLIENTCODE"
                strFormet = strFormet & " ) AA"
                strFormet = strFormet & " ORDER BY CLIENTCODE, MEDFLAGNAME2, MEDCODE2, MEDFLAG"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MONMEDLIST2")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 케이블 및 NEW MEDIA  집행내역 MDCMCATVANDNEWMEDIALIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CATVANDNEWMEDIALIST(ByVal strInfoXML As String, _
                                                  ByRef intRowCnt As Integer, _
                                                  ByRef intColCnt As Integer, _
                                                  ByVal strYEARMONLIST As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim intCUSTRows
        Dim objYEARMON

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objYEARMON = Split(strYEARMONLIST, "|")

                intCUSTRows = UBound(objYEARMON, 1)
                strSQL = strSQL & " SELECT yearflag, clientname, A1,A2,A3,A4,A5,A6,A7 from ( "
                For i = 0 To intCUSTRows
                    If i <> 0 Then
                        strSQL = strSQL & " UNION ALL"
                    End If


                    strSQL = strSQL & " select yearmon yearflag, dbo.SC_GET_HIGHCUSTNAME_FUN(clientcode) clientname, dbo.SC_GET_HIGHCUSTNAME_FUN(clientcode) clientname2,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00005' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00007' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00004' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00046', 'B00460','B00868') THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00047', 'B00461','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') not in('P00005','P00007','P00004') and medcode not in('B00046', 'B00460','B00047', 'B00461','B00868','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A7"
                    strSQL = strSQL & " from MD_REPORT_MST_V"
                    strSQL = strSQL & " where yearmon = '" & objYEARMON(i) & "'"
                    strSQL = strSQL & " and med_flag = 'A2'"
                    strSQL = strSQL & " group by yearmon, clientcode"
                    strSQL = strSQL & " union all "
                    strSQL = strSQL & " select yearmon yearflag, 'TOTAL' clientname, 'wwwwwwwwww' clientname2,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00005' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00007' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00004' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00046', 'B00460','B00868') THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00047', 'B00461','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') not in('P00005','P00007','P00004') and medcode not in('B00046', 'B00460','B00047', 'B00461','B00868','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                    strSQL = strSQL & " SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A7"
                    strSQL = strSQL & " from MD_REPORT_MST_V"
                    strSQL = strSQL & " where yearmon = '" & objYEARMON(i) & "'"
                    strSQL = strSQL & " and med_flag = 'A2'"
                    strSQL = strSQL & " group by yearmon"
                    strSQL = strSQL & " union all "
                    strSQL = strSQL & " select yearmon yearflag, '%' clientname, 'xxxxxxxxxx' clientname2,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00005' THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A1,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00007' THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A2,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00004' THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A3,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00046', 'B00460','B00868') THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A4,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='' and medcode in ('B00047', 'B00461','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A5,"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') not in('P00005','P00007','P00004') and medcode not in('B00046', 'B00460','B00047', 'B00461','B00868','B00517','B00869') THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' THEN ISNULL(AMT,0) ELSE 0 END ))*100 A6,"
                    strSQL = strSQL & " '100' A7"
                    strSQL = strSQL & " from MD_REPORT_MST_V"
                    strSQL = strSQL & " where yearmon = '" & objYEARMON(i) & "'"
                    strSQL = strSQL & " and med_flag = 'A2'"
                    strSQL = strSQL & " group by yearmon"
                    strSQL = strSQL & " union all "
                    strSQL = strSQL & " select yearmon yearflag, 'On Media vs CJ Media' clientname, 'yyyyyyyyyy' clientname2,"
                    strSQL = strSQL & " 0 A1,"
                    strSQL = strSQL & " CASE SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') in('P00007','P00004') THEN ISNULL(AMT,0) ELSE 0 END )"
                    strSQL = strSQL & " WHEN 0 THEN 0 ELSE"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00007' THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') in('P00007','P00004') THEN ISNULL(AMT,0) ELSE 0 END ))*100 END A2,"
                    strSQL = strSQL & " CASE SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') in('P00007','P00004') THEN ISNULL(AMT,0) ELSE 0 END )"
                    strSQL = strSQL & " WHEN 0 THEN 0 ELSE"
                    strSQL = strSQL & " (SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'')='P00004' THEN ISNULL(AMT,0) ELSE 0 END )/SUM(CASE WHEN yearmon = '" & objYEARMON(i) & "' and isnull(mpp,'') in('P00007','P00004') THEN ISNULL(AMT,0) ELSE 0 END ))*100 END A3,"
                    strSQL = strSQL & " 0 A4,"
                    strSQL = strSQL & " 0 A5,"
                    strSQL = strSQL & " 0 A6,"
                    strSQL = strSQL & " 0 A7"
                    strSQL = strSQL & " from MD_REPORT_MST_V"
                    strSQL = strSQL & " where yearmon = '" & objYEARMON(i) & "'"
                    strSQL = strSQL & " and med_flag = 'A2'"
                    strSQL = strSQL & " group by yearmon"


                Next
                strSQL = strSQL & " ) ttt  ORDER BY yearflag , CLIENTNAME2 "
                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CATVANDNEWMEDIALIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 인쇄 세부 집행내역 MDCMBRANDANDPROGNAMELIST
    '*************************************************************************************************************'
    Public Function SelectRtn_BRANDANDPROGNAMELIST(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strYEAR As String, _
                                                   ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN('{0}'))", strCLIENTCODE) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME, "
                strFormet = strFormet & "  MEDFLAGNAME, TIMNAME, SUBSEQNAME, MATTERNAME,"
                strFormet = strFormet & "  A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "  	SELECT CLIENTCODE, '신문' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 5 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('B')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '신문' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 5 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('B')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '신문' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 5 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('B')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '신문 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 5 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('B')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '잡지' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 6 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('C')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '잡지' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 6 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('C')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '잡지' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 6 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('C')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '잡지 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 6 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('C')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(YEARMON,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'TV' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('01')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'TV' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('01')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'TV' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('01')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'TV 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('01')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'RADIO' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 2 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('02','03')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'RADIO' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 2 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('02','03')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'RADIO' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 2 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('02','03')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'RADIO 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 2 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('02','03')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '지상파DMB' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 3 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('10','20')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '지상파DMB' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 3 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('10','20')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '지상파DMB' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 3 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('10','20')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '지상파DMB 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 3 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('10','20')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'CATV' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('A2') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('A2') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'CATV' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('A2') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('A2')  AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'CATV' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('A2') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('A2') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, 'CATV 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('A2') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('A2') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '종합편성방송' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('T') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('T') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '종합편성방송' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('T') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('T')  AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '종합편성방송' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('T') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('T') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '종합편성방송 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('T') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 4 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('T') AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '온라인' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) SUBSEQNAME, "
                strFormet = strFormet & "  	MATTERNAME, MATTERNAME MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('O') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 7 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('O')  AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,''), MATTERNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '온라인' MEDFLAGNAME, "
                strFormet = strFormet & "  	TIMCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, "
                strFormet = strFormet & "  	ISNULL(SUBSEQ,'') SUBSEQ, DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(ISNULL(SUBSEQ,'')) + ' 요약' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('O') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 7 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1 AND MED_FLAG IN('O')  AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE, ISNULL(SUBSEQ,'')"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '온라인' MEDFLAGNAME, TIMCODE, "
                strFormet = strFormet & "  	DBO.SC_GET_CUSTNAME_FUN(TIMCODE)+' 요약' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, '' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('O') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 7 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1  AND MED_FLAG IN('O')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE,TIMCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '온라인 요약' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('O') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 7 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1  AND MED_FLAG IN('O')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT CLIENTCODE, '합계' MEDFLAGNAME, "
                strFormet = strFormet & "  	'ZZZZZZ'TIMCODE, '' TIMNAME,"
                strFormet = strFormet & "  	'ZZZZZZ' SUBSEQ, '' SUBSEQNAME, "
                strFormet = strFormet & "  	'' MATTERNAME, 'ZZZZZZZZZZ' MATTERNAME2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END ) A1,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END ) A2,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END ) A3,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END ) A4,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END ) A5,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END ) A6,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END ) A7,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END ) A8,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END ) A9,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END ) A10,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END ) A11,"
                strFormet = strFormet & "  	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END ) A12,"
                strFormet = strFormet & "  	SUM(CASE WHEN MED_FLAG IN('01','02','03','10','20','A2','B','C','O') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 9 SORTGBN "
                strFormet = strFormet & "  	from MD_REPORT_MST_V"
                strFormet = strFormet & "  	where 1=1  AND MED_FLAG IN('01','02','03','10','20','A2','B','C','O')AND ISNULL(AMT,0) <> 0 "
                strFormet = strFormet & "  	and substring(yearmon,1,4) = '" & strYEAR & "' "
                strFormet = strFormet & "  	AND SUBSTRING(YEARMON, 5,2) BETWEEN '01' AND '12' {0}  	"
                strFormet = strFormet & "  	GROUP BY CLIENTCODE"
                strFormet = strFormet & "   ) AAA"
                strFormet = strFormet & "   ORDER BY CLIENTCODE, SORTGBN, MEDFLAGNAME, TIMCODE, SUBSEQ, MATTERNAME2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' CIC별 매체비 MDCMCICAMTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CICAMTLIST(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strYEAR As String, _
                                         ByVal strTOTALCNT As Integer, _
                                         ByVal strCLIENTSUBLIST As String) As Object     'XML  데이터 조회시

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENTSUB
        Dim intCUSTRows
        Dim intMEDRows
        Dim strCLIENTSUBCODE
        Dim strMEDCODE
        Dim mvntData

        Dim strCNT

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENTSUB = Split(strCLIENTSUBLIST, "♥")

                intCUSTRows = UBound(objCLIENTSUB, 1)
                strCLIENTSUBCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTSUBCODE = "'" & objCLIENTSUB(i) & "'"
                    Else
                        strCLIENTSUBCODE = strCLIENTSUBCODE & ",'" & objCLIENTSUB(i) & "'"
                    End If
                Next

                strCNT = 1
                strSQL = ""
                strSQL = " SELECT  "
                strSQL = strSQL & "   DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME,   "
                For j = 1 To 13 + 1
                    For i = 0 To intCUSTRows
                        If j < 10 Then
                            strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '0" & j & "' AND TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        ElseIf j = 13 Then
                            strSQL = strSQL & "   SUM(CASE WHEN TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        Else
                            strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & j & "' AND TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        End If
                        strCNT = strCNT + 1
                    Next
                    If j < 10 Then
                        strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '0" & j & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                    ElseIf j = 13 Then
                        strSQL = strSQL & "   SUM(ISNULL(AMT,0)) A" & strCNT & ","
                    Else
                        strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & j & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                    End If

                    strCNT = strCNT + 1
                Next
                strSQL = strSQL & "   SUM(ISNULL(AMT,0)) SUMAMT, DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) REAL_MED_NAME "
                strSQL = strSQL & "   from MD_REPORT_MST_V "
                strSQL = strSQL & "   where MED_FLAG = 'O' AND SUBSTRING(yearmon , 1,4)='" & strYEAR & "' and TIMCODE IN(" & strCLIENTSUBCODE & ") "
                strSQL = strSQL & "   GROUP BY MEDCODE, REAL_MED_CODE "

                strSQL = strSQL & " UNION ALL  "
                strSQL = strSQL & " SELECT  "
                strSQL = strSQL & "   '합계' MEDNAME ,  "
                For j = 1 To 13 + 1
                    For i = 0 To intCUSTRows
                        If j < 10 Then
                            strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '0" & j & "' AND TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        ElseIf j = 13 Then
                            strSQL = strSQL & "   SUM(CASE WHEN TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        Else
                            strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & j & "' AND TIMCODE = '" & objCLIENTSUB(i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                        End If
                        strCNT = strCNT + 1
                    Next
                    If j < 10 Then
                        strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '0" & j & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                    ElseIf j = 13 Then
                        strSQL = strSQL & "   SUM(ISNULL(AMT,0)) A" & strCNT & ","
                    Else
                        strSQL = strSQL & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & j & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & strCNT & ","
                    End If
                    strCNT = strCNT + 1
                Next
                strSQL = strSQL & "   SUM(ISNULL(AMT,0)) SUMAMT, '' REAL_MED_NAME"
                strSQL = strSQL & "   from MD_REPORT_MST_V "
                strSQL = strSQL & "   where MED_FLAG = 'O' AND SUBSTRING(yearmon , 1,4)='" & strYEAR & "' and TIMCODE IN(" & strCLIENTSUBCODE & ") "
                'strSQL = strSQL & "   GROUP BY SUBSTR(YEARMON,1,4) "

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CICAMTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetCLIENTSUBCNT(ByVal strInfoXML As String, _
                                    ByRef intRowCnt As Integer, _
                                    ByRef intColCnt As Integer, _
                                    ByRef strCLIENTSUBLIST As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim mvntData As Object
        Dim strMAXYEARMON
        Dim Con1 As String
        Dim objCLIENT
        Dim intCol, intRows
        Dim strCLIENTCODE
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)

                Con1 = ""

                If strCLIENTSUBLIST <> "" Then Con1 = String.Format(" AND (CUSTCODE IN({0}))", strCLIENTSUBLIST) '년월

                strWhere = BuildFields(" ", Con1)

                strFormat = " SELECT DBO.SC_GET_CUSTNAME_FUN(CUSTCODE) CUSTNAME, CUSTCODE From SC_CUST_DTL "
                strFormat = strFormat & "  WHERE 1=1  {0} order by custcode"

                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetEXCLIENTCODE(ByVal strInfoXML As String, _
                                    ByRef intRowCnt As Integer, _
                                    ByRef intColCnt As Integer, _
                                    ByRef strYEARMON As String, _
                                    ByRef strCLIENTCODE As String, _
                                    ByRef strTIMCODE As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim mvntData As Object
        Dim strMAXYEARMON
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT
        Dim intCol, intRows
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON ='{0}')", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE ='{0}')", strCLIENTCODE) '년월
                If strTIMCODE <> "" Then Con3 = String.Format(" AND (TIMCODE ='{0}')", strTIMCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                'strFormat = " select dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) exclientname,  exclientcode from md_internet_medium"
                'strFormat = strFormat & " where 1=1  {0} "
                'strFormat = strFormat & " and isnull(exclientcode, '') <> '' "
                'strFormat = strFormat & " group by exclientcode"

                strFormat = " select CASE WHEN ISNULL(dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE),'') = '' THEN '자체분' ELSE"
                strFormat = strFormat & " dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) END AS  exclientname,  "
                strFormat = strFormat & " CASE WHEN ISNULL(exclientcode,'') = '' THEN 'ZZZZZZ'"
                strFormat = strFormat & " ELSE EXCLIENTCODE "
                strFormat = strFormat & " END AS EXCLIENTCODE"
                strFormat = strFormat & " from MD_REPORT_MST_V"
                strFormat = strFormat & " where 1=1 AND MED_FLAG = 'O' {0} "
                strFormat = strFormat & " group by exclientcode"
                strFormat = strFormat & " ORDER BY EXCLIENTCODE"

                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetEXCLIENTCODE")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    '*************************************************************************************************************'
    ' 실적집계 (매체매출액) MDCMCLIENTYEARLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARLIST(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByVal strYEAR As String, _
                                             ByVal strGBN As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                If strGBN = "ALL" Then
                    strCOMMISSION = "ISNULL(COMMISSION,0)"
                Else
                    strCOMMISSION = "ISNULL(COMMISSION,0) - ISNULL(EXSUSU,0)"
                End If

                strFormet = " select"
                strFormet = strFormet & " clientname, "
                strFormet = strFormet & " isnull(A1,0) A1,ISNULL(A2,0) A2, ISNULL(A3,0) A3, ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & " isnull(A7,0) A7,ISNULL(A8,0) A8, ISNULL(A9,0) A9, ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & " ISNULL(Q1,0) Q1, ISNULL(Q2,0) Q2, ISNULL(Q3,0) Q3, ISNULL(Q4,0) Q4, ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then " & strCOMMISSION & " else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then " & strCOMMISSION & " else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then " & strCOMMISSION & " else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then " & strCOMMISSION & " else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then " & strCOMMISSION & " else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then " & strCOMMISSION & " else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then " & strCOMMISSION & " else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then " & strCOMMISSION & " else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then " & strCOMMISSION & " else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then " & strCOMMISSION & " else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then " & strCOMMISSION & " else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then " & strCOMMISSION & " else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then " & strCOMMISSION & " else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then " & strCOMMISSION & " else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then " & strCOMMISSION & " else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then " & strCOMMISSION & " else 0 end) Q4,"
                strFormet = strFormet & " 	sum(" & strCOMMISSION & ") SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by clientcode"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '계열' clientname, "
                strFormet = strFormet & " 	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then " & strCOMMISSION & " else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then " & strCOMMISSION & " else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then " & strCOMMISSION & " else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then " & strCOMMISSION & " else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then " & strCOMMISSION & " else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then " & strCOMMISSION & " else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then " & strCOMMISSION & " else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then " & strCOMMISSION & " else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then " & strCOMMISSION & " else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then " & strCOMMISSION & " else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then " & strCOMMISSION & " else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then " & strCOMMISSION & " else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then " & strCOMMISSION & " else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then " & strCOMMISSION & " else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then " & strCOMMISSION & " else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then " & strCOMMISSION & " else 0 end) Q4,"
                strFormet = strFormet & " 	sum(" & strCOMMISSION & ") SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '비계열' clientname, "
                strFormet = strFormet & " 	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then " & strCOMMISSION & " else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then " & strCOMMISSION & " else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then " & strCOMMISSION & " else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then " & strCOMMISSION & " else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then " & strCOMMISSION & " else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then " & strCOMMISSION & " else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then " & strCOMMISSION & " else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then " & strCOMMISSION & " else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then " & strCOMMISSION & " else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then " & strCOMMISSION & " else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then " & strCOMMISSION & " else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then " & strCOMMISSION & " else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then " & strCOMMISSION & " else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then " & strCOMMISSION & " else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then " & strCOMMISSION & " else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then " & strCOMMISSION & " else 0 end) Q4,"
                strFormet = strFormet & " 	sum(" & strCOMMISSION & ") SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '합계' clientname, "
                strFormet = strFormet & " 	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then " & strCOMMISSION & " else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then " & strCOMMISSION & " else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then " & strCOMMISSION & " else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then " & strCOMMISSION & " else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then " & strCOMMISSION & " else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then " & strCOMMISSION & " else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then " & strCOMMISSION & " else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then " & strCOMMISSION & " else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then " & strCOMMISSION & " else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then " & strCOMMISSION & " else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then " & strCOMMISSION & " else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then " & strCOMMISSION & " else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then " & strCOMMISSION & " else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then " & strCOMMISSION & " else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then " & strCOMMISSION & " else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then " & strCOMMISSION & " else 0 end) Q4,"
                strFormet = strFormet & " 	sum(" & strCOMMISSION & ") SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " ) AAA "
                strFormet = strFormet & " order by clientname2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 실적집계 (제작매출액) MDCMCLIENTYEARLISTPD
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARLISTPD(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(taxyearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = " select"
                strFormet = strFormet & " clientname, "
                strFormet = strFormet & " isnull(A1,0) A1,ISNULL(A2,0) A2, ISNULL(A3,0) A3, ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & " isnull(A7,0) A7,ISNULL(A8,0) A8, ISNULL(A9,0) A9, ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & " ISNULL(Q1,0) Q1, ISNULL(Q2,0) Q2, ISNULL(Q3,0) Q3, ISNULL(Q4,0) Q4, ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by clientcode"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '계열' clientname, "
                strFormet = strFormet & " 	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '비계열' clientname, "
                strFormet = strFormet & " 	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '합계' clientname, "
                strFormet = strFormet & " 	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " ) AAA "
                strFormet = strFormet & " order by clientname2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 실적집계 (제작매체부문별 매출액) MDCMCLIENTYEARLISTPDGUBUN
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARLISTPDGUBUN(ByVal strInfoXML As String, _
                                                    ByRef intRowCnt As Integer, _
                                                    ByRef intColCnt As Integer, _
                                                    ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(taxyearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " select"
                strFormet = strFormet & " jobgubun,"
                strFormet = strFormet & " clientname, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & " Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun),clientcode"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'계열' clientname, "
                strFormet = strFormet & " 	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(case when dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'비계열' clientname, "
                strFormet = strFormet & " 	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(case when  dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' then isnull(amt,0) else 0 end) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'합계' clientname, "
                strFormet = strFormet & " 	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(taxyearmon,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	from pd_tax_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " ) AAA "
                strFormet = strFormet & " order by jobgubun, clientname2"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 실적집계 (취급액) MDCMCLIENTYEARAMTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARAMTLIST(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = " SELECT "
                strFormet = strFormet & " CLIENTNAME,"
                strFormet = strFormet & " ISNULL(A1,0) A1, ISNULL(A2,0) A2, ISNULL(A3,0) A3, "
                strFormet = strFormet & " ISNULL(A4,0) A4, ISNULL(A5,0) A5, ISNULL(A6,0) A6,"
                strFormet = strFormet & " ISNULL(A7,0) A7, ISNULL(A8,0) A8, ISNULL(A9,0) A9, "
                strFormet = strFormet & " ISNULL(A10,0) A10, ISNULL(A11,0) A11, ISNULL(A12,0) A12,"
                strFormet = strFormet & " ISNULL(Q1,0) Q1, ISNULL(Q2,0) Q2, ISNULL(Q3,0) Q3, ISNULL(Q4,0) Q4,"
                strFormet = strFormet & " ISNULL(SUMAMT,0) SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by clientcode"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '계열' clientname, "
                strFormet = strFormet & " 	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '비계열' clientname, "
                strFormet = strFormet & " 	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' {0} "
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select '합계' clientname, "
                strFormet = strFormet & " 	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 	sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 	from md_reportincome_mst"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " ) AAA "
                strFormet = strFormet & " order by clientname2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_CLIENTYEARAMTLISTALL(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                'If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월
                'strWhere = BuildFields(" ", Con1)

                strSQL = strSQL & " select"
                strSQL = strSQL & " clientname, "
                strSQL = strSQL & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strSQL = strSQL & " Q1,Q2,Q3,Q4, SUMAMT"
                strSQL = strSQL & " FROM ("
                strSQL = strSQL & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strSQL = strSQL & " 	SUM(ISNULL(A1,0)) A1, SUM(ISNULL(A2,0)) A2, SUM(ISNULL(A3,0)) A3, "
                strSQL = strSQL & " 	SUM(ISNULL(A4,0)) A4, SUM(ISNULL(A5,0)) A5, SUM(ISNULL(A6,0)) A6,"
                strSQL = strSQL & " 	SUM(ISNULL(A7,0)) A7, SUM(ISNULL(A8,0)) A8, SUM(ISNULL(A9,0)) A9, "
                strSQL = strSQL & " 	SUM(ISNULL(A10,0)) A10, SUM(ISNULL(A11,0)) A11, SUM(ISNULL(A12,0)) A12,"
                strSQL = strSQL & " 	SUM(ISNULL(Q1,0)) Q1, SUM(ISNULL(Q2,0)) Q2, SUM(ISNULL(Q3,0)) Q3, SUM(ISNULL(Q4,0)) Q4,"
                strSQL = strSQL & " 	SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " 	FROM(	"
                strSQL = strSQL & " 		select dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strSQL = strSQL & " 		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from md_reportincome_mst"
                strSQL = strSQL & " 		where 1=1 AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 		group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strSQL = strSQL & " 		UNION ALL"
                strSQL = strSQL & " 		SELECT "
                strSQL = strSQL & " 		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strSQL = strSQL & " 		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		FROM PD_TAX_MST"
                strSQL = strSQL & " 		where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 		group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strSQL = strSQL & " 	) AAA"
                strSQL = strSQL & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strSQL = strSQL & " 	SUM(ISNULL(A1,0)) A1, SUM(ISNULL(A2,0)) A2, SUM(ISNULL(A3,0)) A3, "
                strSQL = strSQL & " 	SUM(ISNULL(A4,0)) A4, SUM(ISNULL(A5,0)) A5, SUM(ISNULL(A6,0)) A6,"
                strSQL = strSQL & " 	SUM(ISNULL(A7,0)) A7, SUM(ISNULL(A8,0)) A8, SUM(ISNULL(A9,0)) A9, "
                strSQL = strSQL & " 	SUM(ISNULL(A10,0)) A10, SUM(ISNULL(A11,0)) A11, SUM(ISNULL(A12,0)) A12,"
                strSQL = strSQL & " 	SUM(ISNULL(Q1,0)) Q1, SUM(ISNULL(Q2,0)) Q2, SUM(ISNULL(Q3,0)) Q3, SUM(ISNULL(Q4,0)) Q4,"
                strSQL = strSQL & " 	SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " 	FROM(		"
                strSQL = strSQL & " 		select '계열' clientname, "
                strSQL = strSQL & " 		'xxxxxxxxxx' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from md_reportincome_mst"
                strSQL = strSQL & " 		where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' "
                strSQL = strSQL & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 		UNION ALL"
                strSQL = strSQL & " 		select '계열' clientname, "
                strSQL = strSQL & " 		'xxxxxxxxxx' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from PD_TAX_MST"
                strSQL = strSQL & " 		where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' "
                strSQL = strSQL & " 		AND SUBSTRING(taxyearmon,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 	) AAA"
                strSQL = strSQL & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strSQL = strSQL & " 	SUM(ISNULL(A1,0)) A1, SUM(ISNULL(A2,0)) A2, SUM(ISNULL(A3,0)) A3, "
                strSQL = strSQL & " 	SUM(ISNULL(A4,0)) A4, SUM(ISNULL(A5,0)) A5, SUM(ISNULL(A6,0)) A6,"
                strSQL = strSQL & " 	SUM(ISNULL(A7,0)) A7, SUM(ISNULL(A8,0)) A8, SUM(ISNULL(A9,0)) A9, "
                strSQL = strSQL & " 	SUM(ISNULL(A10,0)) A10, SUM(ISNULL(A11,0)) A11, SUM(ISNULL(A12,0)) A12,"
                strSQL = strSQL & " 	SUM(ISNULL(Q1,0)) Q1, SUM(ISNULL(Q2,0)) Q2, SUM(ISNULL(Q3,0)) Q3, SUM(ISNULL(Q4,0)) Q4,"
                strSQL = strSQL & " 	SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " 	FROM(	"
                strSQL = strSQL & " 		select '비계열' clientname, "
                strSQL = strSQL & " 		'yyyyyyyyyy' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from md_reportincome_mst"
                strSQL = strSQL & " 		where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' "
                strSQL = strSQL & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 		UNION ALL"
                strSQL = strSQL & " 		select '비계열' clientname, "
                strSQL = strSQL & " 		'yyyyyyyyyy' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from PD_TAX_MST"
                strSQL = strSQL & " 		where 1=1 and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' "
                strSQL = strSQL & " 		AND SUBSTRING(taxyearmon,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 	) AAA"
                strSQL = strSQL & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strSQL = strSQL & " 	UNION ALL"
                strSQL = strSQL & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strSQL = strSQL & " 	SUM(ISNULL(A1,0)) A1, SUM(ISNULL(A2,0)) A2, SUM(ISNULL(A3,0)) A3, "
                strSQL = strSQL & " 	SUM(ISNULL(A4,0)) A4, SUM(ISNULL(A5,0)) A5, SUM(ISNULL(A6,0)) A6,"
                strSQL = strSQL & " 	SUM(ISNULL(A7,0)) A7, SUM(ISNULL(A8,0)) A8, SUM(ISNULL(A9,0)) A9, "
                strSQL = strSQL & " 	SUM(ISNULL(A10,0)) A10, SUM(ISNULL(A11,0)) A11, SUM(ISNULL(A12,0)) A12,"
                strSQL = strSQL & " 	SUM(ISNULL(Q1,0)) Q1, SUM(ISNULL(Q2,0)) Q2, SUM(ISNULL(Q3,0)) Q3, SUM(ISNULL(Q4,0)) Q4,"
                strSQL = strSQL & " 	SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " 	FROM(	"
                strSQL = strSQL & " 		select '합계' clientname, "
                strSQL = strSQL & " 		'zzzzzzzzzz' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from md_reportincome_mst"
                strSQL = strSQL & " 		where 1=1 AND  SUBSTRING(yearmon,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 		UNION ALL"
                strSQL = strSQL & " 		select '합계' clientname, "
                strSQL = strSQL & " 		'zzzzzzzzzz' clientname2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from PD_TAX_MST"
                strSQL = strSQL & " 		where 1=1 "
                strSQL = strSQL & " 		AND SUBSTRING(taxyearmon,1,4) = '" & strYEAR & "'"
                strSQL = strSQL & " 	) AAA"
                strSQL = strSQL & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strSQL = strSQL & " ) BBB"
                strSQL = strSQL & " order by clientname2"

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 실적집계 (외주비) MDCMCLIENTYEARMEDEXSUSULISTALL
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARMEDEXSUSULISTALL(ByVal strInfoXML As String, _
                                                         ByRef intRowCnt As Integer, _
                                                         ByRef intColCnt As Integer, _
                                                         ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                'If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                'strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " select"
                strFormet = strFormet & " clientname, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & " Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strFormet = strFormet & " 	SUM(ISNULL(A1,0)) A1,SUM(ISNULL(A2,0)) A2,SUM(ISNULL(A3,0)) A3,SUM(ISNULL(A4,0)) A4,"
                strFormet = strFormet & " 	SUM(ISNULL(A5,0)) A5,SUM(ISNULL(A6,0)) A6,SUM(ISNULL(A7,0)) A7,SUM(ISNULL(A8,0)) A8,"
                strFormet = strFormet & " 	SUM(ISNULL(A9,0)) A9,SUM(ISNULL(A10,0)) A10,SUM(ISNULL(A11,0)) A11,SUM(ISNULL(A12,0)) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(Q1,0)) Q1,SUM(ISNULL(Q2,0)) Q2,SUM(ISNULL(Q3,0)) Q3,SUM(ISNULL(Q4,0)) Q4,"
                strFormet = strFormet & " 	SUM(ISNULL(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM("
                'strFormet = strFormet & " 		select dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                'strFormet = strFormet & " 		 dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '01' then isnull(exsusu,0) else 0 end) A1,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '02' then isnull(exsusu,0) else 0 end) A2,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '03' then isnull(exsusu,0) else 0 end) A3,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '04' then isnull(exsusu,0) else 0 end) A4,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '05' then isnull(exsusu,0) else 0 end) A5,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '06' then isnull(exsusu,0) else 0 end) A6,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '07' then isnull(exsusu,0) else 0 end) A7,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '08' then isnull(exsusu,0) else 0 end) A8,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '09' then isnull(exsusu,0) else 0 end) A9,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '10' then isnull(exsusu,0) else 0 end) A10,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '11' then isnull(exsusu,0) else 0 end) A11,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) = '12' then isnull(exsusu,0) else 0 end) A12,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(exsusu,0) else 0 end) Q1,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(exsusu,0) else 0 end) Q2,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(exsusu,0) else 0 end) Q3,"
                'strFormet = strFormet & " 		 sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(exsusu,0) else 0 end) Q4,"
                'strFormet = strFormet & " 		 sum(isnull(exsusu,0)) SUMAMT"
                'strFormet = strFormet & " 		 from md_reportincome_mst"
                'strFormet = strFormet & " 		 where 1=1 "
                'strFormet = strFormet & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                'strFormet = strFormet & " 		 group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                'strFormet = strFormet & " 		union all"
                strFormet = strFormet & " 		SELECT"
                strFormet = strFormet & " 		DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname,"
                strFormet = strFormet & " 		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 		FROM"
                strFormet = strFormet & " 		("
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_EXE_DTL"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 			UNION ALL"
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_ACC_MST"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		) SUBDATA"
                strFormet = strFormet & " 		GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE), ADJDAY"
                strFormet = strFormet & " 	) AAA"
                strFormet = strFormet & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strFormet = strFormet & " 	SUM(ISNULL(A1,0)) A1,SUM(ISNULL(A2,0)) A2,SUM(ISNULL(A3,0)) A3,SUM(ISNULL(A4,0)) A4,"
                strFormet = strFormet & " 	SUM(ISNULL(A5,0)) A5,SUM(ISNULL(A6,0)) A6,SUM(ISNULL(A7,0)) A7,SUM(ISNULL(A8,0)) A8,"
                strFormet = strFormet & " 	SUM(ISNULL(A9,0)) A9,SUM(ISNULL(A10,0)) A10,SUM(ISNULL(A11,0)) A11,SUM(ISNULL(A12,0)) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(Q1,0)) Q1,SUM(ISNULL(Q2,0)) Q2,SUM(ISNULL(Q3,0)) Q3,SUM(ISNULL(Q4,0)) Q4,"
                strFormet = strFormet & " 	SUM(ISNULL(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM("
                'strFormet = strFormet & " 		select '계열' clientname, "
                'strFormet = strFormet & " 		'xxxxxxxxxx' clientname2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(EXSUSU,0) else 0 end) A1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(EXSUSU,0) else 0 end) A2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(EXSUSU,0) else 0 end) A3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(EXSUSU,0) else 0 end) A4,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(EXSUSU,0) else 0 end) A5,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(EXSUSU,0) else 0 end) A6,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(EXSUSU,0) else 0 end) A7,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(EXSUSU,0) else 0 end) A8,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(EXSUSU,0) else 0 end) A9,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(EXSUSU,0) else 0 end) A10,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(EXSUSU,0) else 0 end) A11,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(EXSUSU,0) else 0 end) A12,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(EXSUSU,0) else 0 end) Q1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(EXSUSU,0) else 0 end) Q2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(EXSUSU,0) else 0 end) Q3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(EXSUSU,0) else 0 end) Q4,"
                'strFormet = strFormet & " 		sum(isnull(EXSUSU,0)) SUMAMT"
                'strFormet = strFormet & " 		from md_reportincome_mst"
                'strFormet = strFormet & " 		where 1=1 "
                'strFormet = strFormet & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                'strFormet = strFormet & " 		and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' "
                'strFormet = strFormet & " 		union all"
                strFormet = strFormet & " 		select '계열' clientname, "
                strFormet = strFormet & " 		'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 		FROM"
                strFormet = strFormet & " 		("
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_EXE_DTL"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 			UNION ALL"
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_ACC_MST"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		) SUBDATA"
                strFormet = strFormet & " 		WHERE 1=1"
                strFormet = strFormet & " 		and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2'"
                strFormet = strFormet & " 	) AAA"
                strFormet = strFormet & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strFormet = strFormet & " 	SUM(ISNULL(A1,0)) A1,SUM(ISNULL(A2,0)) A2,SUM(ISNULL(A3,0)) A3,SUM(ISNULL(A4,0)) A4,"
                strFormet = strFormet & " 	SUM(ISNULL(A5,0)) A5,SUM(ISNULL(A6,0)) A6,SUM(ISNULL(A7,0)) A7,SUM(ISNULL(A8,0)) A8,"
                strFormet = strFormet & " 	SUM(ISNULL(A9,0)) A9,SUM(ISNULL(A10,0)) A10,SUM(ISNULL(A11,0)) A11,SUM(ISNULL(A12,0)) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(Q1,0)) Q1,SUM(ISNULL(Q2,0)) Q2,SUM(ISNULL(Q3,0)) Q3,SUM(ISNULL(Q4,0)) Q4,"
                strFormet = strFormet & " 	SUM(ISNULL(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM("
                'strFormet = strFormet & " 		select '비계열' clientname, "
                'strFormet = strFormet & " 		'yyyyyyyyyy' clientname2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(EXSUSU,0) else 0 end) A1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(EXSUSU,0) else 0 end) A2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(EXSUSU,0) else 0 end) A3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(EXSUSU,0) else 0 end) A4,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(EXSUSU,0) else 0 end) A5,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(EXSUSU,0) else 0 end) A6,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(EXSUSU,0) else 0 end) A7,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(EXSUSU,0) else 0 end) A8,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(EXSUSU,0) else 0 end) A9,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(EXSUSU,0) else 0 end) A10,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(EXSUSU,0) else 0 end) A11,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(EXSUSU,0) else 0 end) A12,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(EXSUSU,0) else 0 end) Q1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(EXSUSU,0) else 0 end) Q2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(EXSUSU,0) else 0 end) Q3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(EXSUSU,0) else 0 end) Q4,"
                'strFormet = strFormet & " 		sum(isnull(EXSUSU,0)) SUMAMT"
                'strFormet = strFormet & " 		from md_reportincome_mst"
                'strFormet = strFormet & " 		where 1=1 "
                'strFormet = strFormet & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "'"
                'strFormet = strFormet & " 		and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' "
                'strFormet = strFormet & " 		union all"
                strFormet = strFormet & " 		select '비계열' clientname, "
                strFormet = strFormet & " 		'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 		FROM"
                strFormet = strFormet & " 		("
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_EXE_DTL"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 			UNION ALL"
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_ACC_MST"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		) SUBDATA"
                strFormet = strFormet & " 		WHERE 1=1"
                strFormet = strFormet & " 		and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'"
                strFormet = strFormet & " 	) AAA"
                strFormet = strFormet & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strFormet = strFormet & " 	UNION ALL"
                strFormet = strFormet & " 	SELECT CLIENTNAME, CLIENTNAME2,"
                strFormet = strFormet & " 	SUM(ISNULL(A1,0)) A1,SUM(ISNULL(A2,0)) A2,SUM(ISNULL(A3,0)) A3,SUM(ISNULL(A4,0)) A4,"
                strFormet = strFormet & " 	SUM(ISNULL(A5,0)) A5,SUM(ISNULL(A6,0)) A6,SUM(ISNULL(A7,0)) A7,SUM(ISNULL(A8,0)) A8,"
                strFormet = strFormet & " 	SUM(ISNULL(A9,0)) A9,SUM(ISNULL(A10,0)) A10,SUM(ISNULL(A11,0)) A11,SUM(ISNULL(A12,0)) A12,"
                strFormet = strFormet & " 	SUM(ISNULL(Q1,0)) Q1,SUM(ISNULL(Q2,0)) Q2,SUM(ISNULL(Q3,0)) Q3,SUM(ISNULL(Q4,0)) Q4,"
                strFormet = strFormet & " 	SUM(ISNULL(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & " 	FROM("
                'strFormet = strFormet & " 		select '합계' clientname, "
                'strFormet = strFormet & " 		'zzzzzzzzzz' clientname2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(EXSUSU,0) else 0 end) A1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(EXSUSU,0) else 0 end) A2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(EXSUSU,0) else 0 end) A3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(EXSUSU,0) else 0 end) A4,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(EXSUSU,0) else 0 end) A5,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(EXSUSU,0) else 0 end) A6,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(EXSUSU,0) else 0 end) A7,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(EXSUSU,0) else 0 end) A8,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(EXSUSU,0) else 0 end) A9,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(EXSUSU,0) else 0 end) A10,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(EXSUSU,0) else 0 end) A11,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(EXSUSU,0) else 0 end) A12,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(EXSUSU,0) else 0 end) Q1,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(EXSUSU,0) else 0 end) Q2,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(EXSUSU,0) else 0 end) Q3,"
                'strFormet = strFormet & " 		sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(EXSUSU,0) else 0 end) Q4,"
                'strFormet = strFormet & " 		sum(isnull(EXSUSU,0)) SUMAMT"
                'strFormet = strFormet & " 		from md_reportincome_mst"
                'strFormet = strFormet & " 		where 1=1 "
                'strFormet = strFormet & " 		AND SUBSTRING(YEARMON,1,4) = '" & strYEAR & "' "
                'strFormet = strFormet & " 		UNION ALL"
                strFormet = strFormet & " 		select '합계' clientname, "
                strFormet = strFormet & " 		'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & " 		sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & " 		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & " 		FROM"
                strFormet = strFormet & " 		("
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_EXE_DTL"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 			UNION ALL"
                strFormet = strFormet & " 			SELECT OUTSCODE CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 			FROM PD_ACC_MST"
                strFormet = strFormet & " 			WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 			AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		) SUBDATA"
                strFormet = strFormet & " 		WHERE 1=1"
                strFormet = strFormet & " 	) AAA"
                strFormet = strFormet & " 	GROUP BY CLIENTNAME, CLIENTNAME2"
                strFormet = strFormet & " ) BBB"
                strFormet = strFormet & " ORDER BY CLIENTNAME2"

                strSQL = strFormet

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 실적집계 (제작대행사수수료) MDCMCLIENTYEARMEDEXSUSULIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARMEDEXSUSULIST(ByVal strInfoXML As String, _
                                                      ByRef intRowCnt As Integer, _
                                                      ByRef intColCnt As Integer, _
                                                      ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " select"
                strFormet = strFormet & "  clientname, "
                strFormet = strFormet & "  A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & "  Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "  	select "
                strFormet = strFormet & " 	case when isnull(dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE),'') ='' then '자체분' "
                strFormet = strFormet & " 			else dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) end as clientname, "
                strFormet = strFormet & "  	case when isnull(dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE),'') ='' then 'wwwwwwww'"
                strFormet = strFormet & " 			else dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) end as clientname2, "
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '01' then isnull(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '02' then isnull(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '03' then isnull(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '04' then isnull(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '05' then isnull(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '06' then isnull(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '07' then isnull(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '08' then isnull(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '09' then isnull(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '10' then isnull(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '11' then isnull(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '12' then isnull(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  	sum(isnull(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  	from md_reportincome_mst"
                strFormet = strFormet & "  	where 1=1 {0} "
                strFormet = strFormet & "  	group by dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE)"
                strFormet = strFormet & "  	union all"
                strFormet = strFormet & "  	select '계열' clientname, "
                strFormet = strFormet & "  	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '01' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='') then isnull(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '02' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '03' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '04' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '05' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '06' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '07' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '08' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '09' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '10' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '11' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '12' and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('01','02','03') and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('04','05','06') and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('07','08','09') and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('10','11','12') and (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  	sum(case when (dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '2' or isnull(dbo.MD_GET_CUSTTYPE_FUN(exclientcode),'') ='')  then isnull(EXSUSU,0) else 0 end) SUMAMT"
                strFormet = strFormet & "  	from md_reportincome_mst"
                strFormet = strFormet & "  	where 1=1  {0} "
                strFormet = strFormet & "  	union all"
                strFormet = strFormet & "  	select '비계열' clientname, "
                strFormet = strFormet & "  	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '01' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '02' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '03' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '04' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '05' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '06' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '07' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '08' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '09' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '10' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '11' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '12' and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('01','02','03') and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('04','05','06') and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('07','08','09') and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('10','11','12') and dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  	sum(case when dbo.MD_GET_CUSTTYPE_FUN(exclientcode) = '1' then isnull(EXSUSU,0) else 0 end) SUMAMT"
                strFormet = strFormet & "  	from md_reportincome_mst"
                strFormet = strFormet & "  	where 1=1  {0} "
                strFormet = strFormet & "  	union all"
                strFormet = strFormet & "  	select '합계' clientname, "
                strFormet = strFormet & "  	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '01' then isnull(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '02' then isnull(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '03' then isnull(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '04' then isnull(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '05' then isnull(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '06' then isnull(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '07' then isnull(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '08' then isnull(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '09' then isnull(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '10' then isnull(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '11' then isnull(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) = '12' then isnull(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('01','02','03') then isnull(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('04','05','06') then isnull(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('07','08','09') then isnull(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  	sum(case when substring(yearmon,5,2) in('10','11','12') then isnull(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  	sum(isnull(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  	from md_reportincome_mst"
                strFormet = strFormet & "  	where 1=1  {0} "
                strFormet = strFormet & "  ) AAA "
                strFormet = strFormet & "  order by clientname2"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    '*************************************************************************************************************'
    ' 실적집계 (제작매체부문별 매출액) MDCMCLIENTYEAREXSUSULISTPDGUBUN
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEAREXSUSULISTPDGUBUN(ByVal strInfoXML As String, _
                                                          ByRef intRowCnt As Integer, _
                                                          ByRef intColCnt As Integer, _
                                                          ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""

                'If strYEAR <> "" Then Con1 = String.Format(" and substring(taxyearmon,1,4) = '{0}'", strYEAR) '년월

                'strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " select"
                strFormet = strFormet & " jobgubun,"
                strFormet = strFormet & " clientname, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & " Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname, "
                strFormet = strFormet & " 	dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) clientname2, "
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	FROM"
                strFormet = strFormet & " 	("
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_EXE_DTL"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		UNION ALL"
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_ACC_MST"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 	) SUBDATA"

                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun),clientcode"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'계열' clientname, "
                strFormet = strFormet & " 	'xxxxxxxxxx' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '01' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '02' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '03' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '04' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '05' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '06' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '07' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '08' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '09' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '10' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '11' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '12' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('01','02','03') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('04','05','06') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('07','08','09') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('10','11','12') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(case when dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '2' then  isnull(amt,0)  else 0 end) SUMAMT"
                strFormet = strFormet & " 	FROM"
                strFormet = strFormet & " 	("
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_EXE_DTL"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		UNION ALL"
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_ACC_MST"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 	) SUBDATA"

                strFormet = strFormet & " 	where 1=1  "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'비계열' clientname, "
                strFormet = strFormet & " 	'yyyyyyyyyy' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '01' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '02' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '03' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '04' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '05' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '06' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '07' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '08' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '09' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '10' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '11' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '12' and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('01','02','03') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('04','05','06') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('07','08','09') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('10','11','12') and dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1'  then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum(case when  dbo.MD_GET_CUSTTYPE_FUN(clientcode) = '1' then isnull(amt,0) else 0 end) SUMAMT"
                strFormet = strFormet & " 	FROM"
                strFormet = strFormet & " 	("
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_EXE_DTL"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		UNION ALL"
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_ACC_MST"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 	) SUBDATA"

                strFormet = strFormet & " 	where 1=1  "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " 	union all"
                strFormet = strFormet & " 	select "
                strFormet = strFormet & " 	dbo.MD_GETPUBNAME_FUN(jobgubun) jobgubun,"
                strFormet = strFormet & " 	'합계' clientname, "
                strFormet = strFormet & " 	'zzzzzzzzzz' clientname2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '01' then  isnull(amt,0)  else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '02' then  isnull(amt,0)  else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '03' then  isnull(amt,0)  else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '04' then  isnull(amt,0)  else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '05' then  isnull(amt,0)  else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '06' then  isnull(amt,0)  else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '07' then  isnull(amt,0)  else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '08' then  isnull(amt,0)  else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '09' then  isnull(amt,0)  else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '10' then  isnull(amt,0)  else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '11' then  isnull(amt,0)  else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) = '12' then  isnull(amt,0)  else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('01','02','03') then  isnull(amt,0)  else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('04','05','06') then  isnull(amt,0)  else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('07','08','09') then  isnull(amt,0)  else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(ADJDAY,5,2) in('10','11','12') then  isnull(amt,0)  else 0 end) Q4,"
                strFormet = strFormet & " 	sum( isnull(amt,0) ) SUMAMT"
                strFormet = strFormet & " 	FROM"
                strFormet = strFormet & " 	("
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_EXE_DTL"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 		UNION ALL"
                strFormet = strFormet & " 		SELECT "
                strFormet = strFormet & " 		dbo.PD_JOBGUBN_FUN(jobno) jobgubun, "
                strFormet = strFormet & " 		DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & " 		FROM PD_ACC_MST"
                strFormet = strFormet & " 		WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & " 		AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & " 	) SUBDATA"
                strFormet = strFormet & " 	where 1=1  "
                strFormet = strFormet & " 	group by dbo.MD_GETPUBNAME_FUN(jobgubun)"
                strFormet = strFormet & " ) AAA "
                strFormet = strFormet & " order by jobgubun, clientname2"


                strSQL = strFormet

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_BRANDAGENCYLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 실적집계 (외주비) MDCMCLIENTYEAREXSUSULIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEAREXSUSULIST(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & " select"
                strFormet = strFormet & " MEDFLAG, AMTGBN,"
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & " Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & " FROM ("
                strFormet = strFormet & " 	select "
                strFormet = strFormet & "   	MEDFLAG,"
                strFormet = strFormet & "   	'취급액' AMTGBN,"
                strFormet = strFormet & "   	MEDFLAGNAME, 1 SORTGBN,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then ISNULL(AMT,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then ISNULL(AMT,0) else 0 end) A2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '03' then ISNULL(AMT,0) else 0 end) A3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '04' then ISNULL(AMT,0) else 0 end) A4,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '05' then ISNULL(AMT,0) else 0 end) A5,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '06' then ISNULL(AMT,0) else 0 end) A6,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '07' then ISNULL(AMT,0) else 0 end) A7,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '08' then ISNULL(AMT,0) else 0 end) A8,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '09' then ISNULL(AMT,0) else 0 end) A9,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '10' then ISNULL(AMT,0) else 0 end) A10,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '11' then ISNULL(AMT,0) else 0 end) A11,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '12' then ISNULL(AMT,0) else 0 end) A12,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & " 	sum(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & " 	from ( select yearmon, "
                strFormet = strFormet & " 		case when MEDFLAG = '01' then 'TV'"
                strFormet = strFormet & "   		WHEN MEDFLAG IN('02','03') THEN 'RADIO'"
                strFormet = strFormet & "   		WHEN MEDFLAG IN('10','20') THEN '지상파DMB'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'A2' THEN 'CATV'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'B' THEN '신문'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'C' THEN '잡지'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'O' THEN '인터넷'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'D' THEN '옥외'"
                strFormet = strFormet & "   		END AS MEDFLAG,"
                strFormet = strFormet & "   		case when MEDFLAG = '01' then 'AA'"
                strFormet = strFormet & "   		WHEN MEDFLAG IN('02','03') THEN 'BB'"
                strFormet = strFormet & "   		WHEN MEDFLAG IN('10','20') THEN 'CC'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'A2' THEN 'DD'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'B' THEN 'EE'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'C' THEN 'FF'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'O' THEN 'GG'"
                strFormet = strFormet & "   		WHEN MEDFLAG = 'D' THEN 'HH'"
                strFormet = strFormet & "   		END AS MEDFLAGNAME, AMT, COMMISSION, EXSUSU"
                strFormet = strFormet & " 		from md_reportincome_mst"
                strFormet = strFormet & " 		where 1=1 {0} "
                strFormet = strFormet & " 	)aaa"
                strFormet = strFormet & " 	where 1=1 {0} "
                strFormet = strFormet & " 	group by MEDFLAG, MEDFLAGNAME"
                strFormet = strFormet & "   	UNION ALL"
                strFormet = strFormet & "   	select "
                strFormet = strFormet & "   	MEDFLAG,"
                strFormet = strFormet & "   	'매출액' AMTGBN,"
                strFormet = strFormet & "   	MEDFLAGNAME, 2 SORTGBN,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & " 	sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "	from ( select yearmon, "
                strFormet = strFormet & "		case when MEDFLAG = '01' then 'TV'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'RADIO'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN '지상파DMB'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'CATV'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN '신문'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN '잡지'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN '인터넷'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN '옥외'"
                strFormet = strFormet & "  		END AS MEDFLAG,"
                strFormet = strFormet & "  		case when MEDFLAG = '01' then 'AA'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'BB'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN 'CC'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'DD'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN 'EE'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN 'FF'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN 'GG'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN 'HH'"
                strFormet = strFormet & "  		END AS MEDFLAGNAME, AMT, COMMISSION, EXSUSU"
                strFormet = strFormet & "		from md_reportincome_mst"
                strFormet = strFormet & "		where 1=1 {0} "
                strFormet = strFormet & "	)aaa"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "	group by MEDFLAG, MEDFLAGNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	MEDFLAG,"
                strFormet = strFormet & "  	'외주비' AMTGBN,"
                strFormet = strFormet & "  	MEDFLAGNAME, 3 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "	from ( select yearmon, "
                strFormet = strFormet & "		case when MEDFLAG = '01' then 'TV'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'RADIO'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN '지상파DMB'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'CATV'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN '신문'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN '잡지'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN '인터넷'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN '옥외'"
                strFormet = strFormet & "  		END AS MEDFLAG,"
                strFormet = strFormet & "  		case when MEDFLAG = '01' then 'AA'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'BB'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN 'CC'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'DD'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN 'EE'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN 'FF'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN 'GG'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN 'HH'"
                strFormet = strFormet & "  		END AS MEDFLAGNAME, AMT, COMMISSION, EXSUSU"
                strFormet = strFormet & "		from md_reportincome_mst"
                strFormet = strFormet & "		where 1=1 {0} "
                strFormet = strFormet & "	)aaa"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "	group by MEDFLAG, MEDFLAGNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	MEDFLAG,"
                strFormet = strFormet & "  	'매출이익' AMTGBN,"
                strFormet = strFormet & "  	MEDFLAGNAME, 4 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "	from ( select yearmon, "
                strFormet = strFormet & "		case when MEDFLAG = '01' then 'TV'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'RADIO'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN '지상파DMB'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'CATV'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN '신문'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN '잡지'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN '인터넷'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN '옥외'"
                strFormet = strFormet & "  		END AS MEDFLAG,"
                strFormet = strFormet & "  		case when MEDFLAG = '01' then 'AA'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('02','03') THEN 'BB'"
                strFormet = strFormet & "  		WHEN MEDFLAG IN('10','20') THEN 'CC'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'A2' THEN 'DD'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'B' THEN 'EE'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'C' THEN 'FF'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'O' THEN 'GG'"
                strFormet = strFormet & "  		WHEN MEDFLAG = 'D' THEN 'HH'"
                strFormet = strFormet & "  		END AS MEDFLAGNAME, AMT, COMMISSION, EXSUSU"
                strFormet = strFormet & "		from md_reportincome_mst"
                strFormet = strFormet & "		where 1=1 {0} "
                strFormet = strFormet & "	)aaa"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "	group by MEDFLAG, MEDFLAGNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	'합계' MEDFLAG,"
                strFormet = strFormet & "  	'취급액' AMTGBN,"
                strFormet = strFormet & "  	'ZZZZZZ' MEDFLAGNAME, 1 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(AMT,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(AMT,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(AMT,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(AMT,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(AMT,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(AMT,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(AMT,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(AMT,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(AMT,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(AMT,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(AMT,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(AMT,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "	from md_reportincome_mst"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	'합계' MEDFLAG,"
                strFormet = strFormet & "  	'매출액' AMTGBN,"
                strFormet = strFormet & "  	'ZZZZZZ' MEDFLAGNAME, 2 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "	from md_reportincome_mst"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	'합계' MEDFLAG,"
                strFormet = strFormet & "  	'외주비' AMTGBN,"
                strFormet = strFormet & "  	'ZZZZZZ' MEDFLAGNAME, 3 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "	from md_reportincome_mst"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select "
                strFormet = strFormet & "  	'합계' MEDFLAG,"
                strFormet = strFormet & "  	'매출이익' AMTGBN,"
                strFormet = strFormet & "  	'ZZZZZZ' MEDFLAGNAME, 4 SORTGBN,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "	sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "	sum(ISNULL(COMMISSION,0) -ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "	from md_reportincome_mst"
                strFormet = strFormet & "	where 1=1 {0} "
                strFormet = strFormet & ") AAA "
                strFormet = strFormet & "order by MEDFLAGNAME, SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEAREXSUSULIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 실적집계 (광고주별) MDCMCLIENTYEARCUSTLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARCUSTLIST(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strCOMMISSION

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                'If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR) '년월

                'strWhere = BuildFields(" ", Con1)

                strFormet = strFormet & "  select"
                strFormet = strFormet & "  clientname, AMTGBN,"
                strFormet = strFormet & "  A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,"
                strFormet = strFormet & "  Q1,Q2,Q3,Q4, SUMAMT"
                strFormet = strFormet & "  FROM ("
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname,"
                strFormet = strFormet & "  		'취급액' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname2,"
                strFormet = strFormet & "  		1 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(AMT,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(AMT,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(AMT,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(AMT,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(AMT,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(AMT,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(AMT,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(AMT,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(AMT,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(AMT,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(AMT,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(AMT,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname,"
                strFormet = strFormet & "  		'취급액' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname2,"
                strFormet = strFormet & "  		1 SORTGBN,"
                strFormet = strFormet & "  		ISNULL(B.A1,0) A1,"
                strFormet = strFormet & "  		ISNULL(B.A2,0) A2,"
                strFormet = strFormet & "  		ISNULL(B.A3,0) A3,"
                strFormet = strFormet & "  		ISNULL(B.A4,0) A4,"
                strFormet = strFormet & "  		ISNULL(B.A5,0) A5,"
                strFormet = strFormet & "  		ISNULL(B.A6,0) A6,"
                strFormet = strFormet & "  		ISNULL(B.A7,0) A7,"
                strFormet = strFormet & "  		ISNULL(B.A8,0) A8,"
                strFormet = strFormet & "  		ISNULL(B.A9,0) A9,"
                strFormet = strFormet & "  		ISNULL(B.A10,0) A10,"
                strFormet = strFormet & "  		ISNULL(B.A11,0) A11,"
                strFormet = strFormet & "  		ISNULL(B.A12,0) A12,"
                strFormet = strFormet & "  		ISNULL(B.Q1,0) Q1,"
                strFormet = strFormet & "  		ISNULL(B.Q2,0) Q2,"
                strFormet = strFormet & "  		ISNULL(B.Q3,0) Q3,"
                strFormet = strFormet & "  		ISNULL(B.Q4,0) Q4,"
                strFormet = strFormet & "  		ISNULL(B.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  		FROM ("
                strFormet = strFormet & "  			SELECT CLIENTCODE "
                strFormet = strFormet & "  			FROM ("
                strFormet = strFormet & "  				SELECT CLIENTCODE FROM PD_TAX_MST"
                strFormet = strFormet & "  				WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_EXE_DTL"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_ACC_MST"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				) ZZ"
                strFormet = strFormet & "  			GROUP BY CLIENTCODE"
                strFormet = strFormet & "  			) A LEFT JOIN "
                strFormet = strFormet & "  		("
                strFormet = strFormet & "  			SELECT "
                strFormet = strFormet & "  			CLIENTCODE,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  			FROM PD_TAX_MST"
                strFormet = strFormet & "  			where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			group by CLIENTCODE"
                strFormet = strFormet & "  		) B ON A.CLIENTCODE = B.CLIENTCODE"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname,"
                strFormet = strFormet & "  		'매출액' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname2,"
                strFormet = strFormet & "  		2 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname,"
                strFormet = strFormet & "  		'매출액' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname2,"
                strFormet = strFormet & "  		2 SORTGBN,"
                strFormet = strFormet & "  		ISNULL(B.A1,0) A1,"
                strFormet = strFormet & "  		ISNULL(B.A2,0) A2,"
                strFormet = strFormet & "  		ISNULL(B.A3,0) A3,"
                strFormet = strFormet & "  		ISNULL(B.A4,0) A4,"
                strFormet = strFormet & "  		ISNULL(B.A5,0) A5,"
                strFormet = strFormet & "  		ISNULL(B.A6,0) A6,"
                strFormet = strFormet & "  		ISNULL(B.A7,0) A7,"
                strFormet = strFormet & "  		ISNULL(B.A8,0) A8,"
                strFormet = strFormet & "  		ISNULL(B.A9,0) A9,"
                strFormet = strFormet & "  		ISNULL(B.A10,0) A10,"
                strFormet = strFormet & "  		ISNULL(B.A11,0) A11,"
                strFormet = strFormet & "  		ISNULL(B.A12,0) A12,"
                strFormet = strFormet & "  		ISNULL(B.Q1,0) Q1,"
                strFormet = strFormet & "  		ISNULL(B.Q2,0) Q2,"
                strFormet = strFormet & "  		ISNULL(B.Q3,0) Q3,"
                strFormet = strFormet & "  		ISNULL(B.Q4,0) Q4,"
                strFormet = strFormet & "  		ISNULL(B.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  		FROM ("
                strFormet = strFormet & "  			SELECT CLIENTCODE "
                strFormet = strFormet & "  			FROM ("
                strFormet = strFormet & "  				SELECT CLIENTCODE FROM PD_TAX_MST"
                strFormet = strFormet & "  				WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_EXE_DTL"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_ACC_MST"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				) ZZ"
                strFormet = strFormet & "  			GROUP BY CLIENTCODE"
                strFormet = strFormet & "  			) A LEFT JOIN "
                strFormet = strFormet & "  		("
                strFormet = strFormet & "  			SELECT "
                strFormet = strFormet & "  			CLIENTCODE,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  			FROM PD_TAX_MST"
                strFormet = strFormet & "  			where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			group by CLIENTCODE"
                strFormet = strFormet & "  		) B ON A.CLIENTCODE = B.CLIENTCODE"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname,"
                strFormet = strFormet & "  		'외주비' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname2,"
                strFormet = strFormet & "  		3 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname,"
                strFormet = strFormet & "  		'외주비' AMTGBN,"
                strFormet = strFormet & "  		dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname2,"
                strFormet = strFormet & "  		3 SORTGBN,"
                strFormet = strFormet & "  		ISNULL(B.A1,0) A1,"
                strFormet = strFormet & "  		ISNULL(B.A2,0) A2,"
                strFormet = strFormet & "  		ISNULL(B.A3,0) A3,"
                strFormet = strFormet & "  		ISNULL(B.A4,0) A4,"
                strFormet = strFormet & "  		ISNULL(B.A5,0) A5,"
                strFormet = strFormet & "  		ISNULL(B.A6,0) A6,"
                strFormet = strFormet & "  		ISNULL(B.A7,0) A7,"
                strFormet = strFormet & "  		ISNULL(B.A8,0) A8,"
                strFormet = strFormet & "  		ISNULL(B.A9,0) A9,"
                strFormet = strFormet & "  		ISNULL(B.A10,0) A10,"
                strFormet = strFormet & "  		ISNULL(B.A11,0) A11,"
                strFormet = strFormet & "  		ISNULL(B.A12,0) A12,"
                strFormet = strFormet & "  		ISNULL(B.Q1,0) Q1,"
                strFormet = strFormet & "  		ISNULL(B.Q2,0) Q2,"
                strFormet = strFormet & "  		ISNULL(B.Q3,0) Q3,"
                strFormet = strFormet & "  		ISNULL(B.Q4,0) Q4,"
                strFormet = strFormet & "  		ISNULL(B.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  		FROM ("
                strFormet = strFormet & "  			SELECT CLIENTCODE "
                strFormet = strFormet & "  			FROM ("
                strFormet = strFormet & "  				SELECT CLIENTCODE FROM PD_TAX_MST"
                strFormet = strFormet & "  				WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_EXE_DTL"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_ACC_MST"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				) ZZ"
                strFormet = strFormet & "  			GROUP BY CLIENTCODE"
                strFormet = strFormet & "  			) A LEFT JOIN "
                strFormet = strFormet & "  		("
                strFormet = strFormet & "  			SELECT"
                strFormet = strFormet & "  				CLIENTCODE,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  				sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  				sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  				FROM"
                strFormet = strFormet & "  				("
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & "  					FROM PD_EXE_DTL"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					UNION ALL"
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & "  					FROM PD_ACC_MST"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				) SUBDATA"
                strFormet = strFormet & "  				GROUP BY CLIENTCODE"
                strFormet = strFormet & "  		) B ON A.CLIENTCODE = B.CLIENTCODE"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT "
                strFormet = strFormet & "  	COMMI.CLIENTNAME, COMMI.AMTGBN, COMMI.CLIENTNAME2, COMMI.SORTGBN,"
                strFormet = strFormet & "  	ISNULL(COMMI.A1,0)-ISNULL(EX.A1,0) A1,"
                strFormet = strFormet & "  	ISNULL(COMMI.A2,0)-ISNULL(EX.A2,0) A2,"
                strFormet = strFormet & "  	ISNULL(COMMI.A3,0)-ISNULL(EX.A3,0) A3,"
                strFormet = strFormet & "  	ISNULL(COMMI.A4,0)-ISNULL(EX.A4,0) A4,"
                strFormet = strFormet & "  	ISNULL(COMMI.A5,0)-ISNULL(EX.A5,0) A5,"
                strFormet = strFormet & "  	ISNULL(COMMI.A6,0)-ISNULL(EX.A6,0) A6,"
                strFormet = strFormet & "  	ISNULL(COMMI.A7,0)-ISNULL(EX.A7,0) A7,"
                strFormet = strFormet & "  	ISNULL(COMMI.A8,0)-ISNULL(EX.A8,0) A8,"
                strFormet = strFormet & "  	ISNULL(COMMI.A9,0)-ISNULL(EX.A9,0) A9,"
                strFormet = strFormet & "  	ISNULL(COMMI.A10,0)-ISNULL(EX.A10,0) A10,"
                strFormet = strFormet & "  	ISNULL(COMMI.A11,0)-ISNULL(EX.A11,0) A11,"
                strFormet = strFormet & "  	ISNULL(COMMI.A12,0)-ISNULL(EX.A12,0) A12,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q1,0)-ISNULL(EX.Q1,0) Q1,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q2,0)-ISNULL(EX.Q2,0) Q2,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q3,0)-ISNULL(EX.Q3,0) Q3,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q4,0)-ISNULL(EX.Q4,0) Q4,"
                strFormet = strFormet & "  	ISNULL(COMMI.SUMAMT,0)-ISNULL(EX.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  	FROM ("
                strFormet = strFormet & "  		select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  		sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  		sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  		sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  		sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  		sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  		sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  		from ("
                strFormet = strFormet & "  			select "
                strFormet = strFormet & "  			dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "  			from md_reportincome_mst"
                strFormet = strFormet & "  			where 1=1 "
                strFormet = strFormet & "  			and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strFormet = strFormet & "  			union all"
                strFormet = strFormet & "  			SELECT"
                strFormet = strFormet & "  			dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			ISNULL(B.A1,0) A1,"
                strFormet = strFormet & "  			ISNULL(B.A2,0) A2,"
                strFormet = strFormet & "  			ISNULL(B.A3,0) A3,"
                strFormet = strFormet & "  			ISNULL(B.A4,0) A4,"
                strFormet = strFormet & "  			ISNULL(B.A5,0) A5,"
                strFormet = strFormet & "  			ISNULL(B.A6,0) A6,"
                strFormet = strFormet & "  			ISNULL(B.A7,0) A7,"
                strFormet = strFormet & "  			ISNULL(B.A8,0) A8,"
                strFormet = strFormet & "  			ISNULL(B.A9,0) A9,"
                strFormet = strFormet & "  			ISNULL(B.A10,0) A10,"
                strFormet = strFormet & "  			ISNULL(B.A11,0) A11,"
                strFormet = strFormet & "  			ISNULL(B.A12,0) A12,"
                strFormet = strFormet & "  			ISNULL(B.Q1,0) Q1,"
                strFormet = strFormet & "  			ISNULL(B.Q2,0) Q2,"
                strFormet = strFormet & "  			ISNULL(B.Q3,0) Q3,"
                strFormet = strFormet & "  			ISNULL(B.Q4,0) Q4,"
                strFormet = strFormet & "  			ISNULL(B.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  			FROM ("
                strFormet = strFormet & "  				SELECT CLIENTCODE "
                strFormet = strFormet & "  				FROM ("
                strFormet = strFormet & "  					SELECT CLIENTCODE FROM PD_TAX_MST"
                strFormet = strFormet & "  					WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					UNION ALL"
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_EXE_DTL"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					UNION ALL"
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_ACC_MST"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					) ZZ"
                strFormet = strFormet & "  				GROUP BY CLIENTCODE"
                strFormet = strFormet & "  				) A LEFT JOIN "
                strFormet = strFormet & "  			("
                strFormet = strFormet & "  				SELECT "
                strFormet = strFormet & "  				CLIENTCODE,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  				sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  				sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  				FROM PD_TAX_MST"
                strFormet = strFormet & "  				where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				group by CLIENTCODE"
                strFormet = strFormet & "  			) B ON A.CLIENTCODE = B.CLIENTCODE"
                strFormet = strFormet & "  		) aaa"
                strFormet = strFormet & "  		group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	) COMMI "
                strFormet = strFormet & "  	LEFT JOIN"
                strFormet = strFormet & "  	("
                strFormet = strFormet & "  		select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  		sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  		sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  		sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  		sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  		sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  		sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  		from ("
                strFormet = strFormet & "  			select "
                strFormet = strFormet & "  			dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  			from md_reportincome_mst"
                strFormet = strFormet & "  			where 1=1 "
                strFormet = strFormet & "  			and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			group by dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)"
                strFormet = strFormet & "  			union all"
                strFormet = strFormet & "  			SELECT"
                strFormet = strFormet & "  			dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			dbo.SC_GET_CUSTNAME_FUN(A.clientcode)  AS clientname2,"
                strFormet = strFormet & "  		    4 SORTGBN,"
                strFormet = strFormet & "  			ISNULL(B.A1,0) A1,"
                strFormet = strFormet & "  			ISNULL(B.A2,0) A2,"
                strFormet = strFormet & "  			ISNULL(B.A3,0) A3,"
                strFormet = strFormet & "  			ISNULL(B.A4,0) A4,"
                strFormet = strFormet & "  			ISNULL(B.A5,0) A5,"
                strFormet = strFormet & "  			ISNULL(B.A6,0) A6,"
                strFormet = strFormet & "  			ISNULL(B.A7,0) A7,"
                strFormet = strFormet & "  			ISNULL(B.A8,0) A8,"
                strFormet = strFormet & "  			ISNULL(B.A9,0) A9,"
                strFormet = strFormet & "  			ISNULL(B.A10,0) A10,"
                strFormet = strFormet & "  			ISNULL(B.A11,0) A11,"
                strFormet = strFormet & "  			ISNULL(B.A12,0) A12,"
                strFormet = strFormet & "  			ISNULL(B.Q1,0) Q1,"
                strFormet = strFormet & "  			ISNULL(B.Q2,0) Q2,"
                strFormet = strFormet & "  			ISNULL(B.Q3,0) Q3,"
                strFormet = strFormet & "  			ISNULL(B.Q4,0) Q4,"
                strFormet = strFormet & "  			ISNULL(B.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  			FROM ("
                strFormet = strFormet & "  				SELECT CLIENTCODE "
                strFormet = strFormet & "  				FROM ("
                strFormet = strFormet & "  					SELECT CLIENTCODE FROM PD_TAX_MST"
                strFormet = strFormet & "  					WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					UNION ALL"
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_EXE_DTL"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					UNION ALL"
                strFormet = strFormet & "  					SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE FROM PD_ACC_MST"
                strFormet = strFormet & "  					WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  					AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					) ZZ"
                strFormet = strFormet & "  				GROUP BY CLIENTCODE"
                strFormet = strFormet & "  				) A LEFT JOIN "
                strFormet = strFormet & "  			("
                strFormet = strFormet & "  				SELECT"
                strFormet = strFormet & "  					CLIENTCODE,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  					sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  					sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  					FROM"
                strFormet = strFormet & "  					("
                strFormet = strFormet & "  						SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & "  						FROM PD_EXE_DTL"
                strFormet = strFormet & "  						WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  						AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  						UNION ALL"
                strFormet = strFormet & "  						SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & "  						FROM PD_ACC_MST"
                strFormet = strFormet & "  						WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  						AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  					) SUBDATA"
                strFormet = strFormet & "  					GROUP BY CLIENTCODE"
                strFormet = strFormet & "  			) B ON A.CLIENTCODE = B.CLIENTCODE"
                strFormet = strFormet & "  		) aaa"
                strFormet = strFormet & "  		group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	) EX ON COMMI.CLIENTNAME = EX.CLIENTNAME"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'취급액' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		1 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(AMT,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(AMT,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(AMT,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(AMT,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(AMT,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(AMT,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(AMT,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(AMT,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(AMT,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(AMT,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(AMT,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(AMT,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(AMT,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT "
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'취급액' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		1 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  		FROM PD_TAX_MST"
                strFormet = strFormet & "  		where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'매출액' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		2 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT "
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'매출액' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		2 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(AMT,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(AMT,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(AMT,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(AMT,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(AMT,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(AMT,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(AMT,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(AMT,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(AMT,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(AMT,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(AMT,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(AMT,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(isnull(AMT,0)) SUMAMT"
                strFormet = strFormet & "  		FROM PD_TAX_MST"
                strFormet = strFormet & "  		where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  	sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  	sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  	sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  	sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  	sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  	sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  	from ("
                strFormet = strFormet & "  		select "
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'외주비' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		3 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  		from md_reportincome_mst"
                strFormet = strFormet & "  		where 1=1 "
                strFormet = strFormet & "  		and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		union all"
                strFormet = strFormet & "  		SELECT"
                strFormet = strFormet & "  		'합계'  AS clientname,"
                strFormet = strFormet & "  		'외주비' AMTGBN,"
                strFormet = strFormet & "  		'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  		3 SORTGBN,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  		sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  		sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  		FROM"
                strFormet = strFormet & "  		("
                strFormet = strFormet & "  			SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & "  			FROM PD_EXE_DTL"
                strFormet = strFormet & "  			WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  			AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			UNION ALL"
                strFormet = strFormet & "  			SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & "  			FROM PD_ACC_MST"
                strFormet = strFormet & "  			WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  			AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		) SUBDATA"
                strFormet = strFormet & "  	) aaa"
                strFormet = strFormet & "  	group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	UNION ALL"
                strFormet = strFormet & "  	SELECT "
                strFormet = strFormet & "  	COMMI.CLIENTNAME, COMMI.AMTGBN, COMMI.CLIENTNAME2, COMMI.SORTGBN,"
                strFormet = strFormet & "  	ISNULL(COMMI.A1,0)-ISNULL(EX.A1,0) A1,"
                strFormet = strFormet & "  	ISNULL(COMMI.A2,0)-ISNULL(EX.A2,0) A2,"
                strFormet = strFormet & "  	ISNULL(COMMI.A3,0)-ISNULL(EX.A3,0) A3,"
                strFormet = strFormet & "  	ISNULL(COMMI.A4,0)-ISNULL(EX.A4,0) A4,"
                strFormet = strFormet & "  	ISNULL(COMMI.A5,0)-ISNULL(EX.A5,0) A5,"
                strFormet = strFormet & "  	ISNULL(COMMI.A6,0)-ISNULL(EX.A6,0) A6,"
                strFormet = strFormet & "  	ISNULL(COMMI.A7,0)-ISNULL(EX.A7,0) A7,"
                strFormet = strFormet & "  	ISNULL(COMMI.A8,0)-ISNULL(EX.A8,0) A8,"
                strFormet = strFormet & "  	ISNULL(COMMI.A9,0)-ISNULL(EX.A9,0) A9,"
                strFormet = strFormet & "  	ISNULL(COMMI.A10,0)-ISNULL(EX.A10,0) A10,"
                strFormet = strFormet & "  	ISNULL(COMMI.A11,0)-ISNULL(EX.A11,0) A11,"
                strFormet = strFormet & "  	ISNULL(COMMI.A12,0)-ISNULL(EX.A12,0) A12,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q1,0)-ISNULL(EX.Q1,0) Q1,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q2,0)-ISNULL(EX.Q2,0) Q2,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q3,0)-ISNULL(EX.Q3,0) Q3,"
                strFormet = strFormet & "  	ISNULL(COMMI.Q4,0)-ISNULL(EX.Q4,0) Q4,"
                strFormet = strFormet & "  	ISNULL(COMMI.SUMAMT,0)-ISNULL(EX.SUMAMT,0) SUMAMT"
                strFormet = strFormet & "  	FROM ("
                strFormet = strFormet & "  		select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  		sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  		sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  		sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  		sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  		sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  		sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  		from ("
                strFormet = strFormet & "  			select "
                strFormet = strFormet & "  			'합계'  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '01' then ISNULL(COMMISSION,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '02' then ISNULL(COMMISSION,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '03' then ISNULL(COMMISSION,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '04' then ISNULL(COMMISSION,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '05' then ISNULL(COMMISSION,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '06' then ISNULL(COMMISSION,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '07' then ISNULL(COMMISSION,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '08' then ISNULL(COMMISSION,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '09' then ISNULL(COMMISSION,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '10' then ISNULL(COMMISSION,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '11' then ISNULL(COMMISSION,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '12' then ISNULL(COMMISSION,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(COMMISSION,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(COMMISSION,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(COMMISSION,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(COMMISSION,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(ISNULL(COMMISSION,0)) SUMAMT"
                strFormet = strFormet & "  			from md_reportincome_mst"
                strFormet = strFormet & "  			where 1=1 "
                strFormet = strFormet & "  			and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			union all"
                strFormet = strFormet & "  			SELECT "
                strFormet = strFormet & "  			'합계'  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '01' then isnull(AMT,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '02' then isnull(AMT,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '03' then isnull(AMT,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '04' then isnull(AMT,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '05' then isnull(AMT,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '06' then isnull(AMT,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '07' then isnull(AMT,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '08' then isnull(AMT,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '09' then isnull(AMT,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '10' then isnull(AMT,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '11' then isnull(AMT,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) = '12' then isnull(AMT,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('01','02','03') then isnull(AMT,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('04','05','06') then isnull(AMT,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('07','08','09') then isnull(AMT,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(TAXYEARMON,5,2) in('10','11','12') then isnull(AMT,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(isnull(AMT,0)) SUMAMT"
                strFormet = strFormet & "  			FROM PD_TAX_MST"
                strFormet = strFormet & "  			where 1=1 AND SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  		) aaa"
                strFormet = strFormet & "  		group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	) COMMI "
                strFormet = strFormet & "  	LEFT JOIN"
                strFormet = strFormet & "  	("
                strFormet = strFormet & "  		select clientname, AMTGBN, clientname2, SORTGBN,"
                strFormet = strFormet & "  		sum(isnull(A1,0)) A1, sum(isnull(A2,0)) A2, sum(isnull(A3,0)) A3,"
                strFormet = strFormet & "  		sum(isnull(A4,0)) A4, sum(isnull(A5,0)) A5, sum(isnull(A6,0)) A6,"
                strFormet = strFormet & "  		sum(isnull(A7,0)) A7, sum(isnull(A8,0)) A8, sum(isnull(A9,0)) A9,"
                strFormet = strFormet & "  		sum(isnull(A10,0)) A10, sum(isnull(A11,0)) A11, sum(isnull(A12,0)) A12,"
                strFormet = strFormet & "  		sum(isnull(Q1,0)) Q1, sum(isnull(Q2,0)) Q2, sum(isnull(Q3,0)) Q3, sum(isnull(Q4,0)) Q4,"
                strFormet = strFormet & "  		sum(isnull(SUMAMT,0)) SUMAMT"
                strFormet = strFormet & "  		from ("
                strFormet = strFormet & "  			select "
                strFormet = strFormet & "  			'합계'  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '01' then ISNULL(EXSUSU,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '02' then ISNULL(EXSUSU,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '03' then ISNULL(EXSUSU,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '04' then ISNULL(EXSUSU,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '05' then ISNULL(EXSUSU,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '06' then ISNULL(EXSUSU,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '07' then ISNULL(EXSUSU,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '08' then ISNULL(EXSUSU,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '09' then ISNULL(EXSUSU,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '10' then ISNULL(EXSUSU,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '11' then ISNULL(EXSUSU,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) = '12' then ISNULL(EXSUSU,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('01','02','03') then ISNULL(EXSUSU,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('04','05','06') then ISNULL(EXSUSU,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('07','08','09') then ISNULL(EXSUSU,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(yearmon,5,2) in('10','11','12') then ISNULL(EXSUSU,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(ISNULL(EXSUSU,0)) SUMAMT"
                strFormet = strFormet & "  			from md_reportincome_mst"
                strFormet = strFormet & "  			where 1=1 "
                strFormet = strFormet & "  			and substring(yearmon,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			union all"
                strFormet = strFormet & "  			SELECT"
                strFormet = strFormet & "  			'합계'  AS clientname,"
                strFormet = strFormet & "  			'매출이익' AMTGBN,"
                strFormet = strFormet & "  			'ZZZZZZ'  AS clientname2,"
                strFormet = strFormet & "  			4 SORTGBN,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '01' then isnull(amt,0) else 0 end) A1,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '02' then isnull(amt,0) else 0 end) A2,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '03' then isnull(amt,0) else 0 end) A3,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '04' then isnull(amt,0) else 0 end) A4,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '05' then isnull(amt,0) else 0 end) A5,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '06' then isnull(amt,0) else 0 end) A6,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '07' then isnull(amt,0) else 0 end) A7,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '08' then isnull(amt,0) else 0 end) A8,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '09' then isnull(amt,0) else 0 end) A9,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '10' then isnull(amt,0) else 0 end) A10,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '11' then isnull(amt,0) else 0 end) A11,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) = '12' then isnull(amt,0) else 0 end) A12,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) in('01','02','03') then isnull(amt,0) else 0 end) Q1,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) in('04','05','06') then isnull(amt,0) else 0 end) Q2,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) in('07','08','09') then isnull(amt,0) else 0 end) Q3,"
                strFormet = strFormet & "  			sum(case when substring(ADJDAY,5,2) in('10','11','12') then isnull(amt,0) else 0 end) Q4,"
                strFormet = strFormet & "  			sum(isnull(amt,0)) SUMAMT"
                strFormet = strFormet & "  			FROM"
                strFormet = strFormet & "  			("
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(ADJAMT,0) AMT, SUBSTRING(ADJDAY,1,6) ADJDAY"
                strFormet = strFormet & "  				FROM PD_EXE_DTL"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ADJDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ADJDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  				UNION ALL"
                strFormet = strFormet & "  				SELECT DBO.PD_JOBCLIENTCODE_FUN(JOBNO) CLIENTCODE,ISNULL(AMT,0) AMT, SUBSTRING(ACCDAY,1,6) ADJDAY"
                strFormet = strFormet & "  				FROM PD_ACC_MST"
                strFormet = strFormet & "  				WHERE 1=1 AND ISNULL(ACCDAY,'') <> ''"
                strFormet = strFormet & "  				AND SUBSTRING(ACCDAY,1,4) = '" & strYEAR & "'"
                strFormet = strFormet & "  			) SUBDATA"
                strFormet = strFormet & "  		) aaa"
                strFormet = strFormet & "  		group by clientname, AMTGBN, clientname2, SORTGBN"
                strFormet = strFormet & "  	) EX ON COMMI.CLIENTNAME = EX.CLIENTNAME"
                strFormet = strFormet & "  ) AAA"
                strFormet = strFormet & "  order by clientname2, SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARCUSTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 인터넷 매체별 현황 MDCMCLIENTSUBINTERNETLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTSUBINTERNETLIST(ByVal strInfoXML As String, _
                                                    ByRef intRowCnt As Integer, _
                                                    ByRef intColCnt As Integer, _
                                                    ByVal strYEARMON As String, _
                                                    ByVal strCLIENTCODE As String, _
                                                    ByVal strTIMCODE As String, _
                                                    ByVal strEXCLIENTLIST As Object, _
                                                    ByVal strEXCLIENTCNT As Integer) As Object     'XML  데이터 조회시

        Dim strSQL, strFormat, strWhere As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENTSUB
        Dim intCUSTRows
        Dim intMEDRows
        Dim mvntData
        Dim strEXCLIENTCODE

        Dim strCNT

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = '{0}')", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE) '년월
                If strTIMCODE <> "" Then Con3 = String.Format(" AND (TIMCODE = '{0}')", strTIMCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                'intCUSTRows = UBound(strEXCLIENTLIST, 1)
                intCUSTRows = UBound(strEXCLIENTLIST, 2)
                strEXCLIENTCODE = ""
                For i = 1 To intCUSTRows
                    If i = 1 Then
                        strEXCLIENTCODE = "'" & strEXCLIENTLIST(1, i) & "'"
                    Else
                        strEXCLIENTCODE = strEXCLIENTCODE & ",'" & strEXCLIENTLIST(1, i) & "'"
                    End If
                Next

                strFormat = " SELECT "
                strFormat = strFormat & " MEDNAME, "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "A" & i & ","
                Next
                strFormat = strFormat & " SUMAMT, "
                strFormat = strFormat & " real_med_name "
                strFormat = strFormat & " FROM ("
                strFormat = strFormat & "   select dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, 1 SORTGBN,"
                For i = 1 To intCUSTRows
                    If strEXCLIENTLIST(1, i) = "ZZZZZZ" Then
                        strFormat = strFormat & "   SUM(CASE WHEN YEARMON = '" & strYEARMON & "' AND ISNULL(EXCLIENTCODE,'') = '' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                    Else
                        strFormat = strFormat & "   SUM(CASE WHEN YEARMON = '" & strYEARMON & "' AND ISNULL(EXCLIENTCODE,'') = '" & strEXCLIENTLIST(1, i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                    End If
                Next
                strFormat = strFormat & "   sum(case when YEARMON = '" & strYEARMON & "'  then isnull(amt,0) else 0 end) SUMAMT,"
                strFormat = strFormat & "   DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name"
                strFormat = strFormat & "   from MD_REPORT_MST_V"
                strFormat = strFormat & "   where 1=1 AND MED_FLAG = 'O' {0} "
                'strFormat = strFormat & "   and isnull(exclientcode,'') <> ''"
                strFormat = strFormat & "   group by medcode, real_med_code"
                strFormat = strFormat & "   UNION ALL"
                strFormat = strFormat & "   select '합계' medname, 2 SORTGBN, "
                For i = 1 To intCUSTRows
                    If strEXCLIENTLIST(1, i) = "ZZZZZZ" Then
                        strFormat = strFormat & "   SUM(CASE WHEN YEARMON = '" & strYEARMON & "' AND ISNULL(EXCLIENTCODE,'') = '' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                    Else
                        strFormat = strFormat & "   SUM(CASE WHEN YEARMON = '" & strYEARMON & "' AND ISNULL(EXCLIENTCODE,'') = '" & strEXCLIENTLIST(1, i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                    End If
                Next
                strFormat = strFormat & "   sum(case when YEARMON = '" & strYEARMON & "'  then isnull(amt,0) else 0 end) SUMAMT,"
                strFormat = strFormat & "   '' real_med_name"
                strFormat = strFormat & "   from MD_REPORT_MST_V"
                strFormat = strFormat & "   where 1=1 AND MED_FLAG = 'O' {0} "
                'strFormat = strFormat & "   and isnull(exclientcode,'') <> ''"
                strFormat = strFormat & " ) AAA ORDER BY SORTGBN, MEDNAME"

                strSQL = String.Format(strFormat, strWhere)


                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTSUBINTERNETLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function GetINTERNETCAMPAIGN(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByRef strYEARMON As String, _
                                        ByRef strCLIENTCODE As String, _
                                        ByRef strTIMCODE As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim mvntData As Object
        Dim strMAXYEARMON
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT
        Dim intCol, intRows
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON ='{0}')", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE ='{0}')", strCLIENTCODE) '광고주코드
                If strTIMCODE <> "" Then Con3 = String.Format(" AND (TIMCODE ='{0}')", strTIMCODE) '사업부코드

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormat = " select subseq, dbo.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(subseq) + '(' + cast(count(*) as varchar(10)) +'건)' subseqname, count(*) cnt"
                strFormat = strFormat & " from ("
                strFormat = strFormat & " 	select subseq, campaign_code"
                strFormat = strFormat & " 	from md_internet_medium"
                strFormat = strFormat & " 	where 1=1  {0} "
                strFormat = strFormat & " 	group by subseq, campaign_code"
                strFormat = strFormat & " ) aaa"
                strFormat = strFormat & " group by subseq"

                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetINTERNETCAMPAIGN")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function GetINTERNETBRAND(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByRef strYEARMON As String, _
                                     ByRef strCLIENTCODE As String, _
                                     ByRef strTIMCODE As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim mvntData As Object
        Dim strMAXYEARMON
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT
        Dim intCol, intRows
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON ='{0}')", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE ='{0}')", strCLIENTCODE) '광고주코드
                If strTIMCODE <> "" Then Con3 = String.Format(" AND (TIMCODE ='{0}')", strTIMCODE) '사업부코드

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormat = strFormat & " select subseq, campaign_code, "
                strFormat = strFormat & " dbo.MD_GET_CAMPAIGNNAME_FUN(campaign_code) "
                strFormat = strFormat & " + case when isnull(dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE),'') ='' then ''"
                strFormat = strFormat & " else '(' + dbo.SC_GET_HIGHCUSTNAME_FUN(EXCLIENTCODE) + ')' end as campaign_name,"
                strFormat = strFormat & " tbrdstdate, tbrdeddate"
                strFormat = strFormat & " from md_internet_medium"
                strFormat = strFormat & " where 1=1  {0} "
                strFormat = strFormat & " group by  subseq, campaign_code, exclientcode, tbrdstdate, tbrdeddate"

                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetINTERNETBRAND")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 인터넷 큐시트 MDCMINTERNETQSHEETLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_INTERNETQSHEETLIST(ByVal strInfoXML As String, _
                                                 ByRef intRowCnt As Integer, _
                                                 ByRef intColCnt As Integer, _
                                                 ByVal strYEARMON As String, _
                                                 ByVal strCLIENTCODE As String, _
                                                 ByVal strTIMCODE As String, _
                                                 ByVal strBRANDLIST As Object, _
                                                 ByVal strBRANDCNT As Integer, _
                                                 ByVal strCAMPAIGNLIST As Object, _
                                                 ByVal strCAMPAIGNCNT As Integer) As Object     'XML  데이터 조회시

        Dim strSQL, strFormat, strWhere As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENTSUB
        Dim intCUSTRows
        Dim intMEDRows
        Dim mvntData
        Dim strEXCLIENTCODE

        Dim strCNT

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = '{0}')", strYEARMON) '년월
                If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE) '년월
                If strTIMCODE <> "" Then Con3 = String.Format(" AND (TIMCODE = '{0}')", strTIMCODE) '년월

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                intCUSTRows = UBound(strBRANDLIST, 2)

                strFormat = " SELECT "
                strFormat = strFormat & " MEDNAME, "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "A" & i & ","
                Next
                strFormat = strFormat & " SUMAMT, "
                strFormat = strFormat & " real_med_name "
                strFormat = strFormat & " FROM ("
                strFormat = strFormat & "   select dbo.SC_GET_CUSTNAME_FUN(MEDCODE) medname, 1 SORTGBN,"
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "   SUM(CASE WHEN SUBSEQ = '" & strBRANDLIST(0, i) & "' AND CAMPAIGN_CODE = '" & strBRANDLIST(1, i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                Next
                strFormat = strFormat & "   sum(isnull(amt,0)) SUMAMT,"
                strFormat = strFormat & "   DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name"
                strFormat = strFormat & "   from md_internet_medium"
                strFormat = strFormat & "   where 1=1 {0} "
                'strFormat = strFormat & "   and isnull(exclientcode,'') <> ''"
                strFormat = strFormat & "   group by medcode, real_med_code"
                strFormat = strFormat & "   UNION ALL"
                strFormat = strFormat & "   select '소계' medname, 2 SORTGBN, "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "   SUM(CASE WHEN SUBSEQ = '" & strBRANDLIST(0, i) & "' AND CAMPAIGN_CODE = '" & strBRANDLIST(1, i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                Next
                strFormat = strFormat & "   sum(isnull(amt,0)) SUMAMT,"
                strFormat = strFormat & "   '' real_med_name"
                strFormat = strFormat & "   from md_internet_medium"
                strFormat = strFormat & "   where 1=1 {0} "
                'strFormat = strFormat & "   and isnull(exclientcode,'') <> ''"


                strFormat = strFormat & "   	UNION ALL "
                strFormat = strFormat & "   	select '' medname, 3 SORTGBN,    "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "   NULL A" & i & ","
                Next
                strFormat = strFormat & "   	NULL SUMAMT,   '' real_med_name   "
                strFormat = strFormat & "   	UNION ALL   "


                strFormat = strFormat & "   	select '브랜드별 소계' medname, 4 SORTGBN,    "

                Dim intAddHeadCnt
                Dim cntzzz
                cntzzz = 1
                For intAddHeadCnt = 1 To strCAMPAIGNCNT
                    For i = 1 To strCAMPAIGNLIST(2, intAddHeadCnt)
                        If i = 1 Then
                            strFormat = strFormat & "   SUM(CASE WHEN SUBSEQ = '" & strBRANDLIST(0, cntzzz) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & cntzzz & ","
                        Else
                            strFormat = strFormat & "   NULL A" & cntzzz & ","
                        End If
                        cntzzz = cntzzz + 1
                    Next
                Next

                strFormat = strFormat & "   	sum(isnull(amt,0)) SUMAMT,   '' real_med_name   "
                strFormat = strFormat & "   	from md_internet_medium   "
                strFormat = strFormat & "   	where 1=1  {0}"
                strFormat = strFormat & "   	UNION ALL "
                strFormat = strFormat & "   	select '' medname, 5 SORTGBN,    "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "   NULL A" & i & ","
                Next

                strFormat = strFormat & "   	NULL SUMAMT,   '' real_med_name  "
                strFormat = strFormat & "   	UNION ALL"
                strFormat = strFormat & "   	select SUBSTRING(YEARMON,5,2) + '월 청구금액' medname, 6 SORTGBN,    "
                For i = 1 To intCUSTRows
                    strFormat = strFormat & "   SUM(CASE WHEN SUBSEQ = '" & strBRANDLIST(0, i) & "' AND CAMPAIGN_CODE = '" & strBRANDLIST(1, i) & "' THEN ISNULL(AMT,0) ELSE 0 END) A" & i & ","
                Next
                strFormat = strFormat & "   	sum(isnull(amt,0)) SUMAMT,   '' real_med_name   "
                strFormat = strFormat & "   	from md_internet_medium   "
                strFormat = strFormat & "   	where 1=1  {0}"
                strFormat = strFormat & "   	GROUP BY YEARMON"
                strFormat = strFormat & "       UNION ALL"
                strFormat = strFormat & "   	select '계' medname, 7 SORTGBN,    "
                For i = 1 To intCUSTRows
                    If i = 1 Then
                        strFormat = strFormat & "   SUM(ISNULL(AMT,0)) A" & i & ","
                    Else
                        strFormat = strFormat & "   NULL A" & i & ","
                    End If
                Next
                strFormat = strFormat & "   	sum(isnull(amt,0)) SUMAMT,   '' real_med_name   "
                strFormat = strFormat & "   	from md_internet_medium   "
                strFormat = strFormat & "   	where 1=1 {0} "

                strFormat = strFormat & " ) AAA ORDER BY SORTGBN, MEDNAME"

                strSQL = String.Format(strFormat, strWhere)


                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_INTERNETQSHEETLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_MONAMTTOTALLIST(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal strSTARTYEARMON As String, _
                                              ByVal strENDYEARMON As String, _
                                              ByVal strCLIENTCODE As String, _
                                              ByVal strGBN As String) As Object     'XML  데이터 조회시

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim objYEARMON
        Dim intCUSTRows
        Dim i
        Dim intcnt

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)

                strWhere = BuildFields(" ", Con1)


                strFormet = strFormet & " SELECT CLIENTNAME, CLIENTSUBNAME, SUBSEQNAME,"
                strFormet = strFormet & " SUM(ISNULL(TV,0)) TV,"
                strFormet = strFormet & " SUM(ISNULL(RD,0)) RD,"
                strFormet = strFormet & " SUM(ISNULL(DMB,0)) DMB,"
                strFormet = strFormet & " SUM(ISNULL(CATV,0)) CATV,"
                strFormet = strFormet & " SUM(ISNULL(MP01,0)) MP01,"
                strFormet = strFormet & " SUM(ISNULL(MP02,0)) MP02,"
                strFormet = strFormet & " SUM(ISNULL(OUTDOOR,0)) OUTDOOR,"
                strFormet = strFormet & " SUM(ISNULL(INTERNET,0)) INTERNET,"
                strFormet = strFormet & " SUM(ISNULL(TV_CF,0)) TV_CF,"
                strFormet = strFormet & " SUM(ISNULL(PROMOTION,0)) PROMOTION,"
                strFormet = strFormet & " SUM(ISNULL(OTHERS,0)) OTHERS"
                strFormet = strFormet & " FROM "
                strFormet = strFormet & " ("

                If strGBN = "AMT" Then
                    strFormet = strFormet & " SELECT "
                    strFormet = strFormet & " CLIENTCODE, CLIENTSUBCODE,SUBSEQ, "
                    strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                    strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                    strFormet = strFormet & " DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) TV,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) RD,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) DMB,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) CATV,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) MP01,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) MP02,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) OUTDOOR,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) INTERNET,"
                    strFormet = strFormet & " 0 TV_CF,"
                    strFormet = strFormet & " 0 PROMOTION,"
                    strFormet = strFormet & " 0 OTHERS"
                    strFormet = strFormet & " FROM MD_REPORT_MST_V"
                    strFormet = strFormet & " WHERE 1=1 {0} AND YEARMON >= '" & strSTARTYEARMON & "' AND YEARMON <= '" & strENDYEARMON & "'"
                    strFormet = strFormet & " GROUP BY CLIENTCODE, "
                    strFormet = strFormet & " CLIENTSUBCODE, "
                    strFormet = strFormet & " SUBSEQ"

                ElseIf strGBN = "REAL" Then
                    strFormet = strFormet & " SELECT "
                    strFormet = strFormet & " CLIENTCODE, CLIENTSUBCODE,SUBSEQ, "
                    strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                    strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                    strFormet = strFormet & " DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = '01' THEN ISNULL(COMMISSION,0) ELSE 0 END) TV,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG IN('02','03') THEN ISNULL(COMMISSION,0) ELSE 0 END) RD,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG IN('10','20') THEN ISNULL(COMMISSION,0) ELSE 0 END) DMB,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'A2' THEN ISNULL(COMMISSION,0) ELSE 0 END) CATV,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'B' THEN ISNULL(COMMISSION,0) ELSE 0 END) MP01,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'C' THEN ISNULL(COMMISSION,0) ELSE 0 END) MP02,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'D' THEN ISNULL(COMMISSION,0) ELSE 0 END) OUTDOOR,"
                    strFormet = strFormet & " SUM(CASE WHEN MEDFLAG = 'O' THEN ISNULL(COMMISSION,0) ELSE 0 END) INTERNET,"
                    strFormet = strFormet & " 0 TV_CF,"
                    strFormet = strFormet & " 0 PROMOTION,"
                    strFormet = strFormet & " 0 OTHERS"
                    strFormet = strFormet & " FROM MD_REPORTINCOME_MST"
                    strFormet = strFormet & " WHERE 1=1 {0} AND YEARMON >= '" & strSTARTYEARMON & "' AND YEARMON <= '" & strENDYEARMON & "'"
                    strFormet = strFormet & " GROUP BY CLIENTCODE, "
                    strFormet = strFormet & " CLIENTSUBCODE, "
                    strFormet = strFormet & " SUBSEQ"
                End If

                strFormet = strFormet & " UNION ALL"
                strFormet = strFormet & " SELECT "
                strFormet = strFormet & " CLIENTCODE, CLIENTSUBCODE,SUBSEQ, "
                strFormet = strFormet & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CLIENTSUBNAME,"
                strFormet = strFormet & " DBO.MD_GET_HIGHSEQNAMEBYSUBSEQ_FUN(SUBSEQ) SUBSEQNAME,"
                strFormet = strFormet & " 0 TV,"
                strFormet = strFormet & " 0 RD,"
                strFormet = strFormet & " 0 DMB,"
                strFormet = strFormet & " 0 CATV,"
                strFormet = strFormet & " 0 MP01,"
                strFormet = strFormet & " 0 MP02,"
                strFormet = strFormet & " 0 OUTDOOR,"
                strFormet = strFormet & " 0 INTERNET,"
                strFormet = strFormet & " SUM(CASE WHEN JOBGUBUN = 'PA02' THEN ISNULL(AMT,0) ELSE 0 END) TV_CF,"
                strFormet = strFormet & " SUM(CASE WHEN JOBGUBUN = 'PA05' THEN ISNULL(AMT,0) ELSE 0 END) PROMOTION,"
                strFormet = strFormet & " SUM(CASE WHEN JOBGUBUN NOT IN('PA02','PA05') THEN ISNULL(AMT,0) ELSE 0 END) OTHERS"
                strFormet = strFormet & " FROM pd_tax_mst"
                strFormet = strFormet & " WHERE 1=1 {0} AND TAXYEARMON >= '" & strSTARTYEARMON & "' AND TAXYEARMON <= '" & strENDYEARMON & "'"
                strFormet = strFormet & " GROUP BY CLIENTCODE, "
                strFormet = strFormet & " CLIENTSUBCODE, "
                strFormet = strFormet & " SUBSEQ"
                strFormet = strFormet & " ) A "
                strFormet = strFormet & " GROUP BY CLIENTNAME, CLIENTSUBNAME, SUBSEQNAME"
                strFormet = strFormet & " ORDER BY "
                strFormet = strFormet & " CLIENTNAME, CLIENTSUBNAME, SUBSEQNAME"




                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MONAMTLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 부문별 실집행 광고비 billing
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARBILLING(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = ""

                If strYEAR <> "" Then
                    Con1 = String.Format(" and substring(yearmon , 1,4)='{0}'", strYEAR)
                    Con2 = String.Format(" and substring(taxyearmon , 1,4)='{0}'", strYEAR)
                End If


                strSQL = strSQL & " select GUBUN, MEDFLAGNAME, "
                strSQL = strSQL & " a1,a2,a3,a4,a5,"
                strSQL = strSQL & " a6,a7,a8,a9,a10,"
                strSQL = strSQL & " a11,a12, sumamt"
                strSQL = strSQL & " from ("
                strSQL = strSQL & " 	select '매체' gubun, medflagname, sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when med_flag = '01' then 'TV' "
                strSQL = strSQL & " 			when med_flag = '02' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '03' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '10' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = '20' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = 'A2' then 'CATV' "
                strSQL = strSQL & " 			when med_flag = 'T' then '종합편성방송' "
                strSQL = strSQL & " 			when med_flag = 'B' then '신문' "
                strSQL = strSQL & " 			when med_flag = 'C' then '잡지' "
                strSQL = strSQL & " 			when med_flag = 'D' then '옥외' "
                strSQL = strSQL & " 			when med_flag = 'O' then '인터넷' "
                strSQL = strSQL & " 		END AS medflagname, "
                strSQL = strSQL & " 		yearmon,"
                strSQL = strSQL & " 		isnull(amt,0) amt, "
                strSQL = strSQL & " 		case when med_flag = '01' then '1a' "
                strSQL = strSQL & " 			when med_flag = '02' then '1b' "
                strSQL = strSQL & " 			when med_flag = '03' then '1b' "
                strSQL = strSQL & " 			when med_flag = '10' then '1c' "
                strSQL = strSQL & " 			when med_flag = '20' then '1c' "
                strSQL = strSQL & " 			when med_flag = 'A2' then '1d' "
                strSQL = strSQL & " 			when med_flag = 'T' then '1e' "
                strSQL = strSQL & " 			when med_flag = 'B' then '1f' "
                strSQL = strSQL & " 			when med_flag = 'C' then '1g' "
                strSQL = strSQL & " 			when med_flag = 'D' then '1h' "
                strSQL = strSQL & " 			when med_flag = 'O' then '1i' "
                strSQL = strSQL & " 		END AS sortgbn "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "')"
                strSQL = strSQL & " 		where 1=1 " & Con1
                strSQL = strSQL & " 	)a "
                strSQL = strSQL & " 	group by medflagname, sortgbn "
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'매체' gubun,"
                strSQL = strSQL & " 	'소계' medflagname, "
                strSQL = strSQL & " 	'2' sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 	where 1=1  " & Con1
                strSQL = strSQL & " 	and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	dbo.SC_GET_CODENAME_FUN(jobgubn) medflagname, "
                strSQL = strSQL & " 	case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 	when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 	when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 	when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 	when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 	END AS sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from pd_tax_dtl "
                strSQL = strSQL & " 	where 1=1  " & Con2
                strSQL = strSQL & " 	group by jobgubn "
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	'소계' medflagname, "
                strSQL = strSQL & " 	'4' sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from pd_tax_dtl "
                strSQL = strSQL & " 	where 1=1  " & Con2
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	' ' GUBUN,"
                strSQL = strSQL & " 	'합계' medflagname, "
                strSQL = strSQL & " 	'5' sortgbn, "
                strSQL = strSQL & " 	sum(isnull(A1,0)) A1, "
                strSQL = strSQL & " 	sum(isnull(A2,0)) A2, "
                strSQL = strSQL & " 	sum(isnull(A3,0)) A3, "
                strSQL = strSQL & " 	sum(isnull(A4,0)) A4, "
                strSQL = strSQL & " 	sum(isnull(A5,0)) A5, "
                strSQL = strSQL & " 	sum(isnull(A6,0)) A6, "
                strSQL = strSQL & " 	sum(isnull(A7,0)) A7, "
                strSQL = strSQL & " 	sum(isnull(A8,0)) A8, "
                strSQL = strSQL & " 	sum(isnull(A9,0)) A9, "
                strSQL = strSQL & " 	sum(isnull(A10,0)) A10, "
                strSQL = strSQL & " 	sum(isnull(A11,0)) A11, "
                strSQL = strSQL & " 	sum(isnull(A12,0)) A12, "
                strSQL = strSQL & " 	sum(isnull(SUMAMT,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		'합계' medflagname, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 		where 1=1  " & Con1
                strSQL = strSQL & " 		and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 		union all "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		'합계' medflagname, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 		from pd_tax_dtl "
                strSQL = strSQL & " 		where 1=1  " & Con2
                strSQL = strSQL & " 	)a  "
                strSQL = strSQL & " 	group by medflagname"
                strSQL = strSQL & " ) m"
                strSQL = strSQL & " order by sortgbn "



                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 부문별 실집행 광고비 billing
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARINCOME(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = ""

                If strYEAR <> "" Then
                    Con1 = String.Format(" and substring(yearmon , 1,4)='{0}'", strYEAR)
                    Con2 = String.Format(" and substring(taxyearmon , 1,4)='{0}'", strYEAR)
                End If

                strSQL = strSQL & " select GUBUN, MEDFLAGNAME, "
                strSQL = strSQL & " a1,a2,a3,a4,a5,"
                strSQL = strSQL & " a6,a7,a8,a9,a10,"
                strSQL = strSQL & " a11,a12, sumamt"
                strSQL = strSQL & " from ("
                strSQL = strSQL & " 	select '매체' gubun, medflagname, sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(commission,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(commission,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(commission,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(commission,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(commission,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(commission,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(commission,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(commission,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(commission,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(commission,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(commission,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(commission,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(commission,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when med_flag = '01' then 'TV' "
                strSQL = strSQL & " 			when med_flag = '02' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '03' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '10' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = '20' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = 'A2' then 'CATV' "
                strSQL = strSQL & " 			when med_flag = 'T' then '종합편성방송' "
                strSQL = strSQL & " 			when med_flag = 'B' then '신문' "
                strSQL = strSQL & " 			when med_flag = 'C' then '잡지' "
                strSQL = strSQL & " 			when med_flag = 'D' then '옥외' "
                strSQL = strSQL & " 			when med_flag = 'O' then '인터넷' "
                strSQL = strSQL & " 		END AS medflagname, "
                strSQL = strSQL & " 		yearmon,"
                strSQL = strSQL & " 		isnull(commission,0) commission, "
                strSQL = strSQL & " 		case when med_flag = '01' then '1a' "
                strSQL = strSQL & " 			when med_flag = '02' then '1b' "
                strSQL = strSQL & " 			when med_flag = '03' then '1b' "
                strSQL = strSQL & " 			when med_flag = '10' then '1c' "
                strSQL = strSQL & " 			when med_flag = '20' then '1c' "
                strSQL = strSQL & " 			when med_flag = 'A2' then '1d' "
                strSQL = strSQL & " 			when med_flag = 'T' then '1e' "
                strSQL = strSQL & " 			when med_flag = 'B' then '1f' "
                strSQL = strSQL & " 			when med_flag = 'C' then '1g' "
                strSQL = strSQL & " 			when med_flag = 'D' then '1h' "
                strSQL = strSQL & " 			when med_flag = 'O' then '1i' "
                strSQL = strSQL & " 		END AS sortgbn "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "')"
                strSQL = strSQL & " 		where 1=1 " & Con1
                strSQL = strSQL & " 	)a "
                strSQL = strSQL & " 	group by medflagname, sortgbn "
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'매체' gubun,"
                strSQL = strSQL & " 	'소계' medflagname, "
                strSQL = strSQL & " 	'2' sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(commission,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(commission,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(commission,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(commission,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(commission,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(commission,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(commission,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(commission,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(commission,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(commission,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(commission,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(commission,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(commission,0)) SUMAMT "
                strSQL = strSQL & " 	from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 	where 1=1  " & Con1
                strSQL = strSQL & " 	and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	dbo.SC_GET_CODENAME_FUN(jobgubn) medflagname, "
                strSQL = strSQL & " 	case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 	when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 	when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 	when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 	when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 	END AS sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from pd_tax_dtl "
                strSQL = strSQL & " 	where 1=1  " & Con2
                strSQL = strSQL & " 	group by jobgubn "
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	'소계' medflagname, "
                strSQL = strSQL & " 	'4' sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 	from pd_tax_dtl "
                strSQL = strSQL & " 	where 1=1  " & Con2
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	' ' GUBUN,"
                strSQL = strSQL & " 	'합계' medflagname, "
                strSQL = strSQL & " 	'5' sortgbn, "
                strSQL = strSQL & " 	sum(isnull(A1,0)) A1, "
                strSQL = strSQL & " 	sum(isnull(A2,0)) A2, "
                strSQL = strSQL & " 	sum(isnull(A3,0)) A3, "
                strSQL = strSQL & " 	sum(isnull(A4,0)) A4, "
                strSQL = strSQL & " 	sum(isnull(A5,0)) A5, "
                strSQL = strSQL & " 	sum(isnull(A6,0)) A6, "
                strSQL = strSQL & " 	sum(isnull(A7,0)) A7, "
                strSQL = strSQL & " 	sum(isnull(A8,0)) A8, "
                strSQL = strSQL & " 	sum(isnull(A9,0)) A9, "
                strSQL = strSQL & " 	sum(isnull(A10,0)) A10, "
                strSQL = strSQL & " 	sum(isnull(A11,0)) A11, "
                strSQL = strSQL & " 	sum(isnull(A12,0)) A12, "
                strSQL = strSQL & " 	sum(isnull(SUMAMT,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		'합계' medflagname, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(commission,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(commission,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(commission,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(commission,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(commission,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(commission,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(commission,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(commission,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(commission,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(commission,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(commission,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(commission,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(commission,0)) SUMAMT "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 		where 1=1  " & Con1
                strSQL = strSQL & " 		and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 		union all "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		'합계' medflagname, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT "
                strSQL = strSQL & " 		from pd_tax_dtl "
                strSQL = strSQL & " 		where 1=1  " & Con2
                strSQL = strSQL & " 	)a  "
                strSQL = strSQL & " 	group by medflagname"
                strSQL = strSQL & " ) m"
                strSQL = strSQL & " order by sortgbn "

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    '*************************************************************************************************************'
    ' 부문별 실집행 광고비 billing
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARINCOME_PROFIT(ByVal strInfoXML As String, _
                                                      ByRef intRowCnt As Integer, _
                                                      ByRef intColCnt As Integer, _
                                                      ByVal strYEAR As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = "" : Con3 = ""

                If strYEAR <> "" Then
                    Con1 = String.Format(" and substring(yearmon , 1,4)='{0}'", strYEAR)
                    Con2 = String.Format(" and substring(taxyearmon , 1,4)='{0}'", strYEAR)
                    Con3 = String.Format(" and substring(adjday , 1,4)='{0}'", strYEAR)
                End If

                strSQL = strSQL & " select GUBUN, MEDFLAGNAME, "
                strSQL = strSQL & " a1,a2,a3,a4,a5,"
                strSQL = strSQL & " a6,a7,a8,a9,a10,"
                strSQL = strSQL & " a11,a12, sumamt"
                strSQL = strSQL & " from ("
                strSQL = strSQL & " 	select '매체' gubun, medflagname, sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(mcsusu,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(mcsusu,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(mcsusu,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(mcsusu,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(mcsusu,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(mcsusu,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(mcsusu,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(mcsusu,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(mcsusu,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(mcsusu,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(mcsusu,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(mcsusu,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(mcsusu,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when med_flag = '01' then 'TV' "
                strSQL = strSQL & " 			when med_flag = '02' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '03' then 'RD' "
                strSQL = strSQL & " 			when med_flag = '10' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = '20' then '지상파DMB' "
                strSQL = strSQL & " 			when med_flag = 'A2' then 'CATV' "
                strSQL = strSQL & " 			when med_flag = 'T' then '종합편성방송' "
                strSQL = strSQL & " 			when med_flag = 'B' then '신문' "
                strSQL = strSQL & " 			when med_flag = 'C' then '잡지' "
                strSQL = strSQL & " 			when med_flag = 'D' then '옥외' "
                strSQL = strSQL & " 			when med_flag = 'O' then '인터넷' "
                strSQL = strSQL & " 		END AS medflagname, "
                strSQL = strSQL & " 		yearmon,"
                strSQL = strSQL & " 		isnull(mcsusu,0) mcsusu, "
                strSQL = strSQL & " 		case when med_flag = '01' then '1a' "
                strSQL = strSQL & " 			when med_flag = '02' then '1b' "
                strSQL = strSQL & " 			when med_flag = '03' then '1b' "
                strSQL = strSQL & " 			when med_flag = '10' then '1c' "
                strSQL = strSQL & " 			when med_flag = '20' then '1c' "
                strSQL = strSQL & " 			when med_flag = 'A2' then '1d' "
                strSQL = strSQL & " 			when med_flag = 'T' then '1e' "
                strSQL = strSQL & " 			when med_flag = 'B' then '1f' "
                strSQL = strSQL & " 			when med_flag = 'C' then '1g' "
                strSQL = strSQL & " 			when med_flag = 'D' then '1h' "
                strSQL = strSQL & " 			when med_flag = 'O' then '1i' "
                strSQL = strSQL & " 		END AS sortgbn "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "')"
                strSQL = strSQL & " 		where 1=1 " & Con1
                strSQL = strSQL & " 	)a "
                strSQL = strSQL & " 	group by medflagname, sortgbn "
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	'매체' gubun,"
                strSQL = strSQL & " 	'소계' medflagname, "
                strSQL = strSQL & " 	'2' sortgbn, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(mcsusu,0) else 0 end) A1, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(mcsusu,0) else 0 end) A2, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(mcsusu,0) else 0 end) A3, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(mcsusu,0) else 0 end) A4, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(mcsusu,0) else 0 end) A5, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(mcsusu,0) else 0 end) A6, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(mcsusu,0) else 0 end) A7, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(mcsusu,0) else 0 end) A8, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(mcsusu,0) else 0 end) A9, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(mcsusu,0) else 0 end) A10, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(mcsusu,0) else 0 end) A11, "
                strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(mcsusu,0) else 0 end) A12, "
                strSQL = strSQL & " 	sum(isnull(mcsusu,0)) SUMAMT "
                strSQL = strSQL & " 	from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 	where 1=1  " & Con1
                strSQL = strSQL & " 	and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 	union all "
                strSQL = strSQL & " 	select "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	dbo.SC_GET_CODENAME_FUN(a.jobgubn) medflagname,"
                strSQL = strSQL & " 	a.sortgbn,"
                strSQL = strSQL & " 	isnull(b.a1,0) - isnull(c.a1,0) a1,"
                strSQL = strSQL & " 	isnull(b.a2,0) - isnull(c.a2,0) a2,"
                strSQL = strSQL & " 	isnull(b.a3,0) - isnull(c.a3,0) a3,"
                strSQL = strSQL & " 	isnull(b.a4,0) - isnull(c.a4,0) a4,"
                strSQL = strSQL & " 	isnull(b.a5,0) - isnull(c.a5,0) a5,"
                strSQL = strSQL & " 	isnull(b.a6,0) - isnull(c.a6,0) a6,"
                strSQL = strSQL & " 	isnull(b.a7,0) - isnull(c.a7,0) a7,"
                strSQL = strSQL & " 	isnull(b.a8,0) - isnull(c.a8,0) a8,"
                strSQL = strSQL & " 	isnull(b.a9,0) - isnull(c.a9,0) a9,"
                strSQL = strSQL & " 	isnull(b.a10,0) - isnull(c.a10,0) a10,"
                strSQL = strSQL & " 	isnull(b.a11,0) - isnull(c.a11,0) a11,"
                strSQL = strSQL & " 	isnull(b.a12,0) - isnull(c.a12,0) a12,"
                strSQL = strSQL & " 	isnull(b.sumamt,0) - isnull(c.sumamt,0) sumamt"
                strSQL = strSQL & " 	from ("
                strSQL = strSQL & " 		select jobgubn, sortgbn "
                strSQL = strSQL & " 		from ("
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			jobgubn,"
                strSQL = strSQL & " 			case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 			when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 			when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 			when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 			when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_tax_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con2
                strSQL = strSQL & " 			group by jobgubn"
                strSQL = strSQL & " 			union all "
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			dbo.PD_JOBGUBN_FUN(jobno) jobgubn,"
                strSQL = strSQL & " 			case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_exe_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con3
                strSQL = strSQL & " 			group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 		) aa group by jobgubn, sortgbn"
                strSQL = strSQL & " 	) a "
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		dbo.SC_GET_CODENAME_FUN(jobgubn) medflagname, "
                strSQL = strSQL & " 		case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 		when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 		when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 		when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 		when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_tax_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con2
                strSQL = strSQL & " 		group by jobgubn "
                strSQL = strSQL & " 	) b on a.sortgbn = b.sortgbn"
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '01' then isnull(adjamt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '02' then isnull(adjamt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '03' then isnull(adjamt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '04' then isnull(adjamt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '05' then isnull(adjamt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '06' then isnull(adjamt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '07' then isnull(adjamt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '08' then isnull(adjamt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '09' then isnull(adjamt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '10' then isnull(adjamt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '11' then isnull(adjamt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '12' then isnull(adjamt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(adjamt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_exe_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con3
                strSQL = strSQL & " 		group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 	) c"
                strSQL = strSQL & " 	on a.sortgbn = c.sortgbn"
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select "
                strSQL = strSQL & " 	gubun, medflagname, sortgbn, "
                strSQL = strSQL & " 	sum(isnull(a1,0)) a1, "
                strSQL = strSQL & " 	sum(isnull(a2,0)) a2, "
                strSQL = strSQL & " 	sum(isnull(a3,0)) a3, "
                strSQL = strSQL & " 	sum(isnull(a4,0)) a4, "
                strSQL = strSQL & " 	sum(isnull(a5,0)) a5, "
                strSQL = strSQL & " 	sum(isnull(a6,0)) a6, "
                strSQL = strSQL & " 	sum(isnull(a7,0)) a7, "
                strSQL = strSQL & " 	sum(isnull(a8,0)) a8, "
                strSQL = strSQL & " 	sum(isnull(a9,0)) a9, "
                strSQL = strSQL & " 	sum(isnull(a10,0)) a10, "
                strSQL = strSQL & " 	sum(isnull(a11,0)) a11, "
                strSQL = strSQL & " 	sum(isnull(a12,0)) a12, "
                strSQL = strSQL & " 	sum(isnull(sumamt,0)) sumamt "
                strSQL = strSQL & " 	from ("
                strSQL = strSQL & " 	select "
                strSQL = strSQL & " 	'제작' GUBUN,"
                strSQL = strSQL & " 	'소계' medflagname,"
                strSQL = strSQL & " 	'4' sortgbn,"
                strSQL = strSQL & " 	isnull(b.a1,0) - isnull(c.a1,0) a1,"
                strSQL = strSQL & " 	isnull(b.a2,0) - isnull(c.a2,0) a2,"
                strSQL = strSQL & " 	isnull(b.a3,0) - isnull(c.a3,0) a3,"
                strSQL = strSQL & " 	isnull(b.a4,0) - isnull(c.a4,0) a4,"
                strSQL = strSQL & " 	isnull(b.a5,0) - isnull(c.a5,0) a5,"
                strSQL = strSQL & " 	isnull(b.a6,0) - isnull(c.a6,0) a6,"
                strSQL = strSQL & " 	isnull(b.a7,0) - isnull(c.a7,0) a7,"
                strSQL = strSQL & " 	isnull(b.a8,0) - isnull(c.a8,0) a8,"
                strSQL = strSQL & " 	isnull(b.a9,0) - isnull(c.a9,0) a9,"
                strSQL = strSQL & " 	isnull(b.a10,0) - isnull(c.a10,0) a10,"
                strSQL = strSQL & " 	isnull(b.a11,0) - isnull(c.a11,0) a11,"
                strSQL = strSQL & " 	isnull(b.a12,0) - isnull(c.a12,0) a12,"
                strSQL = strSQL & " 	isnull(b.sumamt,0) - isnull(c.sumamt,0) sumamt"
                strSQL = strSQL & " 	from ("
                strSQL = strSQL & " 		select jobgubn, sortgbn "
                strSQL = strSQL & " 		from ("
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			jobgubn,"
                strSQL = strSQL & " 			case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 			when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 			when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 			when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 			when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_tax_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con2
                strSQL = strSQL & " 			group by jobgubn"
                strSQL = strSQL & " 			union all "
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			dbo.PD_JOBGUBN_FUN(jobno) jobgubn,"
                strSQL = strSQL & " 			case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_exe_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con3
                strSQL = strSQL & " 			group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 		) aa group by jobgubn, sortgbn"
                strSQL = strSQL & " 	) a "
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		dbo.SC_GET_CODENAME_FUN(jobgubn) medflagname, "
                strSQL = strSQL & " 		case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 		when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 		when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 		when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 		when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_tax_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con2
                strSQL = strSQL & " 		group by jobgubn "
                strSQL = strSQL & " 	) b on a.sortgbn = b.sortgbn"
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '01' then isnull(adjamt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '02' then isnull(adjamt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '03' then isnull(adjamt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '04' then isnull(adjamt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '05' then isnull(adjamt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '06' then isnull(adjamt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '07' then isnull(adjamt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '08' then isnull(adjamt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '09' then isnull(adjamt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '10' then isnull(adjamt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '11' then isnull(adjamt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '12' then isnull(adjamt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(adjamt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_exe_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con3
                strSQL = strSQL & " 		group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 	) c"
                strSQL = strSQL & " 	on a.sortgbn = c.sortgbn"
                strSQL = strSQL & " 	) suma"
                strSQL = strSQL & " 	group by gubun, medflagname, sortgbn "
                strSQL = strSQL & " 	union all  "
                strSQL = strSQL & " 	select  "
                strSQL = strSQL & " 	' ' GUBUN,"
                strSQL = strSQL & " 	'합계' medflagname, "
                strSQL = strSQL & " 	'5' sortgbn, "
                strSQL = strSQL & " 	sum(isnull(A1,0)) A1, "
                strSQL = strSQL & " 	sum(isnull(A2,0)) A2, "
                strSQL = strSQL & " 	sum(isnull(A3,0)) A3, "
                strSQL = strSQL & " 	sum(isnull(A4,0)) A4, "
                strSQL = strSQL & " 	sum(isnull(A5,0)) A5, "
                strSQL = strSQL & " 	sum(isnull(A6,0)) A6, "
                strSQL = strSQL & " 	sum(isnull(A7,0)) A7, "
                strSQL = strSQL & " 	sum(isnull(A8,0)) A8, "
                strSQL = strSQL & " 	sum(isnull(A9,0)) A9, "
                strSQL = strSQL & " 	sum(isnull(A10,0)) A10, "
                strSQL = strSQL & " 	sum(isnull(A11,0)) A11, "
                strSQL = strSQL & " 	sum(isnull(A12,0)) A12, "
                strSQL = strSQL & " 	sum(isnull(SUMAMT,0)) SUMAMT "
                strSQL = strSQL & " 	from ( "
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		'합계' medflagname, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '01' then isnull(mcsusu,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '02' then isnull(mcsusu,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '03' then isnull(mcsusu,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '04' then isnull(mcsusu,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '05' then isnull(mcsusu,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '06' then isnull(mcsusu,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '07' then isnull(mcsusu,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '08' then isnull(mcsusu,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '09' then isnull(mcsusu,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '10' then isnull(mcsusu,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '11' then isnull(mcsusu,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(yearmon,5,2) = '12' then isnull(mcsusu,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(mcsusu,0)) SUMAMT "
                strSQL = strSQL & " 		from V_MD_REPORTCOMMI_MST('" & strYEAR & "') "
                strSQL = strSQL & " 		where 1=1  " & Con1
                strSQL = strSQL & " 		and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strSQL = strSQL & " 		union all "
                strSQL = strSQL & " 	select "
                strSQL = strSQL & " 	medflagname, "
                strSQL = strSQL & " 	sum(isnull(a1,0)) a1, "
                strSQL = strSQL & " 	sum(isnull(a2,0)) a2, "
                strSQL = strSQL & " 	sum(isnull(a3,0)) a3, "
                strSQL = strSQL & " 	sum(isnull(a4,0)) a4, "
                strSQL = strSQL & " 	sum(isnull(a5,0)) a5, "
                strSQL = strSQL & " 	sum(isnull(a6,0)) a6, "
                strSQL = strSQL & " 	sum(isnull(a7,0)) a7, "
                strSQL = strSQL & " 	sum(isnull(a8,0)) a8, "
                strSQL = strSQL & " 	sum(isnull(a9,0)) a9, "
                strSQL = strSQL & " 	sum(isnull(a10,0)) a10, "
                strSQL = strSQL & " 	sum(isnull(a11,0)) a11, "
                strSQL = strSQL & " 	sum(isnull(a12,0)) a12, "
                strSQL = strSQL & " 	sum(isnull(sumamt,0)) sumamt "
                strSQL = strSQL & " 	from ("
                strSQL = strSQL & " 	select "
                strSQL = strSQL & " 	'합계' medflagname,"
                strSQL = strSQL & " 	'4' sortgbn,"
                strSQL = strSQL & " 	isnull(b.a1,0) - isnull(c.a1,0) a1,"
                strSQL = strSQL & " 	isnull(b.a2,0) - isnull(c.a2,0) a2,"
                strSQL = strSQL & " 	isnull(b.a3,0) - isnull(c.a3,0) a3,"
                strSQL = strSQL & " 	isnull(b.a4,0) - isnull(c.a4,0) a4,"
                strSQL = strSQL & " 	isnull(b.a5,0) - isnull(c.a5,0) a5,"
                strSQL = strSQL & " 	isnull(b.a6,0) - isnull(c.a6,0) a6,"
                strSQL = strSQL & " 	isnull(b.a7,0) - isnull(c.a7,0) a7,"
                strSQL = strSQL & " 	isnull(b.a8,0) - isnull(c.a8,0) a8,"
                strSQL = strSQL & " 	isnull(b.a9,0) - isnull(c.a9,0) a9,"
                strSQL = strSQL & " 	isnull(b.a10,0) - isnull(c.a10,0) a10,"
                strSQL = strSQL & " 	isnull(b.a11,0) - isnull(c.a11,0) a11,"
                strSQL = strSQL & " 	isnull(b.a12,0) - isnull(c.a12,0) a12,"
                strSQL = strSQL & " 	isnull(b.sumamt,0) - isnull(c.sumamt,0) sumamt"
                strSQL = strSQL & " 	from ("
                strSQL = strSQL & " 		select jobgubn, sortgbn "
                strSQL = strSQL & " 		from ("
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			jobgubn,"
                strSQL = strSQL & " 			case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 			when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 			when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 			when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 			when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_tax_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con2
                strSQL = strSQL & " 			group by jobgubn"
                strSQL = strSQL & " 			union all "
                strSQL = strSQL & " 			select"
                strSQL = strSQL & " 			dbo.PD_JOBGUBN_FUN(jobno) jobgubn,"
                strSQL = strSQL & " 			case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 			when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 			END AS sortgbn"
                strSQL = strSQL & " 			from pd_exe_dtl"
                strSQL = strSQL & " 		    where 1=1  " & Con3
                strSQL = strSQL & " 			group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 		) aa group by jobgubn, sortgbn"
                strSQL = strSQL & " 	) a "
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		dbo.SC_GET_CODENAME_FUN(jobgubn) medflagname, "
                strSQL = strSQL & " 		case when jobgubn = 'PA01' then '3a' "
                strSQL = strSQL & " 		when jobgubn = 'PA02' then '3b' "
                strSQL = strSQL & " 		when jobgubn = 'PA05' then '3c' "
                strSQL = strSQL & " 		when jobgubn = 'PA07' then '3d' "
                strSQL = strSQL & " 		when jobgubn = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '01' then isnull(amt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '02' then isnull(amt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '03' then isnull(amt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '04' then isnull(amt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '05' then isnull(amt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '06' then isnull(amt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '07' then isnull(amt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '08' then isnull(amt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '09' then isnull(amt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '10' then isnull(amt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '11' then isnull(amt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(taxyearmon,5,2) = '12' then isnull(amt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(amt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_tax_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con2
                strSQL = strSQL & " 		group by jobgubn "
                strSQL = strSQL & " 	) b on a.sortgbn = b.sortgbn"
                strSQL = strSQL & " 	left join ("
                strSQL = strSQL & " 		select  "
                strSQL = strSQL & " 		case when dbo.PD_JOBGUBN_FUN(jobno) = 'PA01' then '3a' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA02' then '3b' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA05' then '3c' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA07' then '3d' "
                strSQL = strSQL & " 		when dbo.PD_JOBGUBN_FUN(jobno) = 'PA08' then '3e' "
                strSQL = strSQL & " 		END AS sortgbn, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '01' then isnull(adjamt,0) else 0 end) A1, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '02' then isnull(adjamt,0) else 0 end) A2, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '03' then isnull(adjamt,0) else 0 end) A3, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '04' then isnull(adjamt,0) else 0 end) A4, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '05' then isnull(adjamt,0) else 0 end) A5, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '06' then isnull(adjamt,0) else 0 end) A6, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '07' then isnull(adjamt,0) else 0 end) A7, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '08' then isnull(adjamt,0) else 0 end) A8, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '09' then isnull(adjamt,0) else 0 end) A9, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '10' then isnull(adjamt,0) else 0 end) A10, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '11' then isnull(adjamt,0) else 0 end) A11, "
                strSQL = strSQL & " 		sum(case when substring(adjday,5,2) = '12' then isnull(adjamt,0) else 0 end) A12, "
                strSQL = strSQL & " 		sum(isnull(adjamt,0)) SUMAMT"
                strSQL = strSQL & " 		from pd_exe_dtl"
                strSQL = strSQL & " 		where 1=1  " & Con3
                strSQL = strSQL & " 		group by dbo.PD_JOBGUBN_FUN(jobno)"
                strSQL = strSQL & " 	) c"
                strSQL = strSQL & " 	on a.sortgbn = c.sortgbn"
                strSQL = strSQL & " 	) suma"
                strSQL = strSQL & " 	group by medflagname "
                strSQL = strSQL & " 	)aa  "
                strSQL = strSQL & " 	group by medflagname"
                strSQL = strSQL & " ) m"
                strSQL = strSQL & " order by sortgbn "

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 부문별 실집행 광고비 billing
    '*************************************************************************************************************'
    Public Function SelectRtn_MDCMCLIENTYEARCREBILLING(ByVal strInfoXML As String, _
                                                       ByRef intRowCnt As Integer, _
                                                       ByRef intColCnt As Integer, _
                                                       ByVal strYEAR As String, _
                                                       ByVal strCLIENTCODE As String, _
                                                       ByVal strFROMMON As String, _
                                                       ByVal strTOMON As String, _
                                                       ByVal strMONCNT As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3, Con4 As String
        Dim i, j
        Dim vntData
        Dim strMON
        Dim strFMON, strTMON
        Dim striLEN

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = ""

                If strYEAR <> "" Then Con1 = String.Format(" and substring(yearmon,1,4) = '{0}'", strYEAR)
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND CLIENTCODE = '{0}'", strCLIENTCODE)
                'If strCLIENTNAME <> "" Then Con4 = String.Format(" AND DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)  LIKE '%{0}%'", strCLIENTNAME)


                Dim strFLEN
                Dim strTLEN
                strFLEN = Len(strFROMMON.ToString)
                strTLEN = Len(strTOMON.ToString)
                If strFROMMON <> "" And strTOMON <> "" Then
                    If strFLEN = 1 Then
                        strFMON = "0" & strFROMMON
                    Else
                        strFMON = strFROMMON
                    End If
                    If strTLEN = 1 Then
                        strTMON = "0" & strTOMON
                    Else
                        strTMON = strTOMON
                    End If

                    Con2 = String.Format(" AND SUBSTRING(YEARMON, 5,2) BETWEEN '{0}' AND '{1}'", strFMON, strTMON)
                End If

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = " SELECT CASE WHEN MEDFLAGNAME = 'ZZZZZZ' THEN CASE WHEN DBO.SC_GET_CUSTNAME_FUN(EXCLIENTCODE) = ''  THEN '자체분 합계' ELSE DBO.SC_GET_CUSTNAME_FUN(EXCLIENTCODE)+ ' 합계' END "
                strFormet = strFormet & " ELSE CASE WHEN DBO.SC_GET_CUSTNAME_FUN(EXCLIENTCODE) = ''  THEN '자체분' ELSE DBO.SC_GET_CUSTNAME_FUN(EXCLIENTCODE) END END AS EXCLIENTNAME, "
                strFormet = strFormet & " MEDFLAGNAME, "
                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, SUMAMT"
                strFormet = strFormet & " FROM ("

                'TV
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'TV' MEDFLAGNAME, 'AAAAAA' MEDFLAGNAME2, '01' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = '01' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "') "
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('01')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G') OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"
                strFormet = strFormet & " 	UNION ALL"

                'RD
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'Radio' MEDFLAGNAME, 'BBBBBB' MEDFLAGNAME2, '02' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('02','03') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "') "
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('02', '03')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'') "

                strFormet = strFormet & " 	UNION ALL"



                '지상파DMB
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'지상파DMB' MEDFLAGNAME, 'CCCCCC' MEDFLAGNAME2, '10' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG IN('10','20') THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('10', '20')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"

                'CATV
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'CATV' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'A2' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'A2' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "') "
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('A2')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"

                '종합편성방송
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'종합편성방송' MEDFLAGNAME, 'DDDDDD' MEDFLAGNAME2, 'T' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'T' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "') "
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('T')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"



                '신문
                strFormet = strFormet & " SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'신문' MEDFLAGNAME, 'EEEEEE' MEDFLAGNAME2, 'B' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'B' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('B')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"



                '잡지
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'잡지' MEDFLAGNAME, 'FFFFFF' MEDFLAGNAME2, 'C' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'C' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('C')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"



                '인터넷
                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'인터넷' MEDFLAGNAME, 'GGGGGG' MEDFLAGNAME2, 'O' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'O' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG IN('O')"
                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                strFormet = strFormet & " 	UNION ALL"


                '옥외
                'strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                'strFormet = strFormet & " 	'옥외' MEDFLAGNAME, 'HHHHHH' MEDFLAGNAME2, 'D' MEDFLAG, "

                'For i = 1 To 12
                '    If i = 10 Or i = 11 Or i = 12 Then
                '        strMON = i
                '    Else
                '        strMON = "0" & i
                '    End If

                '    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                '        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                '    Else
                '        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                '    End If
                'Next

                'strFormet = strFormet & " 	SUM(CASE WHEN MED_FLAG = 'D' THEN ISNULL(AMT,0) ELSE 0 END) SUMAMT, 1 SORTGBN"
                'strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                'strFormet = strFormet & " 	where 1=1 "
                'strFormet = strFormet & " 	AND MED_FLAG IN('D')"
                'strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                'strFormet = strFormet & " 	{0}  "
                'strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"

                'strFormet = strFormet & " 	UNION ALL"



                strFormet = strFormet & " 	SELECT ISNULL(EXCLIENTCODE,'') EXCLIENTCODE, "
                strFormet = strFormet & " 	'합계' MEDFLAGNAME, 'ZZZZZZ' MEDFLAGNAME2, 'Z' MEDFLAG, "

                For i = 1 To 12
                    If i = 10 Or i = 11 Or i = 12 Then
                        strMON = i
                    Else
                        strMON = "0" & i
                    End If

                    If i >= strFROMMON And i <= strFROMMON + strMONCNT Then
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '" & strMON & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    Else
                        strFormet = strFormet & " 	SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = 'XX' THEN ISNULL(AMT,0) ELSE 0 END ) A" & i & ","
                    End If
                Next

                strFormet = strFormet & " 	SUM(ISNULL(AMT,0)) SUMAMT, 1 SORTGBN"
                strFormet = strFormet & " 	from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " 	where 1=1 "
                strFormet = strFormet & " 	AND MED_FLAG <> 'D' "

                'strFormet = strFormet & " 	AND MED_FLAG IN(" & strMED & ")"

                strFormet = strFormet & " 	AND ISNULL(AMT,0) <> 0"
                strFormet = strFormet & " 	AND (SUBSTRING(EXCLIENTCODE,1,1) IN('K','G')  OR ISNULL(EXCLIENTCODE,'') ='')"
                strFormet = strFormet & " 	{0}  "
                strFormet = strFormet & " 	GROUP BY ISNULL(EXCLIENTCODE,'')"
                strFormet = strFormet & " ) AA"
                strFormet = strFormet & " ORDER BY EXCLIENTCODE, MEDFLAGNAME2"


                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MDCMCLIENTYEARCREBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 광고주별 실적집계 - 광고처별
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARHIGHCUSTNAMELIST(ByVal strInfoXML As String, _
                                                         ByRef intRowCnt As Integer, _
                                                         ByRef intColCnt As Integer, _
                                                         ByVal strYEAR As String, _
                                                         ByVal strGBN As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = strSQL & " SELECT "
                strSQL = strSQL & " CUSTNAME,"
                strSQL = strSQL & " SUM(A1) A1,SUM(A2) A2,SUM(A3) A3,SUM(A4) A4,SUM(A5) A5,"
                strSQL = strSQL & " SUM(A6) A6,SUM(A7) A7,SUM(A8) A8,SUM(A9) A9,SUM(A10) A10,"
                strSQL = strSQL & " SUM(A11) A11,SUM(A12) A12,"
                strSQL = strSQL & " SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " FROM ("
                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_GREATCUSTNAME_FUN(CLIENTCODE) CUSTNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_GREATCUSTNAME_FUN(CLIENTCODE)"
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_GREATCUSTNAME_FUN(CLIENTCODE) CUSTNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_GREATCUSTNAME_FUN(CLIENTCODE)"
                End If
                strSQL = strSQL & " 	UNION ALL"
                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                End If

                strSQL = strSQL & " )A"
                strSQL = strSQL & " GROUP BY CUSTNAME, SORTGBN"
                strSQL = strSQL & " ORDER BY SORTGBN, CUSTNAME"

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 광고주별 실적집계 - 광고주,CIC
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARCUSTCICLIST(ByVal strInfoXML As String, _
                                                     ByRef intRowCnt As Integer, _
                                                     ByRef intColCnt As Integer, _
                                                     ByVal strYEAR As String, _
                                                     ByVal strGBN As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = strSQL & " SELECT "
                strSQL = strSQL & " CUSTNAME, CICNAME,"
                strSQL = strSQL & " SUM(A1) A1,SUM(A2) A2,SUM(A3) A3,SUM(A4) A4,SUM(A5) A5,"
                strSQL = strSQL & " SUM(A6) A6,SUM(A7) A7,SUM(A8) A8,SUM(A9) A9,SUM(A10) A10,"
                strSQL = strSQL & " SUM(A11) A11,SUM(A12) A12,"
                strSQL = strSQL & " SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " FROM ("
                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE) CICNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE), DBO.SC_GET_CUSTNAME_FUN(CLIENTSUBCODE)"
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, DBO.SC_GET_CUSTNAME_FUN(DBO.SC_GET_CLIENTSUBCODEBYTIM_FUN(TIMCODE)) CICNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE), DBO.SC_GET_CUSTNAME_FUN(DBO.SC_GET_CLIENTSUBCODEBYTIM_FUN(TIMCODE))"
                End If
                strSQL = strSQL & " 	UNION ALL"
                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, '' CICNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, '' CICNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                End If

                strSQL = strSQL & " )A"
                strSQL = strSQL & " GROUP BY CUSTNAME, CICNAME, SORTGBN"
                strSQL = strSQL & " ORDER BY SORTGBN, CUSTNAME, CICNAME"

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' 광고주별 실적집계 - 광고주,팀별
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARCUSTNAMELIST(ByVal strInfoXML As String, _
                                                     ByRef intRowCnt As Integer, _
                                                     ByRef intColCnt As Integer, _
                                                     ByVal strYEAR As String, _
                                                     ByVal strGBN As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = strSQL & " SELECT "
                strSQL = strSQL & " CUSTNAME, TIMNAME,"
                strSQL = strSQL & " SUM(A1) A1,SUM(A2) A2,SUM(A3) A3,SUM(A4) A4,SUM(A5) A5,"
                strSQL = strSQL & " SUM(A6) A6,SUM(A7) A7,SUM(A8) A8,SUM(A9) A9,SUM(A10) A10,"
                strSQL = strSQL & " SUM(A11) A11,SUM(A12) A12,"
                strSQL = strSQL & " SUM(SUMAMT) SUMAMT"
                strSQL = strSQL & " FROM ("


                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE), DBO.SC_GET_CUSTNAME_FUN(TIMCODE)"
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUSTNAME, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) TIMNAME, 1 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                    strSQL = strSQL & " 	GROUP BY DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE), DBO.SC_GET_CUSTNAME_FUN(TIMCODE)"
                End If


                strSQL = strSQL & " 	UNION ALL"


                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, '' TIMNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "') "
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' CUSTNAME, '' TIMNAME, 2 SORTGBN,"
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                    strSQL = strSQL & " 	sum(case when substring(taxyearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                    strSQL = strSQL & " 	sum(isnull(AMT,0)) SUMAMT "
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                End If

                strSQL = strSQL & " )A"
                strSQL = strSQL & " GROUP BY CUSTNAME, TIMNAME, SORTGBN"
                strSQL = strSQL & " ORDER BY SORTGBN, CUSTNAME, TIMNAME"

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_CLIENTYEARCUSTNAMELIST_POP(ByVal strInfoXML As String, _
                                                         ByRef intRowCnt As Integer, _
                                                         ByRef intColCnt As Integer, _
                                                         ByVal strYEAR As String, _
                                                         ByVal strMONTH As String, _
                                                         ByVal strCUSTNAME As String, _
                                                         ByVal strTIMNAME As String, _
                                                         ByVal strGBN As String) As Object

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = strSQL & " SELECT MEDFLAGNAME, SUM(AMT) SUMAMT"
                strSQL = strSQL & " FROM ("

                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	CASE WHEN MED_FLAG = '01' THEN '매체(TV)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '02' THEN '매체(RD)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '03' THEN '매체(RD)'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = '10' THEN '매체(지상파DMB)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '20' THEN '매체(지상파DMB)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'A2' THEN '매체(CATV)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'B' THEN '매체(신문)' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'C' THEN '매체(잡지)'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'D' THEN '매체(옥외)'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'O' THEN '매체(인터넷)'"
                    strSQL = strSQL & " 	END AS MEDFLAGNAME,"
                    strSQL = strSQL & " 	CASE WHEN MED_FLAG = '01' THEN 'A1' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '02' THEN 'A2' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '03' THEN 'A3'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = '10' THEN 'A4' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = '20' THEN 'A4' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'A2' THEN 'A5' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'B' THEN 'A6' "
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'C' THEN 'A7'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'D' THEN 'A9'"
                    strSQL = strSQL & " 	WHEN MED_FLAG = 'O' THEN 'A8'"
                    strSQL = strSQL & " 	END AS SORTGBN,"
                    strSQL = strSQL & " 	ISNULL(AMT,0) AMT"
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "')"
                    strSQL = strSQL & " 	WHERE SUBSTRING(YEARMON,5,2) IN( '" & strMONTH & "')"
                    strSQL = strSQL & " 	AND DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) = '" & strCUSTNAME & "'"
                    strSQL = strSQL & " 	AND DBO.SC_GET_CUSTNAME_FUN(TIMCODE) = '" & strTIMNAME & "'"
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'제작(' + DBO.SC_GET_CODENAME_FUN(JOBGUBN) + ')' AS MEDFLAGNAME,"
                    strSQL = strSQL & " 	'B' + RIGHT(JOBGUBN,2) AS SORTGBN,"
                    strSQL = strSQL & " 	ISNULL(AMT,0) AMT"
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                    strSQL = strSQL & " 	AND SUBSTRING(TAXYEARMON,5,2) IN( '" & strMONTH & "')"
                    strSQL = strSQL & " 	AND DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) = '" & strCUSTNAME & "'"
                    strSQL = strSQL & " 	AND DBO.SC_GET_CUSTNAME_FUN(TIMCODE) = '" & strTIMNAME & "'"
                End If

                strSQL = strSQL & " 	UNION ALL"

                If strGBN = "" Or strGBN = "MD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' MEDFLAGNAME,"
                    strSQL = strSQL & " 	'ZZZ' SORTGBN,"
                    strSQL = strSQL & " 	ISNULL(AMT,0) AMT"
                    strSQL = strSQL & " 	FROM v_md_report_mst('" & strYEAR & "')"
                    strSQL = strSQL & " 	WHERE SUBSTRING(YEARMON,5,2) IN( '" & strMONTH & "')"
                    strSQL = strSQL & " 	AND DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) = '" & strCUSTNAME & "'"
                    strSQL = strSQL & " 	AND DBO.SC_GET_CUSTNAME_FUN(TIMCODE) = '" & strTIMNAME & "'"
                End If

                If strGBN = "" Then
                    strSQL = strSQL & " 	UNION ALL"
                End If

                If strGBN = "" Or strGBN = "PD" Then
                    strSQL = strSQL & " 	SELECT "
                    strSQL = strSQL & " 	'합계' MEDFLAGNAME,"
                    strSQL = strSQL & " 	'ZZZ' SORTGBN,"
                    strSQL = strSQL & " 	ISNULL(AMT,0) AMT"
                    strSQL = strSQL & " 	FROM PD_TAX_DTL"
                    strSQL = strSQL & " 	WHERE SUBSTRING(TAXYEARMON,1,4) = '" & strYEAR & "'"
                    strSQL = strSQL & " 	AND SUBSTRING(TAXYEARMON,5,2) IN( '" & strMONTH & "')"
                    strSQL = strSQL & " 	AND DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) = '" & strCUSTNAME & "'"
                    strSQL = strSQL & " 	AND DBO.SC_GET_CUSTNAME_FUN(TIMCODE) = '" & strTIMNAME & "'"
                End If

                strSQL = strSQL & " ) A GROUP BY MEDFLAGNAME, SORTGBN"
                strSQL = strSQL & " ORDER BY SORTGBN"

                'strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARBILLING")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    '*************************************************************************************************************'
    ' .txtYEAR.value, .txtCLIENTCODE.value, strSUBLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARCUSTTIMNAMELIST(ByVal strInfoXML As String, _
                                                        ByRef intRowCnt As Integer, _
                                                        ByRef intColCnt As Integer, _
                                                        ByVal strYEAR As String, _
                                                        ByVal strCLIENTCODE As String, _
                                                        ByVal strCLIENTSUBLIST As String) As Object     'XML  데이터 조회시

        Dim strSQL, strFormet, strSelFields, strWhere, strRtn As String
        Dim Con1, Con2 As String
        Dim i, j
        Dim vntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strCLIENTSUBLIST <> "" Then Con2 = String.Format(" AND (TIMCODE IN({0}))", strCLIENTSUBLIST) '팀

                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " select "
                strFormet = strFormet & " MED_FLAG MEDDIV, "
                strFormet = strFormet & " MEDNAME, "
                strFormet = strFormet & " a1,a2,a3,a4,a5,"
                strFormet = strFormet & " a6,a7,a8,a9,a10,"
                strFormet = strFormet & " a11, a12, sumamt"
                strFormet = strFormet & " from ("
                strFormet = strFormet & " select "
                strFormet = strFormet & " case when med_flag = '01' then 'TV' "
                strFormet = strFormet & " when med_flag = '02' then 'RD' "
                strFormet = strFormet & " when med_flag = '03' then 'RD' "
                strFormet = strFormet & " when med_flag = '10' then '지상파DMB' "
                strFormet = strFormet & " when med_flag = '20' then '지상파DMB' "
                strFormet = strFormet & " when med_flag = 'A2' then 'CATV' "
                strFormet = strFormet & " when med_flag = 'T' then '종합편성방송' "
                strFormet = strFormet & " when med_flag = 'B' then '신문' "
                strFormet = strFormet & " when med_flag = 'C' then '잡지' "
                strFormet = strFormet & " when med_flag = 'D' then '옥외' "
                strFormet = strFormet & " when med_flag = 'O' then '인터넷' "
                strFormet = strFormet & " END AS MED_FLAG, "
                strFormet = strFormet & " DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, 1 sortgbn, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                strFormet = strFormet & " sum(isnull(AMT,0)) SUMAMT "
                strFormet = strFormet & " from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " where 1=1 {0}"
                strFormet = strFormet & " group by case when med_flag = '01' then 'TV' "
                strFormet = strFormet & " when med_flag = '02' then 'RD' "
                strFormet = strFormet & " when med_flag = '03' then 'RD' "
                strFormet = strFormet & " when med_flag = '10' then '지상파DMB' "
                strFormet = strFormet & " when med_flag = '20' then '지상파DMB' "
                strFormet = strFormet & " when med_flag = 'A2' then 'CATV' "
                strFormet = strFormet & " when med_flag = 'T' then '종합편성방송' "
                strFormet = strFormet & " when med_flag = 'B' then '신문' "
                strFormet = strFormet & " when med_flag = 'C' then '잡지' "
                strFormet = strFormet & " when med_flag = 'D' then '옥외' "
                strFormet = strFormet & " when med_flag = 'O' then '인터넷' "
                strFormet = strFormet & " END, DBO.SC_GET_CUSTNAME_FUN(MEDCODE) "
                strFormet = strFormet & " union all"
                strFormet = strFormet & " select  "
                strFormet = strFormet & " '' MEDDIV,"
                strFormet = strFormet & " '합계' MEDNAME, "
                strFormet = strFormet & " '2' sortgbn, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '01' then isnull(AMT,0) else 0 end) A1, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '02' then isnull(AMT,0) else 0 end) A2, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '03' then isnull(AMT,0) else 0 end) A3, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '04' then isnull(AMT,0) else 0 end) A4, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '05' then isnull(AMT,0) else 0 end) A5, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '06' then isnull(AMT,0) else 0 end) A6, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '07' then isnull(AMT,0) else 0 end) A7, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '08' then isnull(AMT,0) else 0 end) A8, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '09' then isnull(AMT,0) else 0 end) A9, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '10' then isnull(AMT,0) else 0 end) A10, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '11' then isnull(AMT,0) else 0 end) A11, "
                strFormet = strFormet & " sum(case when substring(yearmon,5,2) = '12' then isnull(AMT,0) else 0 end) A12, "
                strFormet = strFormet & " sum(isnull(AMT,0)) SUMAMT "
                strFormet = strFormet & " from V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & " where 1=1 {0}"
                strFormet = strFormet & " and med_flag in('01','02','03','10','20','B','C','A2','T','D','O')"
                strFormet = strFormet & " ) m"
                strFormet = strFormet & " order by sortgbn "

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CLIENTYEARCUSTTIMNAMELIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '*************************************************************************************************************'
    ' 월별세부 매체별 광고비 MDCMMONMEDLIST
    '*************************************************************************************************************'
    Public Function SelectRtn_CLIENTYEARBRANDLIST(ByVal strInfoXML As String, _
                                                  ByRef intRowCnt As Integer, _
                                                  ByRef intColCnt As Integer, _
                                                  ByVal strYEAR As String, _
                                                  ByVal strCLIENTCODE As String, _
                                                  ByVal strMEDFLAGALL As String, _
                                                  ByVal strMEDFLAG1 As String, _
                                                  ByVal strMEDFLAG2 As String, _
                                                  ByVal strMEDFLAG3 As String, _
                                                  ByVal strMEDFLAG4 As String, _
                                                  ByVal strMEDFLAG5 As String, _
                                                  ByVal strMEDFLAG6 As String, _
                                                  ByVal strMEDFLAG7 As String, _
                                                  ByVal strMEDFLAG8 As String, _
                                                  ByVal strMEDFLAG9 As String, _
                                                  ByVal strGUBUN As String) As Object

        Dim strSQL, strFormet, strWhere, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim vntData
        Dim strMON
        Dim strFMON, strTMON
        Dim striLEN
        Dim strMEDFLAG
        Dim strGUBUNCODE

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = "" : Con2 = ""
                Con2 = " AND (MED_FLAG = 'X' "

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE) '년월

                If strMEDFLAG1 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'B' "
                End If
                If strMEDFLAG2 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'C' "
                End If
                If strMEDFLAG3 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = '01' "
                End If
                If strMEDFLAG4 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG IN('02','03') "
                End If
                If strMEDFLAG5 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG IN('10','20') "
                End If
                If strMEDFLAG6 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'A2' "
                End If
                If strMEDFLAG7 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'O' "
                End If
                If strMEDFLAG8 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'D' "
                End If
                If strMEDFLAG9 = "1" Then
                    Con2 = Con2 & " OR MED_FLAG = 'T' "
                End If

                Con2 = Con2 & " )"

                If strMEDFLAGALL = "1" Then
                    Con2 = ""
                End If

                strWhere = BuildFields(" ", Con1, Con2)

                strGUBUNCODE = Split(strGUBUN, ",")

                '급하게 처리해야 해서 급하게 쿼리 조립함....

                strFormet = " SELECT "

                If strGUBUNCODE(0) = "1" Then
                    strFormet = strFormet & " CLIENTNAME, "
                End If
                If strGUBUNCODE(1) = "1" Then
                    strFormet = strFormet & " SUBSEQNAME, "
                End If
                If strGUBUNCODE(2) = "1" Then
                    strFormet = strFormet & " MATTERNAME, "
                End If
                If strGUBUNCODE(3) = "1" Then
                    strFormet = strFormet & " MED_FLAG, "
                End If

                strFormet = strFormet & " A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12, SUMAMT "
                strFormet = strFormet & " FROM ( "
                strFormet = strFormet & "   SELECT "

                If strGUBUNCODE(0) = "1" Then
                    strFormet = strFormet & "   DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                End If
                If strGUBUNCODE(1) = "1" Then
                    strFormet = strFormet & "   CASE WHEN DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) ='' THEN '없음' ELSE  DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) END AS SUBSEQNAME,"
                End If
                If strGUBUNCODE(2) = "1" Then
                    strFormet = strFormet & "   CASE WHEN ISNULL(MATTERNAME,'') = '' THEN '없음' ELSE MATTERNAME END AS MATTERNAME,  "
                End If
                If strGUBUNCODE(3) = "1" Then
                    strFormet = strFormet & "   CASE MED_FLAG WHEN '01' THEN 'TV'"
                    strFormet = strFormet & "   WHEN '02' THEN 'RADIO'"
                    strFormet = strFormet & "   WHEN '03' THEN 'RADIO'"
                    strFormet = strFormet & "   WHEN '10' THEN '지상파DMB'"
                    strFormet = strFormet & "   WHEN '20' THEN '지상파DMB' "
                    strFormet = strFormet & "   WHEN 'B' THEN '신문'"
                    strFormet = strFormet & "   WHEN 'C' THEN '잡지'"
                    strFormet = strFormet & "   WHEN 'A2' THEN '케이블'"
                    strFormet = strFormet & "   WHEN 'T' THEN '종편'"
                    strFormet = strFormet & "   WHEN 'O' THEN '온라인'"
                    strFormet = strFormet & "   WHEN 'D' THEN '옥외'"
                    strFormet = strFormet & "   ELSE MED_FLAG END MED_FLAG,"
                End If
                strFormet = strFormet & "   1 SORTGBN,"
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12, "
                strFormet = strFormet & "   SUM(ISNULL(AMT,0)) SUMAMT "
                strFormet = strFormet & "   FROM V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & "   WHERE 1=1 "
                strFormet = strFormet & "   {0}"
                strFormet = strFormet & "   GROUP BY "
                If strGUBUNCODE(0) = "1" Then
                    strFormet = strFormet & "   CLIENTCODE "
                End If
                If strGUBUNCODE(1) = "1" Then
                    If strGUBUNCODE(0) = "1" Then
                        strFormet = strFormet & "   ,CASE WHEN DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) ='' THEN '없음' ELSE  DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) END "
                    Else
                        strFormet = strFormet & "   CASE WHEN DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) ='' THEN '없음' ELSE  DBO.SC_GET_SUBSEQNAME_FUN(SUBSEQ) END "
                    End If

                End If

                If strGUBUNCODE(2) = "1" Then
                    If strGUBUNCODE(0) = "1" Or strGUBUNCODE(1) = "1" Then
                        strFormet = strFormet & "  ,CASE WHEN ISNULL(MATTERNAME,'') = '' THEN '없음' ELSE MATTERNAME END, MED_FLAG"
                    Else
                        strFormet = strFormet & "  CASE WHEN ISNULL(MATTERNAME,'') = '' THEN '없음' ELSE MATTERNAME END, MED_FLAG"
                    End If
                End If
                If strGUBUNCODE(3) = "1" Then
                    If strGUBUNCODE(0) = "1" Or strGUBUNCODE(1) = "1" Or strGUBUNCODE(2) = "1" Then
                        strFormet = strFormet & "  , MED_FLAG"
                    Else
                        strFormet = strFormet & "  MED_FLAG"
                    End If
                End If

                strFormet = strFormet & "   UNION ALL"
                strFormet = strFormet & "   SELECT "
                If strGUBUNCODE(0) = "1" Then
                    strFormet = strFormet & "   '' CLIENTNAME,"
                End If
                If strGUBUNCODE(1) = "1" Then
                    strFormet = strFormet & "   '' SUBSEQNAME,"
                End If
                If strGUBUNCODE(2) = "1" Then
                    strFormet = strFormet & "   '' MATTERNAME, "
                End If
                If strGUBUNCODE(3) = "1" Then
                    strFormet = strFormet & "   '' MED_FLAG, "
                End If
                strFormet = strFormet & "   2 SORTGBN,"
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '01' THEN ISNULL(AMT,0) ELSE 0 END) A1, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '02' THEN ISNULL(AMT,0) ELSE 0 END) A2, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '03' THEN ISNULL(AMT,0) ELSE 0 END) A3, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '04' THEN ISNULL(AMT,0) ELSE 0 END) A4, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '05' THEN ISNULL(AMT,0) ELSE 0 END) A5, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '06' THEN ISNULL(AMT,0) ELSE 0 END) A6, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '07' THEN ISNULL(AMT,0) ELSE 0 END) A7, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '08' THEN ISNULL(AMT,0) ELSE 0 END) A8, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '09' THEN ISNULL(AMT,0) ELSE 0 END) A9, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '10' THEN ISNULL(AMT,0) ELSE 0 END) A10, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '11' THEN ISNULL(AMT,0) ELSE 0 END) A11, "
                strFormet = strFormet & "   SUM(CASE WHEN SUBSTRING(YEARMON,5,2) = '12' THEN ISNULL(AMT,0) ELSE 0 END) A12, "
                strFormet = strFormet & "   SUM(ISNULL(AMT,0)) SUMAMT "
                strFormet = strFormet & "   FROM V_MD_REPORT_MST('" & strYEAR & "')"
                strFormet = strFormet & "   WHERE 1=1 "
                strFormet = strFormet & "   {0}"
                strFormet = strFormet & " ) A ORDER BY SORTGBN"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_MONMEDLIST2")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "GROUP BLOCK : 외부에 비공개 Method"

    Private Function InsertRtn_MD_REPORT_MST(ByVal vntData As Object, _
                                             ByVal intColCnt As Integer, _
                                             ByVal intRow As Integer) As Integer


        Dim intRtn As Integer
        intRtn = mobjceMD_REPORT_MST.InsertDo( _
                                       GetElement(vntData, "YEARMON", intColCnt, intRow), _
                                       GetElement(vntData, "CLIENTCODE", intColCnt, intRow), _
                                       GetElement(vntData, "MEDCODE", intColCnt, intRow), _
                                       GetElement(vntData, "REAL_MED_CODE", intColCnt, intRow), _
                                       GetElement(vntData, "CLIENTSUBCODE", intColCnt, intRow), _
                                       GetElement(vntData, "SUBSEQ", intColCnt, intRow), _
                                       GetElement(vntData, "MEDFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "VOCH_GBN", intColCnt, intRow), _
                                       GetElement(vntData, "TRU_TAX_FLAG", intColCnt, intRow), _
                                       GetElement(vntData, "AMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "VAT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "EXCLIENTCODE", intColCnt, intRow), _
                                       GetElement(vntData, "PROGNAME", intColCnt, intRow), _
                                       GetElement(vntData, "MPP", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR01", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR02", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR03", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR04", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR05", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR06", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR07", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR08", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR09", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR10", intColCnt, intRow, NULL_NUM, True))
        Return intRtn
    End Function

    Private Function InsertRtn_MD_REPORTINCOME_MST(ByVal vntData As Object, _
                                                   ByVal intColCnt As Integer, _
                                                   ByVal intRow As Integer) As Integer


        Dim intRtn As Integer
        intRtn = mobjceMD_REPORTINCOME_MST.InsertDo( _
                                       GetElement(vntData, "YEARMON", intColCnt, intRow), _
                                       GetElement(vntData, "CLIENTCODE", intColCnt, intRow), _
                                       GetElement(vntData, "REAL_MED_CODE", intColCnt, intRow), _
                                       GetElement(vntData, "MEDFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "VOCH_GBN", intColCnt, intRow), _
                                       GetElement(vntData, "COMMI_TAX_FLAG", intColCnt, intRow), _
                                       GetElement(vntData, "AMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "COMMISSION", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "VAT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "EXCLIENTCODE", intColCnt, intRow), _
                                       GetElement(vntData, "EXSUSU", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "MCSUSU", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "CLIENTSUBCODE", intColCnt, intRow), _
                                       GetElement(vntData, "SUBSEQ", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR01", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR02", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR03", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR04", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR05", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR06", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR07", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR08", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR09", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR10", intColCnt, intRow, NULL_NUM, True))
        Return intRtn
    End Function


#End Region
End Class
