'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커 - 한화 S&C
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccMDCMEXECUTE.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2004-03-30 오전 10:32:13 By MakeSFARV.2.0.0
'            2) 2004-03-30 오전 10:32:13 By 작성자명을 씁니다.
'****************************************************************************************

Imports System.Xml                        ' XML처리 
Imports SCGLControl                       ' ControlClass의 Base Class 
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr            '오류처리 클래스 
Imports SCGLUtil.cbSCGLXml           'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil            '기타유틸리티 클래스

' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트

Public Class ccMDSCPRINTMULTILIST
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccMDSCPRINTMULTILIST"                  '자신의 클래스명
    'Private Const .DBConnStr = "Provider=SQLOLEDB;Data Source=10.110.10.86;Initial Catalog=MCDEV;DSN=MCDEV;UID=devadmin;Pwd=password"  '커넥션Setting
#End Region

#Region "GROUP BLOCK : Property 선언"
#End Region

#Region "GROUP BLOCK : Event 선언"
#End Region

#Region "GROUP BLOCK : 외부에 공개 Method"

    Public Function GetCUSTCNT(ByVal strInfoXML As String, _
                               ByRef intRowCnt As Integer, _
                               ByRef intColCnt As Integer, _
                               ByRef strYEAR As String, _
                               ByRef strCLIENTLIST As String, _
                               ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME, CLIENTCODE From MD_BOOKING_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND SUBSTRING(YEARMON,1,4) =  '" & strYEAR & "'" & Con2 & Con1
                strSQL = strSQL & "   GROUP BY CLIENTCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCUSTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_MEDAndCUST(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal mintCnt2 As Object, _
                                         ByVal mvntDataCust As Object, _
                                         ByVal mvntDataCustCNT As Object, _
                                         ByVal strYEAR As String, _
                                         ByVal strCLIENTLIST As String, _
                                         ByVal strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intMEDRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intMEDRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intMEDRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = ""
                strSQL = strSQL & " SELECT"
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMOUNT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMOUNT) SUMAMT"
                strSQL = strSQL & " from md_booking_medium"
                strSQL = strSQL & " where substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY MEDCODE, CLIENTCODE "

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT"
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) YEAR, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMOUNT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMOUNT) SUMAMT"
                strSQL = strSQL & " from md_booking_medium"
                strSQL = strSQL & " where  substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY MEDCODE, substring(yearmon , 1,4)"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "1. 광고주별 매체사별  팝업"
    Public Function GetCUSTEXELIST(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strYEAR As String, _
                                   ByVal strCUSTNAME As String, _
                                   ByVal strFLAG As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""

                If strFLAG = "ELEC" Then
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(TRANSYEARMON,1,4) = '{0}')", strYEAR)
                Else
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(DEMANDDAY,1,4) = '{0}')", strYEAR)
                End If

                If strCUSTNAME <> "" Then Con2 = String.Format(" AND (DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) LIKE '%{0}%')", strCUSTNAME)
                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT"
                strFormet = strFormet & "  0 CHK,"
                strFormet = strFormet & "  REAL_MED_CODE CUSTNO,"
                strFormet = strFormet & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUSTNAME"

                If strFLAG = "PRINT" Then
                    strFormet = strFormet & "  FROM MD_BOOKING_MEDIUM"
                    strFormet = strFormet & "  WHERE GFLAG IN('J','S') {0}"
                ElseIf strFLAG = "INTERNET" Then
                    strFormet = strFormet & "  FROM MD_INTERNET_MEDIUM"
                    strFormet = strFormet & "  WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "CATV" Then
                    strFormet = strFormet & "  FROM MD_CATV_MEDIUM"
                    strFormet = strFormet & "  WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "ELEC" Then
                    strFormet = strFormet & "  FROM MD_ELEC_TRANS_DTL"
                    strFormet = strFormet & "  WHERE 1=1 {0}"
                ElseIf strFLAG = "OUTDOOR" Then
                    strFormet = strFormet & "  FROM MD_OUTDOOR_MEDIUM"
                    strFormet = strFormet & "  WHERE 1=1 {0}"
                End If

                strFormet = strFormet & "  GROUP BY REAL_MED_CODE"
                strFormet = strFormet & "  ORDER BY "
                strFormet = strFormet & "  CASE SUBSTRING(LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)),1,3) "
                strFormet = strFormet & "  WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)))) "
                strFormet = strFormet & "  WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                strFormet = strFormet & "  WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                strFormet = strFormet & "  WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                strFormet = strFormet & "  WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),5,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                strFormet = strFormet & "  WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                strFormet = strFormet & "  ELSE LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)) END"

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCUSTEXELIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    ' =============== SelectRtnSample Code
    Public Function GetCUSTDBLLIST(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strYEAR As String, _
                                   ByVal strCUSTNAME As String, _
                                   ByVal strFLAG As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""

                If strFLAG = "ELEC" Then
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(TRANSYEARMON,1,4) = '{0}')", strYEAR)
                Else
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(YEARMON,1,4) = '{0}')", strYEAR)
                End If

                If strCUSTNAME <> "" Then Con2 = String.Format(" AND (dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) LIKE '%{0}%')", strCUSTNAME)
                strWhere = BuildFields(" ", Con1, Con2)

                strFormet = " SELECT "
                strFormet = strFormet & " 0 CHK,"
                strFormet = strFormet & " CLIENTCODE,"
                strFormet = strFormet & " dbo.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME"

                If strFLAG = "PRINT" Then
                    strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                    strFormet = strFormet & " WHERE GFLAG IN('J','S') {0}"
                ElseIf strFLAG = "INTERNET" Then
                    strFormet = strFormet & " FROM MD_INTERNET_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "CATV" Then
                    strFormet = strFormet & " FROM MD_CATV_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "TOTAL" Then
                    strFormet = strFormet & " FROM MD_TOTAL_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "ELEC" Then
                    strFormet = strFormet & " FROM MD_ELEC_TRANS_DTL"
                    strFormet = strFormet & " WHERE 1=1 {0}"
                ElseIf strFLAG = "OUTDOOR" Then
                    strFormet = strFormet & " FROM MD_OUTDOOR_MEDIUM"
                    strFormet = strFormet & " WHERE 1=1 {0}"
                End If

                strFormet = strFormet & " GROUP BY CLIENTCODE"
                strFormet = strFormet & " ORDER BY "
                strFormet = strFormet & " CASE SUBSTRING(LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)),1,3) "
                strFormet = strFormet & " WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)))) "
                strFormet = strFormet & " WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & " WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & " WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & " WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),5,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & " WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE))))"
                strFormet = strFormet & " ELSE LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE)) END"



                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCUSTDBLLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    ' =============== SelectRtnSample Code
    Public Function GetMED_DBLLIST(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strYEAR As String, _
                                   ByVal strMEDNAME As String, _
                                   ByVal strFLAG As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2 As String
        Dim vntData As Object

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""

                If strFLAG = "ELEC" Then
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(TRANSYEARMON,1,4) = '{0}')", strYEAR)
                Else
                    If strYEAR <> "" Then Con1 = String.Format(" AND (SUBSTRING(YEARMON,1,4) = '{0}')", strYEAR)
                End If

                If strMEDNAME <> "" Then Con2 = String.Format(" AND (dbo.SC_GET_CUSTNAME_FUN(MEDCODE) LIKE '%{0}%')", strMEDNAME)
                strWhere = BuildFields(" ", Con1, Con2)

                If strFLAG = "OUTDOOR" Then
                    strFormet = " SELECT "
                    strFormet = strFormet & "  0 CHK,"
                    strFormet = strFormet & "  REAL_MED_CODE MEDCODE,"
                    strFormet = strFormet & "  dbo.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) MEDNAME"
                Else
                    strFormet = " SELECT "
                    strFormet = strFormet & "  0 CHK,"
                    strFormet = strFormet & "  MEDCODE,"
                    strFormet = strFormet & "  dbo.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME"
                End If


                If strFLAG = "PRINT" Then
                    strFormet = strFormet & "  FROM MD_BOOKING_MEDIUM"
                    strFormet = strFormet & "  WHERE GFLAG IN('J','S') {0}"
                ElseIf strFLAG = "INTERNET" Then
                    strFormet = strFormet & " FROM MD_INTERNET_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "CATV" Then
                    strFormet = strFormet & " FROM MD_CATV_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "TOTAL" Then
                    strFormet = strFormet & " FROM MD_TOTAL_MEDIUM"
                    strFormet = strFormet & " WHERE ISNULL(TRU_TRANS_NO,'') <> '' {0}"
                ElseIf strFLAG = "ELEC" Then
                    strFormet = strFormet & " FROM MD_ELEC_TRANS_DTL"
                    strFormet = strFormet & " WHERE 1=1 {0}"
                ElseIf strFLAG = "OUTDOOR" Then
                    strFormet = strFormet & " FROM MD_OUTDOOR_MEDIUM"
                    strFormet = strFormet & " WHERE 1=1 {0}"
                End If

                If strFLAG = "OUTDOOR" Then
                    strFormet = strFormet & "  GROUP BY REAL_MED_CODE"
                    strFormet = strFormet & "  ORDER BY "
                    strFormet = strFormet & "  CASE SUBSTRING(LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)),1,3) "
                    strFormet = strFormet & "  WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)))) "
                    strFormet = strFormet & "  WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                    strFormet = strFormet & "  WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                    strFormet = strFormet & "  WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                    strFormet = strFormet & "  WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),5,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                    strFormet = strFormet & "  WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE),4,LEN(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE))))"
                    strFormet = strFormet & "  ELSE LTRIM(DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE)) END"

                Else
                    strFormet = strFormet & "  GROUP BY MEDCODE"
                    strFormet = strFormet & "  ORDER BY "
                    strFormet = strFormet & "  CASE SUBSTRING(LTRIM(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)),1,3) "
                    strFormet = strFormet & "  WHEN '(주)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)))) "
                    strFormet = strFormet & "  WHEN '(사)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                    strFormet = strFormet & "  WHEN '(유)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                    strFormet = strFormet & "  WHEN '(재)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                    strFormet = strFormet & "  WHEN '(사단' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),5,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                    strFormet = strFormet & "  WHEN '(학)' THEN LTRIM(SUBSTRING(DBO.SC_GET_CUSTNAME_FUN(MEDCODE),4,LEN(DBO.SC_GET_CUSTNAME_FUN(MEDCODE))))"
                    strFormet = strFormet & "  ELSE LTRIM(DBO.SC_GET_CUSTNAME_FUN(MEDCODE)) END"


                End If

                strSQL = String.Format(strFormet, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetMED_DBLLIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "2. 공중파 광고주별 매체사별"

    ' ===============공중파 집행 조회 ==================================
    Public Function GetELECCLIENTCNT(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByRef strYEAR As String, _
                                     ByRef strCLIENTLIST As String, _
                                     ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 FROM MD_ELECTRIC_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetELECCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetELECMEDCNT(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByRef strYEAR As String, _
                                  ByRef strCLIENTLIST As String, _
                                  ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '광고주코드
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '매체코드

                strSQL = " SELECT DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE From MD_CATV_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "   GROUP BY MEDCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetELECMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_ELECCUSTAndMED(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByVal mintCnt2 As Object, _
                                             ByVal mvntDataCust As Object, _
                                             ByVal mvntDataCustCNT As Integer, _
                                             ByVal strYEAR As String, _
                                             ByVal strCLIENTLIST As String, _
                                             ByVal strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(TRANSYEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_elec_trans_dtl"
                strSQL = strSQL & " where 1=1 and substring(TRANSYEARMON , 1,4)='" & strYEAR & "'" & Con1 & Con2 '& Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, MEDCODE"

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(TRANSYEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from MD_ELEC_TRANS_DTL"
                strSQL = strSQL & " where 1=1 and substring(TRANSYEARMON , 1,4)='" & strYEAR & "'" & Con1 & Con2 '& Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, substring(TRANSYEARMON , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY YEAR, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_ELECCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


#End Region

#Region "2. 공중파 연간매체사별"

    Public Function GetELECREAL_MED_CNT(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByRef strYEAR As String, _
                                        ByRef strREAL_MEDLIST As String) As Object


        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strREAL_MED_CODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_ELECTRIC_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO,'') <> ''  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetELECREAL_MED_CNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function



    Public Function SelectRtn_ELECClientGroup(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal mvntDataCust As Object, _
                                              ByVal mvntDataCustCNT As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strREAL_MEDLIST As String) As Object     'XML  데이터 조회시 mvntDataCust

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strREAL_MED_CODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = "SELECT REAL_MED_NAME, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(TRANSYEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_elec_trans_dtl"
                strSQL = strSQL & " where substring(TRANSYEARMON , 1,4)='" & strYEAR & "' " & Con1
                strSQL = strSQL & " GROUP BY REAL_MED_CODE"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  '계' REAL_MED_NAME, "
                strSQL = strSQL & "  'zzzzzzz' REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(TRANSYEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_elec_trans_dtl"
                strSQL = strSQL & " where  substring(TRANSYEARMON , 1,4)='" & strYEAR & "'" & Con1
                strSQL = strSQL & " GROUP BY substring(TRANSYEARMON , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY REAL_MED_NAME2, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "3. 인쇄 광고주별 매체사별"
    Public Function GetPRINTCLIENTCNT(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByRef strYEAR As String, _
                                      ByRef strCLIENTLIST As String, _
                                      ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_BOOKING_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND GFLAG IN ('J','S') AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetPRINTMEDCNT(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByRef strYEAR As String, _
                                   ByRef strCLIENTLIST As String, _
                                   ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '광고주코드
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '매체코드

                strSQL = " SELECT DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE From MD_BOOKING_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND GFLAG IN ('J','S') AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "   GROUP BY MEDCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_PRINTCUSTAndMED(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal mintCnt2 As Object, _
                                              ByVal mvntDataCust As Object, _
                                              ByVal mvntDataCustCNT As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strCLIENTLIST As String, _
                                              ByVal strMEDLIST As String, _
                                              ByVal strMED_FLAG As String, _
                                              ByVal strVOCH_TYPE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3, Con4 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE)
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE)
                If strMED_FLAG <> "" Then Con3 = String.Format(" AND (MED_FLAG = '{0}')", strMED_FLAG)
                If strVOCH_TYPE <> "" Then Con4 = String.Format(" AND (VOCH_TYPE = '{0}')", strVOCH_TYPE)

                strSQL = "SELECT YEAR,YEAR1,CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN (TIMCODE) YEAR1, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_BOOKING_MEDIUM"
                strSQL = strSQL & " where 1=1 AND GFLAG IN ('J','S') AND SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3 & Con4
                strSQL = strSQL & " GROUP BY CLIENTCODE, MEDCODE, TIMCODE"

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN (TIMCODE) YEAR1, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_BOOKING_MEDIUM"
                strSQL = strSQL & " where 1=1 AND GFLAG IN ('J','S') AND SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3 & Con4
                strSQL = strSQL & " GROUP BY  CLIENTCODE, substring(DEMANDDAY , 1,4), TIMCODE"


                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 3 SORTGBN,"
                strSQL = strSQL & "  '총계' YEAR, "
                strSQL = strSQL & "  'ZZZZ' YEAR1, "
                strSQL = strSQL & "  '' CUST, "

                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_BOOKING_MEDIUM"
                strSQL = strSQL & " where 1=1 AND GFLAG IN ('J','S') AND SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3 & Con4


                strSQL = strSQL & " ) REAL ORDER BY YEAR1, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "3. 인쇄 연간매체사별"
    Public Function GetPRINTREAL_MED_CNT(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByRef strYEAR As String, _
                                         ByRef strREAL_MEDLIST As String) As Object


        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strREAL_MED_CODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_BOOKING_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND GFLAG IN ('J','S')  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTREAL_MED_CNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_PRINTClientGroup(ByVal strInfoXML As String, _
                                               ByRef intRowCnt As Integer, _
                                               ByRef intColCnt As Integer, _
                                               ByVal mvntDataCust As Object, _
                                               ByVal mvntDataCustCNT As Integer, _
                                               ByVal strYEAR As String, _
                                               ByVal strREAL_MEDLIST As String) As Object     'XML  데이터 조회시 mvntDataCust

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strREAL_MED_CODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = "SELECT REAL_MED_NAME, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from md_booking_medium"
                strSQL = strSQL & " WHERE SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' AND GFLAG IN('J','S')" & Con1
                strSQL = strSQL & " GROUP BY REAL_MED_CODE"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  '계' REAL_MED_NAME, "
                strSQL = strSQL & "  'zzzzzzz' REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from md_booking_medium"
                strSQL = strSQL & " WHERE  SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' and GFLAG IN('J','S')" & Con1
                strSQL = strSQL & " GROUP BY SUBSTRING(DEMANDDAY , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY REAL_MED_NAME2, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTClientGroup")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "3. 인쇄 광고주별 팀별"

    Public Function GetPRINTCLIENTTIMCNT(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByRef strYEAR As String, _
                                         ByRef strCLIENTCODE As String, _
                                         ByRef strSUBLIST As String, _
                                         ByRef strMED_FLAG As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)


                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월
                If strSUBLIST <> "" Then Con2 = String.Format(" AND (TIMCODE IN({0}))", strSUBLIST) '년월
                If strMED_FLAG <> "" Then Con3 = String.Format(" AND (MED_FLAG = '{0}')", strMED_FLAG) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_BOOKING_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND (ISNULL(TRU_TAX_NO,'') <> '' OR ISNULL(COMMI_TAX_NO,'') <> '')  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetPRINTCLIENTTIMCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function GetCLIENTSUBLIST_PRINT(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByVal strCLIENTCODE As String, _
                                           ByVal strYEAR As String, _
                                           ByVal strMED_FLAG As String) As Object

        Dim strSQL As String
        Dim strFormet, strSelFields, strWhere As String
        Dim strChkDate As String = ""
        Dim Con1, Con2, Con3 As String
        Dim vntData As Object
        Dim strHIGH As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                Con1 = ""
                Con2 = ""
                Con3 = ""

                .mobjSCGLSql.SQLConnect(.DBConnStr)

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = '{0}')", strCLIENTCODE)
                If strYEAR <> "" Then Con2 = String.Format(" AND (SUBSTRING(YEARMON,1,4) = '{0}')", strYEAR)
                If strMED_FLAG <> "" Then Con3 = String.Format(" AND (ISNULL(MED_FLAG,'') = '{0}')", strMED_FLAG)

                strWhere = BuildFields(" ", Con1, Con2, Con3)

                strFormet = strFormet & " SELECT TIMCODE CUSTCODE, DBO.SC_GET_CUSTNAME_FUN(TIMCODE) CUSTNAME "
                strFormet = strFormet & " FROM MD_BOOKING_MEDIUM"
                strFormet = strFormet & " WHERE 1=1 AND (ISNULL(TRU_TAX_NO,'') <> '' OR ISNULL(COMMI_TAX_NO,'') <> '') "
                strFormet = strFormet & " {0}"
                strFormet = strFormet & " GROUP BY TIMCODE   ORDER BY TIMCODE"


                strSQL = String.Format(strFormet, strWhere)


                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST_PRINT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_PRINTCUSTAndTIM(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal mvntDataCust As Object, _
                                              ByVal mvntDataCustCNT As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strCLIENTCODE As String, _
                                              ByVal strSUBLIST As String, _
                                              ByVal strMED_FLAG As String) As Object

        Dim mvntData As Object
        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)


                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월
                If strSUBLIST <> "" Then Con2 = String.Format(" AND (TIMCODE IN({0}))", strSUBLIST) '년월
                If strMED_FLAG <> "" Then Con3 = String.Format(" AND (MED_FLAG = '{0}')", strMED_FLAG) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(TIMCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_BOOKING_MEDIUM"
                strSQL = strSQL & " where 1=1 and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '') AND SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, TIMCODE"

                'medcode = '" & mvntData2(1, i) & "' and 


                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  '계' CUST, "

                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_BOOKING_MEDIUM"
                strSQL = strSQL & " where 1=1 AND (ISNULL(TRU_TAX_NO,'') <> '' OR ISNULL(COMMI_TAX_NO,'') <> '') AND SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & " GROUP BY  CLIENTCODE, substring(DEMANDDAY , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY YEAR, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINTCUSTAndTIM")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "3. 인쇄 월간매체비/수수료별"

    Public Function SelectRtn_PRINT_MEDAMT(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByRef strYEARMON As String, _
                                           ByRef strREAL_MED_CODE As String, _
                                           ByRef strCLIENTCODE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (TAXYEARMON = ('{0}'))", strYEARMON) '년월
                If strREAL_MED_CODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE = ('{0}'))", strREAL_MED_CODE) '년월
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월

                'strSQL = "select "
                'strSQL = strSQL & " '1' SORTGBN ,"
                'strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                'strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                'strSQL = strSQL & " MEDCODE,"
                'strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                'strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname, "
                'strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) vat,"
                'strSQL = strSQL & " sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) as sumamt,"
                'strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) commivat,"
                'strSQL = strSQL & " sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) as sumcommission,"
                'strSQL = strSQL & " (sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then floor(isnull(amt,0) * 0.1) else 0 end)) - "
                'strSQL = strSQL & " (sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end)) as payamt,"
                'strSQL = strSQL & " DBO.SC_GET_CUSTOWNERNAME_FUN(medcode) CUSTOWNERNAME"
                'strSQL = strSQL & " from md_booking_medium"
                'strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                'strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')  and voch_type <> '2' "
                'strSQL = strSQL & " group by real_med_code, medcode,  clientcode"
                'strSQL = strSQL & " "
                'strSQL = strSQL & " UNION ALL"
                'strSQL = strSQL & " "
                'strSQL = strSQL & " select "
                'strSQL = strSQL & " '2' SORTGBN ,"
                'strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                'strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                'strSQL = strSQL & " 'ZZZ' MEDCODE,"
                'strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                'strSQL = strSQL & " '' clientname, "
                'strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end)vat,"
                'strSQL = strSQL & " sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) as sumamt,"
                'strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) commivat,"
                'strSQL = strSQL & " sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) as sumcommission,"
                'strSQL = strSQL & " (sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) * 0.1 else 0 end)) - "
                'strSQL = strSQL & " (sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end)) as payamt,"
                'strSQL = strSQL & " '' CUSTOWNERNAME"
                'strSQL = strSQL & " from md_booking_medium"
                'strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                'strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')  and voch_type <> '2' "
                'strSQL = strSQL & " group by real_med_code , medcode"
                'strSQL = strSQL & " "
                'strSQL = strSQL & " UNION ALL "
                'strSQL = strSQL & " "
                'strSQL = strSQL & " select "
                'strSQL = strSQL & " '3' SORTGBN ,"
                'strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                'strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                'strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                'strSQL = strSQL & " '' medname, "
                'strSQL = strSQL & " '' clientname, "
                'strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) vat,"
                'strSQL = strSQL & " sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) as sumamt,"
                'strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) commivat,"
                'strSQL = strSQL & " sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) as sumcommission,"
                'strSQL = strSQL & " (sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end)) -"
                'strSQL = strSQL & " (sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end)) as payamt,"
                'strSQL = strSQL & " '' CUSTOWNERNAME"
                'strSQL = strSQL & " from md_booking_medium"
                'strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                'strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')  and voch_type <> '2' "
                'strSQL = strSQL & " group by real_med_code"
                'strSQL = strSQL & " "
                'strSQL = strSQL & " UNION ALL "
                'strSQL = strSQL & " "
                'strSQL = strSQL & " select "
                'strSQL = strSQL & " '4' SORTGBN ,"
                'strSQL = strSQL & " 'zzzzzzzzzz' REAL_BUSINO, "
                'strSQL = strSQL & " '총계' real_med_name, "
                'strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                'strSQL = strSQL & " '' medname, "
                'strSQL = strSQL & " '' clientname, "
                'strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) vat,"
                'strSQL = strSQL & " sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end) as sumamt,"
                'strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) commivat,"
                'strSQL = strSQL & " sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end) as sumcommission,"
                'strSQL = strSQL & " (sum(isnull(amt,0)) + "
                'strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0) else 0 end)) -"
                'strSQL = strSQL & " (sum(isnull(commission,0)) + "
                'strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then floor(isnull(commission,0) * 0.1) else 0 end)) as payamt,"
                'strSQL = strSQL & " '' CUSTOWNERNAME"
                'strSQL = strSQL & " from md_booking_medium"
                'strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                'strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')  and voch_type <> '2' "
                'strSQL = strSQL & " "
                'strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"

                strSQL = " select "
                strSQL = strSQL & " '1' SORTGBN , "
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname,"
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(isnull(vat,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + sum(isnull(vat,0)) sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(isnull(commission,0) * 0.1) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1) sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(isnull(vat,0))) - (sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1)) payamt,"
                strSQL = strSQL & " DBO.SC_GET_CUSTOWNERNAME_FUN(medcode) CUSTOWNERNAME"
                strSQL = strSQL & " from md_trutax_dtl"
                strSQL = strSQL & " where 1=1" & Con1 & Con2 & Con3
                strSQL = strSQL & " and medflag in ('b','c')"
                strSQL = strSQL & " and 1=1 AND ISNULL(ATTR10,0) <> 999999 "
                strSQL = strSQL & " group by real_med_code, medcode,  clientcode"
                strSQL = strSQL & " union all"

                strSQL = strSQL & " select "
                strSQL = strSQL & " '2' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " 'ZZZ' MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(isnull(vat,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + sum(isnull(vat,0)) sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(isnull(commission,0) * 0.1) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1) sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(isnull(vat,0))) - (sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1)) payamt,"
                strSQL = strSQL & " '' CUSTOWNERNAME"
                strSQL = strSQL & " from md_trutax_dtl"
                strSQL = strSQL & " where 1=1" & Con1 & Con2 & Con3
                strSQL = strSQL & " and medflag in ('b','c')"
                strSQL = strSQL & " and 1=1 AND ISNULL(ATTR10,0) <> 999999 "
                strSQL = strSQL & " group by real_med_code, medcode"
                strSQL = strSQL & " union all"

                strSQL = strSQL & " select "
                strSQL = strSQL & " '3' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(isnull(vat,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + sum(isnull(vat,0)) sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(isnull(commission,0) * 0.1) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1) sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(isnull(vat,0))) - (sum(isnull(commission,0)) + sum(isnull(commission,0) * 0.1)) payamt,"
                strSQL = strSQL & " '' CUSTOWNERNAME"
                strSQL = strSQL & " from md_trutax_dtl"
                strSQL = strSQL & " where 1=1" & Con1 & Con2 & Con3
                strSQL = strSQL & " and medflag in ('b','c')"
                strSQL = strSQL & " and 1=1 AND ISNULL(ATTR10,0) <> 999999 "
                strSQL = strSQL & " group by real_med_code "
                strSQL = strSQL & " union all"

                strSQL = strSQL & " select "
                strSQL = strSQL & " '4' SORTGBN ,"
                strSQL = strSQL & " 'zzzzzzzzzz' REAL_BUSINO, "
                strSQL = strSQL & " '총계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname,"
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(isnull(vat,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + sum(isnull(vat,0)) sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " round(sum(isnull(commission,0) * 0.1),0,1) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + round(sum(isnull(commission,0) * 0.1),0,1) sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(isnull(vat,0))) - (sum(isnull(commission,0)) + round(sum(isnull(commission,0) * 0.1),0,1)) payamt,"
                strSQL = strSQL & " '' CUSTOWNERNAME"
                strSQL = strSQL & " from md_trutax_dtl"
                strSQL = strSQL & " where 1=1" & Con1 & Con2 & Con3
                strSQL = strSQL & " and medflag in ('b','c')"
                strSQL = strSQL & " and 1=1 AND ISNULL(ATTR10,0) <> 999999 "
                strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_PRINT_MEDAMT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "4. 인터넷 광고주별 매체사별"
    Public Function GetINTERNETCLIENTCNT(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByRef strYEAR As String, _
                                         ByRef strCLIENTLIST As String, _
                                         ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_INTERNET_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetINTERNETCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetINTERNETMEDCNT(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByRef strYEAR As String, _
                                      ByRef strCLIENTLIST As String, _
                                      ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '광고주코드
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '매체코드

                strSQL = " SELECT DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE From MD_INTERNET_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "   GROUP BY MEDCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetINTERNETMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_INTERNETCUSTAndMED(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal mintCnt2 As Object, _
                                                ByVal mvntDataCust As Object, _
                                                ByVal mvntDataCustCNT As Integer, _
                                                ByVal strYEAR As String, _
                                                ByVal strCLIENTLIST As String, _
                                                ByVal strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월
                'If strMED_FLAG <> "" Then Con3 = String.Format(" AND (MED_FLAG = '{0}')", strMED_FLAG) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_internet_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2 '& Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, MEDCODE"

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_internet_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2 '& Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, substring(yearmon , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY YEAR, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_INTERNETCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "4. 인터넷 연간매체사별"

    Public Function GetINTERNETREAL_MED_CNT(ByVal strInfoXML As String, _
                                            ByRef intRowCnt As Integer, _
                                            ByRef intColCnt As Integer, _
                                            ByRef strYEAR As String, _
                                            ByRef strREAL_MEDLIST As String) As Object


        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strREAL_MED_CODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_INTERNET_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO,'') <> ''  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetINTERNETREAL_MED_CNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_INTERNETClientGroup(ByVal strInfoXML As String, _
                                                  ByRef intRowCnt As Integer, _
                                                  ByRef intColCnt As Integer, _
                                                  ByVal mvntDataCust As Object, _
                                                  ByVal mvntDataCustCNT As Integer, _
                                                  ByVal strYEAR As String, _
                                                  ByVal strREAL_MEDLIST As String) As Object     'XML  데이터 조회시 mvntDataCust

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strREAL_MED_CODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = "SELECT REAL_MED_NAME, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_INTERNET_MEDIUM"
                strSQL = strSQL & " WHERE SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' AND ISNULL(TRU_TRANS_NO,'') <> ''" & Con1
                strSQL = strSQL & " GROUP BY REAL_MED_CODE"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  '계' REAL_MED_NAME, "
                strSQL = strSQL & "  'zzzzzzz' REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_INTERNET_MEDIUM"
                strSQL = strSQL & " WHERE  SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' and ISNULL(TRU_TRANS_NO,'') <> ''" & Con1
                strSQL = strSQL & " GROUP BY SUBSTRING(DEMANDDAY , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY REAL_MED_NAME2, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_INTERNETClientGroup")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "4. 인터넷 월간매체비/수수료별"

    Public Function SelectRtn_INTERNET_MEDAMT(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByRef strYEARMON As String, _
                                              ByRef strREAL_MED_CODE As String, _
                                              ByRef strCLIENTCODE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = ('{0}'))", strYEARMON) '년월
                If strREAL_MED_CODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE = ('{0}'))", strREAL_MED_CODE) '년월
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월


                strSQL = strSQL & " select "
                strSQL = strSQL & " '1' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then  isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end))"
                strSQL = strSQL & " - "
                strSQL = strSQL & " (sum(isnull(commission,0)) + sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end)) as payamt"
                strSQL = strSQL & " from md_INTERNET_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code, medcode,  clientcode"

                strSQL = strSQL & " UNION ALL"

                strSQL = strSQL & " select "
                strSQL = strSQL & " '2' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " 'ZZZ' MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then  isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end))"
                strSQL = strSQL & " - "
                strSQL = strSQL & " (sum(isnull(commission,0)) + sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end)) as payamt"
                strSQL = strSQL & " from md_INTERNET_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code , medcode"

                strSQL = strSQL & " UNION ALL "

                strSQL = strSQL & " select "
                strSQL = strSQL & " '3' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then  isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end))"
                strSQL = strSQL & " - "
                strSQL = strSQL & " (sum(isnull(commission,0)) + sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end)) as payamt"
                strSQL = strSQL & " from md_INTERNET_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code"

                strSQL = strSQL & " UNION ALL "

                strSQL = strSQL & " select "
                strSQL = strSQL & " '4' SORTGBN ,"
                strSQL = strSQL & " 'zzzzzzzzzz' REAL_BUSINO, "
                strSQL = strSQL & " '총계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then  isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " (sum(isnull(amt,0)) + sum(case when isnull(tru_tax_flag,'Y') = 'Y' then round(isnull(amt,0) * 0.1,0,1) else 0 end))"
                strSQL = strSQL & " - "
                strSQL = strSQL & " (sum(isnull(commission,0)) + sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end)) as payamt"
                strSQL = strSQL & " from md_INTERNET_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"

                strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_INTERNET_MEDAMT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "5. 케이블 광고주별 매체사별"
    Public Function GetCATVCLIENTCNT(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByRef strYEAR As String, _
                                     ByRef strCLIENTLIST As String, _
                                     ByRef strMEDLIST As String, _
                                     ByRef strVOCH_TYPE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월
                If strVOCH_TYPE <> "" Then Con3 = String.Format(" AND (VOCH_TYPE ='{0}')", strVOCH_TYPE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_CATV_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCATVCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetCATVMEDCNT(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByRef strYEAR As String, _
                                  ByRef strCLIENTLIST As String, _
                                  ByRef strMEDLIST As String, _
                                  ByRef strVOCH_TYPE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = "" : Con2 = "" : Con3 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '광고주코드
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '매체코드
                If strVOCH_TYPE <> "" Then Con3 = String.Format(" AND (VOCH_TYPE ='{0}')", strVOCH_TYPE) '년월

                strSQL = " SELECT DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE From MD_CATV_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & "   GROUP BY MEDCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCATVMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_CATVCUSTAndMED(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByVal mintCnt2 As Object, _
                                             ByVal mvntDataCust As Object, _
                                             ByVal mvntDataCustCNT As Integer, _
                                             ByVal strYEAR As String, _
                                             ByVal strCLIENTLIST As String, _
                                             ByVal strMEDLIST As String, _
                                             ByVal strVOCH_TYPE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월
                If strVOCH_TYPE <> "" Then Con3 = String.Format(" AND (VOCH_TYPE ='{0}')", strVOCH_TYPE) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR1, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from MD_CATV_MEDIUM"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, MEDCODE"

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR1, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_catv_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3
                strSQL = strSQL & " GROUP BY CLIENTCODE, substring(yearmon , 1,4)"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 3 SORTGBN,"
                strSQL = strSQL & "  '총계' YEAR, "
                strSQL = strSQL & "  'ZZZZ' YEAR1, "
                strSQL = strSQL & "  '' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_catv_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2 & Con3

                strSQL = strSQL & " ) REAL ORDER BY YEAR1, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CATVCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "5. 케이블 연간매체사별"

    Public Function GetCATVREAL_MED_CNT(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByRef strYEAR As String, _
                                        ByRef strREAL_MEDLIST As String) As Object


        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strREAL_MED_CODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_CATV_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO,'') <> ''  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCATVREAL_MED_CNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_CATVClientGroup(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer, _
                                              ByVal mvntDataCust As Object, _
                                              ByVal mvntDataCustCNT As Integer, _
                                              ByVal strYEAR As String, _
                                              ByVal strREAL_MEDLIST As String) As Object     'XML  데이터 조회시 mvntDataCust

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strREAL_MED_CODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = "SELECT REAL_MED_NAME, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_CATV_MEDIUM"
                strSQL = strSQL & " WHERE SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' AND ISNULL(TRU_TRANS_NO,'') <> ''" & Con1
                strSQL = strSQL & " GROUP BY REAL_MED_CODE"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  '계' REAL_MED_NAME, "
                strSQL = strSQL & "  'zzzzzzz' REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_CATV_MEDIUM"
                strSQL = strSQL & " WHERE  SUBSTRING(DEMANDDAY , 1,4)='" & strYEAR & "' and ISNULL(TRU_TRANS_NO,'') <> ''" & Con1
                strSQL = strSQL & " GROUP BY SUBSTRING(DEMANDDAY , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY REAL_MED_NAME2, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CATVClientGroup")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "5. 케이블 월간매체비/수수료별"

    Public Function SelectRtn_CATV_MEDAMT(ByVal strInfoXML As String, _
                                          ByRef intRowCnt As Integer, _
                                          ByRef intColCnt As Integer, _
                                          ByRef strYEARMON As String, _
                                          ByRef strREAL_MED_CODE As String, _
                                          ByRef strCLIENTCODE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = ('{0}'))", strYEARMON) '년월
                If strREAL_MED_CODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE = ('{0}'))", strREAL_MED_CODE) '년월
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월


                strSQL = strSQL & " select "
                strSQL = strSQL & " '1' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_CATV_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code, medcode,  clientcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '2' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " 'ZZZ' MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_CATV_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code , medcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL "
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '3' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_CATV_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL "
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '4' SORTGBN ,"
                strSQL = strSQL & " 'zzzzzzzzzz' REAL_BUSINO, "
                strSQL = strSQL & " '총계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_CATV_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " "
                strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CATV_MEDAMT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "6. 옥외 광고주별 매체사별"

    Public Function GetOUTDOORCLIENTCNT(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByRef strYEAR As String, _
                                        ByRef strCLIENTLIST As String, _
                                        ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_OUTDOOR_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(COMMI_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetOUTDOORCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetOUTDOORMEDCNT(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByRef strYEAR As String, _
                                     ByRef strCLIENTLIST As String, _
                                     ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT dbo.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) MEDNAME, REAL_MED_CODE MEDCODE From MD_OUTDOOR_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND ISNULL(COMMI_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "   GROUP BY REAL_MED_CODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetOUTDOORMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_OUTDOORCUSTAndMED(ByVal strInfoXML As String, _
                                                ByRef intRowCnt As Integer, _
                                                ByRef intColCnt As Integer, _
                                                ByVal mintCnt2 As Object, _
                                                ByVal mvntDataCust As Object, _
                                                ByVal mvntDataCustCNT As Integer, _
                                                ByVal strYEAR As String, _
                                                ByVal strCLIENTLIST As String, _
                                                ByVal strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE IN({0}))", strMEDCODE) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " where 1=1 and isnull(COMMI_TRANS_NO,'')<> '' and substring(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY CLIENTCODE, REAL_MED_CODE"

                ''medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " where 1=1 and isnull(COMMI_TRANS_NO,'')<> '' and substring(DEMANDDAY , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY CLIENTCODE, substring(yearmon , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY YEAR, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_OUTDOORCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "6. 옥외 연간매체사별"

    Public Function GetOUTDOORREAL_MED_CNT(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByRef strYEAR As String, _
                                           ByRef strREAL_MEDLIST As String) As Object


        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strREAL_MED_CODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_OUTDOOR_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(COMMI_TRANS_NO,'') <> ''  AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetOUTDOORREAL_MED_CNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_OUTDOORClientGroup(ByVal strInfoXML As String, _
                                                 ByRef intRowCnt As Integer, _
                                                 ByRef intColCnt As Integer, _
                                                 ByVal mvntDataCust As Object, _
                                                 ByVal mvntDataCustCNT As Integer, _
                                                 ByVal strYEAR As String, _
                                                 ByVal strREAL_MEDLIST As String) As Object     'XML  데이터 조회시 mvntDataCust

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strREAL_MED_CODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strREAL_MEDLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strREAL_MED_CODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strREAL_MED_CODE = "'" & objCLIENT(i) & "'"
                    Else
                        strREAL_MED_CODE = strREAL_MED_CODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strREAL_MED_CODE <> "" Then Con1 = String.Format(" AND (REAL_MED_CODE IN({0}))", strREAL_MED_CODE) '년월

                strSQL = "SELECT REAL_MED_NAME, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " where substring(DEMANDDAY , 1,4)='" & strYEAR & "' and ISNULL(COMMI_TRANS_NO,'') <> '' " & Con1
                strSQL = strSQL & " GROUP BY REAL_MED_CODE"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  '계' REAL_MED_NAME, "
                strSQL = strSQL & "  'zzzzzzz' REAL_MED_NAME2, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(DEMANDDAY,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN ISNULL(AMT,0) ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(ISNULL(AMT,0)) SUMAMT"
                strSQL = strSQL & " from MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & " where  substring(DEMANDDAY , 1,4)='" & strYEAR & "' and ISNULL(COMMI_TRANS_NO,'') <> '' " & Con1
                strSQL = strSQL & " GROUP BY substring(DEMANDDAY , 1,4)"
                strSQL = strSQL & " ) REAL ORDER BY REAL_MED_NAME2, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_OUTDOORClientGroup")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "6. 옥외 월간매체비/수수료별"

    Public Function SelectRtn_OUTDOOR_MEDAMT(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByRef strYEARMON As String, _
                                             ByRef strREAL_MED_CODE As String, _
                                             ByRef strCLIENTCODE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = ('{0}'))", strYEARMON) '년월
                If strREAL_MED_CODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE = ('{0}'))", strREAL_MED_CODE) '년월
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월


                strSQL = strSQL & " select "
                strSQL = strSQL & " '1' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_OUTDOOR_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code, medcode,  clientcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '2' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " 'ZZZ' MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_OUTDOOR_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code , medcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL "
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '3' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from md_OUTDOOR_medium"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code"
                strSQL = strSQL & " "
                strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_OUTDOOR_MEDAMT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region



#Region "7. 종합편성방송 광고주별 매체사별"
    Public Function GetTOTALCLIENTCNT(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByRef strYEAR As String, _
                                     ByRef strCLIENTLIST As String, _
                                     ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim strCLIENTCODE, strMEDCODE
        Dim intCUSTRows, intREALRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else

                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next
                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = " SELECT SUBSTRING(DEMANDDAY,5,2) + '월' MON , SUBSTRING(DEMANDDAY,5,2) MON2 From MD_TOTAL_MEDIUM "
                strSQL = strSQL & "  WHERE 1=1 AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "  GROUP BY SUBSTRING(DEMANDDAY,5,2)"
                strSQL = strSQL & "  ORDER BY SUBSTRING(DEMANDDAY,5,2)"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetTOTALCLIENTCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetTOTALMEDCNT(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByRef strYEAR As String, _
                                  ByRef strCLIENTLIST As String, _
                                  ByRef strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2 As String
        Dim objCLIENT, objMED
        Dim intCUSTRows, intREALRows
        Dim strCLIENTCODE, strMEDCODE
        Dim i

        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '광고주코드
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '매체코드

                strSQL = " SELECT DBO.SC_GET_CUSTNAME_FUN(MEDCODE) MEDNAME, MEDCODE From MD_TOTAL_MEDIUM "
                strSQL = strSQL & "   WHERE 1=1  AND ISNULL(TRU_TRANS_NO, '') <> '' AND SUBSTRING(DEMANDDAY,1,4) =  '" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & "   GROUP BY MEDCODE"

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".GetTOTALMEDCNT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function SelectRtn_TOTALCUSTAndMED(ByVal strInfoXML As String, _
                                             ByRef intRowCnt As Integer, _
                                             ByRef intColCnt As Integer, _
                                             ByVal mintCnt2 As Object, _
                                             ByVal mvntDataCust As Object, _
                                             ByVal mvntDataCustCNT As Integer, _
                                             ByVal strYEAR As String, _
                                             ByVal strCLIENTLIST As String, _
                                             ByVal strMEDLIST As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim Con1, Con2, Con3 As String
        Dim i, j
        Dim objCLIENT
        Dim objMED
        Dim intCUSTRows
        Dim intREALRows
        Dim strCLIENTCODE
        Dim strMEDCODE
        Dim mvntData

        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                objCLIENT = Split(strCLIENTLIST, "|")

                intCUSTRows = UBound(objCLIENT, 1)
                strCLIENTCODE = ""
                For i = 0 To intCUSTRows
                    If i = 0 Then
                        strCLIENTCODE = "'" & objCLIENT(i) & "'"
                    Else
                        strCLIENTCODE = strCLIENTCODE & ",'" & objCLIENT(i) & "'"
                    End If
                Next

                objMED = Split(strMEDLIST, "|")

                intREALRows = UBound(objMED, 1)
                strMEDCODE = ""
                For i = 0 To intREALRows
                    If i = 0 Then
                        strMEDCODE = "'" & objMED(i) & "'"
                    Else
                        strMEDCODE = strMEDCODE & ",'" & objMED(i) & "'"
                    End If
                Next

                Con1 = ""
                Con2 = ""

                If strCLIENTCODE <> "" Then Con1 = String.Format(" AND (CLIENTCODE IN({0}))", strCLIENTCODE) '년월
                If strMEDCODE <> "" Then Con2 = String.Format(" AND (MEDCODE IN({0}))", strMEDCODE) '년월

                strSQL = "SELECT YEAR, CUST, "
                For j = 1 To mvntDataCustCNT

                    strSQL = strSQL & " A" & j & ","
                Next
                strSQL = strSQL & " SUMAMT FROM ("

                strSQL = strSQL & " SELECT 1 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR1, "
                strSQL = strSQL & "  DBO.SC_GET_CUSTNAME_FUN(MEDCODE) CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_TOTAL_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY CLIENTCODE, MEDCODE"

                'medcode = '" & mvntData2(1, i) & "' and 

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 2 SORTGBN,"
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR, "
                strSQL = strSQL & "  DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) YEAR1, "
                strSQL = strSQL & "  '계' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_TOTAL_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2
                strSQL = strSQL & " GROUP BY CLIENTCODE, substring(yearmon , 1,4)"

                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " SELECT 3 SORTGBN,"
                strSQL = strSQL & "  '총계' YEAR, "
                strSQL = strSQL & "  'ZZZZ' YEAR1, "
                strSQL = strSQL & "  '' CUST, "
                For j = 1 To mvntDataCustCNT
                    strSQL = strSQL & "  SUM(CASE SUBSTRING(YEARMON,5,2) WHEN '" & mvntDataCust(1, j) & "' THEN AMT ELSE 0 END ) A" & j & ","
                Next
                strSQL = strSQL & "  SUM(AMT) SUMAMT"
                strSQL = strSQL & " from md_TOTAL_medium"
                strSQL = strSQL & " where 1=1 and isnull(tru_trans_no,'')<> '' and substring(yearmon , 1,4)='" & strYEAR & "'" & Con1 & Con2

                strSQL = strSQL & " ) REAL ORDER BY YEAR1, SORTGBN"

                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_TOTALCUSTAndMED")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "7. 종합편성방송 월간매체비/수수료별"

    Public Function SelectRtn_TOTAL_MEDAMT(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByVal strYEARMON As String, _
                                           ByVal strREAL_MED_CODE As String, _
                                           ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormat, strRtn As String
        Dim mvntData As Object
        Dim Con1, Con2, Con3 As String
        Dim objCLIENT, objMED
        Dim intCol, intRows
        Dim i
        With mobjSCGLConfig '기본정보 Config 개체 
            Try
                SetConfig(strInfoXML)
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                Con1 = ""
                Con2 = ""
                Con3 = ""

                If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = ('{0}'))", strYEARMON) '년월
                If strREAL_MED_CODE <> "" Then Con2 = String.Format(" AND (REAL_MED_CODE = ('{0}'))", strREAL_MED_CODE) '년월
                If strCLIENTCODE <> "" Then Con3 = String.Format(" AND (CLIENTCODE = ('{0}'))", strCLIENTCODE) '년월


                strSQL = strSQL & " select "
                strSQL = strSQL & " '1' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) medname, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(clientcode) clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from MD_TOTAL_MEDIUM"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code, medcode,  clientcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL"
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '2' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code) real_med_name, "
                strSQL = strSQL & " 'ZZZ' MEDCODE,"
                strSQL = strSQL & " DBO.SC_GET_CUSTNAME_FUN(medcode) + ' 소계' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from MD_TOTAL_MEDIUM"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code , medcode"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL "
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '3' SORTGBN ,"
                strSQL = strSQL & " DBO.SC_GET_BUSINO_FUN(REAL_MED_CODE) REAL_BUSINO, "
                strSQL = strSQL & " DBO.SC_GET_HIGHCOMPANYNAME_FUN(real_med_code)+' 소계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from MD_TOTAL_MEDIUM"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " group by real_med_code"
                strSQL = strSQL & " "
                strSQL = strSQL & " UNION ALL "
                strSQL = strSQL & " "
                strSQL = strSQL & " select "
                strSQL = strSQL & " '4' SORTGBN ,"
                strSQL = strSQL & " 'zzzzzzzzzz' REAL_BUSINO, "
                strSQL = strSQL & " '총계' real_med_name, "
                strSQL = strSQL & " 'ZZZZ' MEDCODE,"
                strSQL = strSQL & " '' medname, "
                strSQL = strSQL & " '' clientname, "
                strSQL = strSQL & " sum(isnull(amt,0)) amt,"
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) vat,"
                strSQL = strSQL & " sum(isnull(amt,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(tru_tax_flag,'Y') = 'Y' then isnull(amt,0) * 0.1 else 0 end,0)) as sumamt,"
                strSQL = strSQL & " sum(isnull(commission,0)) commission,"
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) commivat,"
                strSQL = strSQL & " sum(isnull(commission,0)) + "
                strSQL = strSQL & " sum(round(case when isnull(commi_tax_flag,'Y') = 'Y' then isnull(commission,0) * 0.1 else 0 end,0)) as sumcommission,"
                strSQL = strSQL & " sum(isnull(amt,0)) - sum(isnull(commission,0)) payamt"
                strSQL = strSQL & " from MD_TOTAL_MEDIUM"
                strSQL = strSQL & " where 1=1 " & Con1 & Con2 & Con3
                strSQL = strSQL & " and (isnull(tru_tax_no,'') <> '' or isnull(commi_tax_no,'') <> '')"
                strSQL = strSQL & " "
                strSQL = strSQL & " order by REAL_BUSINO,real_med_name, medname, SORTGBN, clientname"


                .mobjSCGLSql.SQLConnect(.DBConnStr)
                mvntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return mvntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_TOTAL_MEDAMT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region


#Region "GROUP BLOCK : 외부에 비공개 Method"

    ' Private FunctionInsertRtn_XXX(ByVal xmlRoot As XmlElement) As Integer
    '     '해당 엔티티 클래스 Maker에서 기본 코드 제공(XML)
    ' End Function
    ' Private Function UpdateRtn_XXX(ByValxmlRoot As XmlElement) As Integer
    '      '해당엔티티 클래스 Maker에서 기본코드 제공(XML)
    ' End Function
    ' Private Function InsertRtn_XXX(ByVal vntData As Object,ByVal intColCnt As Integer, ByVal intRow As Integer) As Integer
    '     '해당 엔티티 클래스Maker에서 기본 코드 제공(Sheet)
    ' End Function
    ' Private Function UpdateRtn_XXX(ByVal vntData As Object,ByVal intColCnt As Integer, ByVal intRow As Integer) As Integer
    '     '해당 엔티티 클래스Maker에서 기본코드 제공(Sheet)
    ' End Function

#End Region
End Class