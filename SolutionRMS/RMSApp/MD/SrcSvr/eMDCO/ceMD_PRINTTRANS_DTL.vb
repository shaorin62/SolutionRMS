'****************************************************************************************
'Generated By: JNF BY Solution
'시스템구분 : SolutionOLD/MD/ceMD_PRINTTRANS_DTL Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceMD_BOOKING_MEDIUM.vb ( ceMD_PRINTTRANS_DTL Entity 처리 Class)
'기      능 : MD_BOOKING_MEDIUM Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-08-18 오후 2:40:17 By Kim Tae Ho
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceMD_PRINTTRANS_DTL
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceMD_PRINTTRANS_DTL"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strTRANSYEARMON As String, _
            ByVal dblTRANSNO As Double, _
            ByVal dblSEQ As Double, _
            ByVal strCLIENTCODE As String, _
            ByVal strTIMCODE As String, _
            ByVal strREAL_MED_CODE As String, _
            ByVal strMEDCODE As String, _
            ByVal strSUBSEQ As String, _
            ByVal strMATTERCODE As String, _
            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
            Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
            Optional ByVal strPRINTDAY As String = OPTIONAL_STR, _
            Optional ByVal dblSTD_CM As Double = OPTIONAL_NUM, _
            Optional ByVal dblSTD_STEP As Double = OPTIONAL_NUM, _
            Optional ByVal dblSTD_FACE As Double = OPTIONAL_NUM, _
            Optional ByVal strSTD As String = OPTIONAL_STR, _
            Optional ByVal dblSTD_PAGE As Double = OPTIONAL_NUM, _
            Optional ByVal strCOL_DEG As String = OPTIONAL_STR, _
            Optional ByVal strPUB_DATE As String = OPTIONAL_STR, _
            Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblCOMMI_RATE As Double = OPTIONAL_NUM, _
            Optional ByVal dblCOMMISSION As Double = OPTIONAL_NUM, _
            Optional ByVal dblVAT As Double = OPTIONAL_NUM, _
            Optional ByVal strMED_FLAG As String = OPTIONAL_STR, _
            Optional ByVal strPROJECTION As String = OPTIONAL_STR, _
            Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
            Optional ByVal strVOCH_TYPE As String = OPTIONAL_STR, _
            Optional ByVal strTRU_TAX_FLAG As String = OPTIONAL_STR, _
            Optional ByVal strDUTYFLAG As String = OPTIONAL_STR, _
            Optional ByVal strTRUST_YEARMON As String = OPTIONAL_STR, _
            Optional ByVal dblTRUST_SEQ As Double = OPTIONAL_NUM, _
            Optional ByVal strMEMO As String = OPTIONAL_STR, _
            Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, _
            Optional ByVal dblTAXNO As Double = OPTIONAL_NUM, _
            Optional ByVal dblCONFIRMFLAG As Double = OPTIONAL_NUM, _
            Optional ByVal dblPRINT_SEQ As Double = OPTIONAL_NUM, _
            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
            Optional ByVal strATTR04 As String = OPTIONAL_STR, _
            Optional ByVal strATTR05 As String = OPTIONAL_STR, _
            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR07 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR08 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR09 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR10 As Double = OPTIONAL_NUM)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            BuildNameValues(",", "TRANSYEARMON", strTRANSYEARMON, strFields, strValues)
            BuildNameValues(",", "TRANSNO", dblTRANSNO, strFields, strValues)
            BuildNameValues(",", "SEQ", dblSEQ, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "TIMCODE", strTIMCODE, strFields, strValues)
            BuildNameValues(",", "REAL_MED_CODE", strREAL_MED_CODE, strFields, strValues)
            BuildNameValues(",", "MEDCODE", strMEDCODE, strFields, strValues)
            BuildNameValues(",", "SUBSEQ", strSUBSEQ, strFields, strValues)
            BuildNameValues(",", "MATTERCODE", strMATTERCODE, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "DEMANDDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "PRINTDAY", strPRINTDAY, strFields, strValues)
            BuildNameValues(",", "STD_CM", dblSTD_CM, strFields, strValues)
            BuildNameValues(",", "STD_STEP", dblSTD_STEP, strFields, strValues)
            BuildNameValues(",", "STD_FACE", dblSTD_FACE, strFields, strValues)
            BuildNameValues(",", "STD", strSTD, strFields, strValues)
            BuildNameValues(",", "STD_PAGE", dblSTD_PAGE, strFields, strValues)
            BuildNameValues(",", "COL_DEG", strCOL_DEG, strFields, strValues)
            BuildNameValues(",", "PUB_DATE", strPUB_DATE, strFields, strValues)
            BuildNameValues(",", "AMT", dblAMT, strFields, strValues)
            BuildNameValues(",", "COMMI_RATE", dblCOMMI_RATE, strFields, strValues)
            BuildNameValues(",", "COMMISSION", dblCOMMISSION, strFields, strValues)
            BuildNameValues(",", "VAT", dblVAT, strFields, strValues)
            BuildNameValues(",", "MED_FLAG", strMED_FLAG, strFields, strValues)
            BuildNameValues(",", "PROJECTION", strPROJECTION, strFields, strValues)
            BuildNameValues(",", "EXCLIENTCODE", strEXCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "VOCH_TYPE", strVOCH_TYPE, strFields, strValues)
            BuildNameValues(",", "TRU_TAX_FLAG", strTRU_TAX_FLAG, strFields, strValues)
            BuildNameValues(",", "DUTYFLAG", strDUTYFLAG, strFields, strValues)
            BuildNameValues(",", "TRUST_YEARMON", strTRUST_YEARMON, strFields, strValues)
            BuildNameValues(",", "TRUST_SEQ", dblTRUST_SEQ, strFields, strValues)
            BuildNameValues(",", "MEMO", strMEMO, strFields, strValues)
            BuildNameValues(",", "TAXYEARMON", strTAXYEARMON, strFields, strValues)
            BuildNameValues(",", "TAXNO", dblTAXNO, strFields, strValues)
            BuildNameValues(",", "CONFIRMFLAG", dblCONFIRMFLAG, strFields, strValues)
            BuildNameValues(",", "PRINT_SEQ", dblPRINT_SEQ, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "ATTR02", strATTR02, strFields, strValues)
            BuildNameValues(",", "ATTR03", strATTR03, strFields, strValues)
            BuildNameValues(",", "ATTR04", strATTR04, strFields, strValues)
            BuildNameValues(",", "ATTR05", strATTR05, strFields, strValues)
            BuildNameValues(",", "ATTR06", dblATTR06, strFields, strValues)
            BuildNameValues(",", "ATTR07", dblATTR07, strFields, strValues)
            BuildNameValues(",", "ATTR08", dblATTR08, strFields, strValues)
            BuildNameValues(",", "ATTR09", dblATTR09, strFields, strValues)
            BuildNameValues(",", "ATTR10", dblATTR10, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)

            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function

    Public Function ConfirmUpdate(ByVal strTRANSYEARMON As String, _
                                  ByVal strTRANSNO As Double) As Integer
        Dim strSQL
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Dim strUSER As String
        strUSER = mobjSCGLConfig.WRKUSR
        Try
            strSQL = "UPDATE MD_PRINTTRANS_DTL "
            strSQL = strSQL & " SET CONFIRMFLAG = 1, "
            strSQL = strSQL & " ATTR04 = '" & strUSER & "', "
            strSQL = strSQL & " ATTR05 =  '" & strNOW & "'"
            strSQL = strSQL & " WHERE TRANSYEARMON = '" & strTRANSYEARMON & "' AND TRANSNO = " & strTRANSNO
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".ConfirmUpdate")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function DeleteDo(Optional ByVal strTRANSYEARMON As String = OPTIONAL_STR, Optional ByVal dblTRANSNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("DELETE FROM {0} WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("TRANSYEARMON", strTRANSYEARMON), GetFieldNameValue("TRANSNO", dblTRANSNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Select 처리
    '*****************************************************************
    Public Function SelectDo(ByRef intRowCnt As Integer, ByRef intColCnt As Integer, _
                            Optional ByVal strTRANSYEARMON As String = OPTIONAL_STR, _
Optional ByVal dblTRANSNO As Double = OPTIONAL_NUM, _
Optional ByVal dblSEQ As Double = OPTIONAL_NUM, _
                            Optional ByVal strSelFields As String = "*", _
                            Optional ByVal intLimitRow As Integer = 0, _
                            Optional ByVal intSelMode As Integer = SELMODE.ARR, _
                            Optional ByVal blnBindingHeader As Boolean = False) As Object
        Dim strSQL As String
        Dim strKeyFields As String

        Try
            strKeyFields = BuildFields("AND", _
                                    GetFieldNameValue("TRANSYEARMON", strTRANSYEARMON), GetFieldNameValue("TRANSNO", dblTRANSNO), GetFieldNameValue("SEQ", dblSEQ))

            Return SelectDoExt(intRowCnt, intColCnt, strSelFields, strKeyFields, intLimitRow, intSelMode, blnBindingHeader)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".SeleteDo")
        End Try
    End Function
    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 거래명세 디테일 의 세금계산서 번호 업데이트
    '*****************************************************************
    Public Function Update_TruTax(ByVal strTRANSYEARMON As String, _
                                  ByVal lngTRANSNO As Double, _
                                  ByVal lngSEQ As Double, _
                                  ByVal strTAXYEARMON As String, _
                                  ByVal intTAXNO As Double) As Integer
        'strTRANSNO, strTAXNO
        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_PRINTTRANS_DTL SET TAXYEARMON = '" & strTAXYEARMON & "',TAXNO = " & intTAXNO
            strSQL = strSQL & "  WHERE TRANSYEARMON = '" & strTRANSYEARMON & "' AND TRANSNO =" & lngTRANSNO & " AND SEQ =" & lngSEQ
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_TruTax")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 삭제시 거래명세 디테일 의 세금계산서 번호 삭제
    '*****************************************************************
    'strTAXYEARMON, intTAXNO
    Public Function TruTaxDeleteUpdateDo(ByVal strTAXYEARMON As String, _
                                         ByVal intTAXNO As Double) As Integer
        'strTRANSNO, strTAXNO
        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_PRINTTRANS_DTL SET TAXYEARMON = '',TAXNO = NULL "
            strSQL = strSQL & "  WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO ='" & intTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".TruTaxDeleteUpdateDo")
        End Try
    End Function

	'*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 거래명세서 완료건에 대하여 부가세 수정
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************

    Public Function Update_Vat(ByVal strTRANSYEARMON, ByVal strTRANSNO, ByVal intTRANSSEQ, ByVal lngVAT) As Integer
        Dim strSQL As String

        Try
            strSQL = " UPDATE MD_PRINTTRANS_DTL "
            strSQL = strSQL & " SET VAT = " & lngVAT
            strSQL = strSQL & " WHERE TRANSYEARMON = '" & strTRANSYEARMON & "' "
            strSQL = strSQL & " AND TRANSNO = " & strTRANSNO
            strSQL = strSQL & " AND SEQ = " & intTRANSSEQ

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_Vat")
        End Try
    End Function

#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "MD_PRINTTRANS_DTL"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region
End Class
