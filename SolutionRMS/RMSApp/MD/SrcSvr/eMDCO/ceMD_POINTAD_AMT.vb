'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 엔티티 클래스 메이커 - 한화 S&C
'시스템구분 : 솔루션명/시스템명/Server Entity Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceMD_INTERNET_MEDIUM.vb ( MD_INTERNET_MEDIUM Entity 처리 Class)
'기      능 : MD_INTERNET_MEDIUM Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-01-19 오후 7:19:00 By Making Entity Bean
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceMD_POINTAD_AMT
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceMD_POINTAD_AMT"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"

#Region "SQL Insert/Update/Delete/Select"
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strYEARMON As String, _
                             ByVal dblSEQ As Double, _
                             Optional ByVal strCAMPAIGN_CODE As String = OPTIONAL_STR, _
                             Optional ByVal strGUBUN As String = OPTIONAL_STR, _
                             Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                             Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblTIM_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblTIM_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblEX_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblEX_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblOCB_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblOCB_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblKAKAO_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblMCAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal strCOMMI_TRANS_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCOMMI_TAX_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCOMMI_VOCH_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCONFIRM_USER As String = OPTIONAL_STR, _
                             Optional ByVal strCONFIRM_DATE As String = OPTIONAL_STR, _
                             Optional ByVal strMEMO As String = OPTIONAL_STR, _
                             Optional ByVal strATTR01 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR02 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR03 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR04 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR05 As String = OPTIONAL_STR)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now

        Try
            BuildNameValues(",", "YEARMON", strYEARMON, strFields, strValues)
            BuildNameValues(",", "SEQ", dblSEQ, strFields, strValues)
            BuildNameValues(",", "CAMPAIGN_CODE", strCAMPAIGN_CODE, strFields, strValues)
            BuildNameValues(",", "GUBUN", strGUBUN, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "EXCLIENTCODE", strEXCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "AMT", dblAMT, strFields, strValues)
            BuildNameValues(",", "TIM_RATE", dblTIM_RATE, strFields, strValues)
            BuildNameValues(",", "TIM_AMT", dblTIM_AMT, strFields, strValues)
            BuildNameValues(",", "EX_RATE", dblEX_RATE, strFields, strValues)
            BuildNameValues(",", "EX_AMT", dblEX_AMT, strFields, strValues)
            BuildNameValues(",", "OCB_RATE", dblOCB_RATE, strFields, strValues)
            BuildNameValues(",", "OCB_AMT", dblOCB_AMT, strFields, strValues)
            BuildNameValues(",", "KAKAO_AMT", dblKAKAO_AMT, strFields, strValues)
            BuildNameValues(",", "MC_AMT", dblMCAMT, strFields, strValues)
            BuildNameValues(",", "COMMI_TRANS_NO", strCOMMI_TRANS_NO, strFields, strValues)
            BuildNameValues(",", "COMMI_TAX_NO", strCOMMI_TAX_NO, strFields, strValues)
            BuildNameValues(",", "COMMI_VOCH_NO", strCOMMI_VOCH_NO, strFields, strValues)
            BuildNameValues(",", "CONFIRM_USER", strCONFIRM_USER, strFields, strValues)
            BuildNameValues(",", "CONFIRM_DATE", strCONFIRM_DATE, strFields, strValues)
            BuildNameValues(",", "MEMO", strMEMO, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "ATTR02", strATTR02, strFields, strValues)
            BuildNameValues(",", "ATTR03", strATTR03, strFields, strValues)
            BuildNameValues(",", "ATTR04", strATTR04, strFields, strValues)
            BuildNameValues(",", "ATTR05", strATTR05, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)

            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateDo(ByVal strYEARMON As String, _
                             ByVal dblSEQ As Double, _
                             Optional ByVal strCAMPAIGN_CODE As String = OPTIONAL_STR, _
                             Optional ByVal strGUBUN As String = OPTIONAL_STR, _
                             Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                             Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblTIM_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblTIM_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblEX_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblEX_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblOCB_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblOCB_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblKAKAO_AMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblMCAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal strCOMMI_TRANS_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCOMMI_TAX_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCOMMI_VOCH_NO As String = OPTIONAL_STR, _
                             Optional ByVal strCONFIRM_USER As String = OPTIONAL_STR, _
                             Optional ByVal strCONFIRM_DATE As String = OPTIONAL_STR, _
                             Optional ByVal strMEMO As String = OPTIONAL_STR, _
                             Optional ByVal strATTR01 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR02 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR03 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR04 As String = OPTIONAL_STR, _
                             Optional ByVal strATTR05 As String = OPTIONAL_STR) As Integer

        Dim strSQL As String
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now

        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("GUBUN", strGUBUN), _
                        GetFieldNameValue("CLIENTCODE", strCLIENTCODE), _
                        GetFieldNameValue("EXCLIENTCODE", strEXCLIENTCODE), _
                        GetFieldNameValue("DEPT_CD", strDEPT_CD), _
                        GetFieldNameValue("AMT", dblAMT), _
                        GetFieldNameValue("TIM_RATE", dblTIM_RATE), _
                        GetFieldNameValue("TIM_AMT", dblTIM_AMT), _
                        GetFieldNameValue("EX_RATE", dblEX_RATE), _
                        GetFieldNameValue("EX_AMT", dblEX_AMT), _
                        GetFieldNameValue("OCB_RATE", dblOCB_RATE), _
                        GetFieldNameValue("OCB_AMT", dblOCB_AMT), _
                        GetFieldNameValue("KAKAO_AMT", dblKAKAO_AMT), _
                        GetFieldNameValue("MC_AMT", dblMCAMT), _
                        GetFieldNameValue("COMMI_TRANS_NO", strCOMMI_TRANS_NO), _
                        GetFieldNameValue("COMMI_TAX_NO", strCOMMI_TAX_NO), _
                        GetFieldNameValue("COMMI_VOCH_NO", strCOMMI_VOCH_NO), _
                        GetFieldNameValue("CONFIRM_USER", strCONFIRM_USER), _
                        GetFieldNameValue("CONFIRM_DATE", strCONFIRM_DATE), _
                        GetFieldNameValue("MEMO", strMEMO), _
                        GetFieldNameValue("ATTR01", strATTR01), _
                        GetFieldNameValue("ATTR02", strATTR02), _
                        GetFieldNameValue("ATTR03", strATTR03), _
                        GetFieldNameValue("ATTR04", strATTR04), _
                        GetFieldNameValue("ATTR05", strATTR05), _
                        GetFieldNameValue("UUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("UDATE", strNOW)), _
                     BuildFields("AND", _
                        GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ), GetFieldNameValue("CAMPAIGN_CODE", strCAMPAIGN_CODE)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function DeleteDo(Optional ByVal strYEARMON As String = OPTIONAL_STR, _
                             Optional ByVal dblSEQ As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("DELETE FROM {0} WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("YEARMON", strYEARMON), _
                                   GetFieldNameValue("SEQ", dblSEQ)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 신탁테이블의 거래명세삭제시에 commi_trans_no 를 없애준다.
    '*****************************************************************
    Public Function COMMIDeleteUpdateDo(ByVal strTRANSYEARMON As String, _
                                        ByVal strTRANSNO As String) As Integer
        Dim strSQL As String
        Try
            strSQL = strSQL & "  UPDATE MD_POINTAD_AMT "
            strSQL = strSQL & "  SET COMMI_TRANS_NO = '' "
            strSQL = strSQL & "  FROM MD_POINTAD_AMT"
            strSQL = strSQL & "  WHERE YEARMON + '-' + CAST(SEQ AS VARCHAR(10)) IN("
            strSQL = strSQL & "  	SELECT TRUST_YEARMON + '-' + CAST(TRUST_SEQ AS VARCHAR(10))"
            strSQL = strSQL & "  	FROM MD_POINTADCOMMI_DTL "
            strSQL = strSQL & "  	WHERE TRANSYEARMON = '" & strTRANSYEARMON & "'"
            strSQL = strSQL & "  	AND TRANSNO = '" & strTRANSNO & "'"
            strSQL = strSQL & "  )"

            strSQL = strSQL & "  ;UPDATE MD_POINTAD_OUT "
            strSQL = strSQL & "  SET COMMI_TRANS_NO = '' "
            strSQL = strSQL & "  FROM MD_POINTAD_OUT"
            strSQL = strSQL & "  WHERE YEARMON + '-' + CAMPAIGN_CODE IN("
            strSQL = strSQL & "  	SELECT TRUST_YEARMON + '-' + CAMPAIGN_CODE"
            strSQL = strSQL & "  	FROM MD_POINTADCOMMI_DTL "
            strSQL = strSQL & "  	WHERE TRANSYEARMON = '" & strTRANSYEARMON & "'"
            strSQL = strSQL & "  	AND TRANSNO = '" & strTRANSNO & "'"
            strSQL = strSQL & "  )"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".COMMIDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function Update_TruTrans(ByVal strTRUST_YEARMON As String, _
                                    ByVal lngTrust_seq As Double, _
                                    ByVal strTRUTRANS As String, _
                                    ByVal strDEMANDDAY As String, _
                                    ByVal strCAMPAIGN_CODE As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_POINTAD_AMT SET COMMI_TRANS_NO = '" & strTRUTRANS & "' , DEMANDDAY = '" & strDEMANDDAY & "'"
            strSQL = strSQL & " WHERE YEARMON = '" & strTRUST_YEARMON & "' AND SEQ = " & lngTrust_seq

            strSQL = strSQL & " ; UPDATE MD_POINTAD_OUT"
            strSQL = strSQL & "  SET COMMI_TRANS_NO = '" & strTRUTRANS & "' , DEMANDDAY = '" & strDEMANDDAY & "'"
            strSQL = strSQL & " WHERE YEARMON = '" & strTRUST_YEARMON & "' AND CAMPAIGN_CODE = '" & strCAMPAIGN_CODE & "'"

            strSQL = strSQL & " ; UPDATE MD_POINTAD_KAKAO"
            strSQL = strSQL & "  SET DEMANDDAY = '" & strDEMANDDAY & "'"
            strSQL = strSQL & " WHERE YEARMON = '" & strTRUST_YEARMON & "' AND CAMPAIGN_CODE = '" & strCAMPAIGN_CODE & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_TruTrans")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 신탁에 수수료세금계산서 번호 업데이트
    '*****************************************************************
    Public Function Update_CommiTax(ByVal strTRANSNO As String, _
                                    ByVal strTAXNO As String) As Integer
        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_POINTAD_AMT SET COMMI_TAX_NO = '" & strTAXNO & "' "
            strSQL = strSQL & "  WHERE COMMI_TRANS_NO = '" & strTRANSNO & "'"

            strSQL = strSQL & "  ;UPDATE MD_POINTAD_OUT SET COMMI_TAX_NO = '" & strTAXNO & "' "
            strSQL = strSQL & "  WHERE COMMI_TRANS_NO = '" & strTRANSNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_CommiTax")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 신탁테이블의 세금계산서 삭제시 번호 업데이트
    '*****************************************************************
    Public Function CommiTaxDeleteUpdateDo(ByVal strTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_POINTAD_AMT SET COMMI_TAX_NO = '' "
            strSQL = strSQL & "  WHERE COMMI_TAX_NO = '" & strTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".CommiTaxDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 청약 데이터를 확정한다.
    '*****************************************************************
    Public Function Update_confirm(ByVal strYEARMON As String, _
                                   ByVal dblSEQ As Double, _
                                   ByVal strCAMPAIGN_CODE As String, _
                                   ByVal strUSER As String) As Integer
        Dim strSQL As String
        Dim strNOW As String
        strNOW = Now

        Try
            strSQL = "  UPDATE MD_POINTAD_AMT"
            strSQL = strSQL & "  SET CONFIRM_USER = '" & strUSER & "', CONFIRM_DATE = '" & strNOW & "'"
            strSQL = strSQL & "  WHERE YEARMON = '" & strYEARMON & "'"
            strSQL = strSQL & "  AND SEQ = " & dblSEQ
            strSQL = strSQL & "  AND CAMPAIGN_CODE = '" & strCAMPAIGN_CODE & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_confirm")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 청약 데이터를 확정취소한다.
    '*****************************************************************
    Public Function Update_confirmcancel(ByVal strYEARMON As String, _
                                         ByVal dblSEQ As Double, _
                                         ByVal strCAMPAIGN_CODE As String) As Integer
        Dim strSQL As String
        Try
            strSQL = "  UPDATE MD_POINTAD_AMT"
            strSQL = strSQL & "  SET CONFIRM_USER = '', CONFIRM_DATE = ''"
            strSQL = strSQL & "  WHERE YEARMON = '" & strYEARMON & "'"
            strSQL = strSQL & "  AND SEQ = " & dblSEQ
            strSQL = strSQL & "  AND CAMPAIGN_CODE = '" & strCAMPAIGN_CODE & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_confirmcancel")
        End Try
    End Function

#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "MD_POINTAD_AMT"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region
End Class