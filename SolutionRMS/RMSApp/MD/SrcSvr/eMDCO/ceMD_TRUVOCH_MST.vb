'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 엔티티 클래스 메이커 - 한화 S&C
'시스템구분 : 솔루션명/시스템명/Server Entity Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceSC_REALMEDCODE_MST.vb ( SC_REALMEDCODE_MST Entity 처리 Class)
'기      능 : SC_REALMEDCODE_MST Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-01-14 오전 11:09:29 By Making Entity Bean
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceMD_TRUVOCH_MST
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceMD_TRUVOCH_MST"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function InsertDo(Optional ByVal strPOSTINGDATE As String = OPTIONAL_STR, _
                             Optional ByVal strCUSTOMERCODE As String = OPTIONAL_STR, _
                             Optional ByVal strSUMM As String = OPTIONAL_STR, _
                             Optional ByVal strBA As String = OPTIONAL_STR, _
                             Optional ByVal strCOSTCENTER As String = OPTIONAL_STR, _
                             Optional ByVal strSUMAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal strVAT As Double = OPTIONAL_NUM, _
                             Optional ByVal strSEMU As String = OPTIONAL_STR, _
                             Optional ByVal strBP As String = OPTIONAL_STR, _
                             Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
                             Optional ByVal strDUEDATE As String = OPTIONAL_STR, _
                             Optional ByVal strVENDOR As String = OPTIONAL_STR, _
                             Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, _
                             Optional ByVal strTAXNO As Double = OPTIONAL_NUM, _
                             Optional ByVal strGBN As String = OPTIONAL_STR, _
                             Optional ByVal strDEBTOR As String = OPTIONAL_STR, _
                             Optional ByVal strACCOUNT As String = OPTIONAL_STR, _
                             Optional ByVal strDOCUMENTDATE As String = OPTIONAL_STR, _
                             Optional ByVal strPAYCODE As String = OPTIONAL_STR, _
                             Optional ByVal strBANKTYPE As String = OPTIONAL_STR, _
                             Optional ByVal strBMORDER As String = OPTIONAL_STR, _
                             Optional ByVal strPREPAYMENT As String = OPTIONAL_STR, _
                             Optional ByVal strFROMDATE As String = OPTIONAL_STR, _
                             Optional ByVal strTODATE As String = OPTIONAL_STR, _
                             Optional ByVal strSUMMTEXT As String = OPTIONAL_STR, _
                             Optional ByVal strGFLAG As String = OPTIONAL_STR, _
                             Optional ByVal strVOCHNO As String = OPTIONAL_STR, _
                             Optional ByVal strRMSNO As String = OPTIONAL_STR, _
                             Optional ByVal strMEDFLAG As String = OPTIONAL_STR, _
                             Optional ByVal strATTR01 As String = OPTIONAL_STR) As Integer

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            BuildNameValues(",", "POSTINGDATE", strPOSTINGDATE, strFields, strValues)
            BuildNameValues(",", "CUSTOMERCODE", strCUSTOMERCODE, strFields, strValues)
            BuildNameValues(",", "SUMM", strSUMM, strFields, strValues)
            BuildNameValues(",", "BA", strBA, strFields, strValues)
            BuildNameValues(",", "COSTCENTER", strCOSTCENTER, strFields, strValues)
            BuildNameValues(",", "SUMAMT", strSUMAMT, strFields, strValues)
            BuildNameValues(",", "VAT", strVAT, strFields, strValues)
            BuildNameValues(",", "SEMU", strSEMU, strFields, strValues)
            BuildNameValues(",", "BP", strBP, strFields, strValues)
            BuildNameValues(",", "DEMANDDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "DUEDATE", strDUEDATE, strFields, strValues)
            BuildNameValues(",", "VENDOR", strVENDOR, strFields, strValues)
            BuildNameValues(",", "TAXYEARMON", strTAXYEARMON, strFields, strValues)
            BuildNameValues(",", "TAXNO", strTAXNO, strFields, strValues)
            BuildNameValues(",", "GBN", strGBN, strFields, strValues)
            BuildNameValues(",", "DEBTOR", strDEBTOR, strFields, strValues)
            BuildNameValues(",", "ACCOUNT", strACCOUNT, strFields, strValues)
            BuildNameValues(",", "DOCUMENTDATE", strDOCUMENTDATE, strFields, strValues)
            BuildNameValues(",", "PAYCODE", strPAYCODE, strFields, strValues)
            BuildNameValues(",", "BANKTYPE", strBANKTYPE, strFields, strValues)
            BuildNameValues(",", "BMORDER", strBMORDER, strFields, strValues)
            BuildNameValues(",", "PREPAYMENT", strPREPAYMENT, strFields, strValues)
            BuildNameValues(",", "FROMDATE", strFROMDATE, strFields, strValues)
            BuildNameValues(",", "TODATE", strTODATE, strFields, strValues)
            BuildNameValues(",", "SUMMTEXT", strSUMMTEXT, strFields, strValues)
            BuildNameValues(",", "GFLAG", strGFLAG, strFields, strValues)
            BuildNameValues(",", "VOCHNO", strVOCHNO, strFields, strValues)
            BuildNameValues(",", "RMSNO", strRMSNO, strFields, strValues)
            BuildNameValues(",", "MEDFLAG", strMEDFLAG, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)
            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function


    Public Function UpdateRtn_VOCHNO(ByVal strGBN As String, _
                                     ByVal strMEDFLAG As String, _
                                     ByVal strTAXYEARMON As String, _
                                     ByVal intTAXNO As Integer, _
                                     ByVal strDOC_STATUS As String, _
                                     ByVal strDOC_MESSAGE As String, _
                                     ByVal strVOCHNO As String, _
                                     ByVal strIF_KEY As String) As Integer
        Dim strSQL As String
        Try

            '위수탁 전표 업데이트
            If strGBN = "T" Then
                If strMEDFLAG = "B" Then '위수탁 인쇄 전표
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                Else
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If
            '일반 전표 업데이트
            If strGBN = "D" Then
                If strMEDFLAG = "O" Then '인터넷 일반 매출
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('OA','OB','OC') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "OAA" Then '인터넷 일반 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('OAA','OBB') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "OD" Then '인터넷 일반 매출
                    'strSQL = "UPDATE MD_TRUVOCH_MST "
                    'strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    'strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('OD') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO

                    strSQL = " UPDATE A"
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " FROM MD_TRUVOCH_MST A LEFT JOIN MD_TRUTAXGENERAL_HDR B"
                    strSQL = strSQL & " ON A.TAXYEARMON = B.TAXYEARMON AND A.TAXNO = B.TAXNO "
                    strSQL = strSQL & " WHERE GBN = 'O' AND A.MEDFLAG IN ('OD') AND  A.TAXYEARMON = '" & strTAXYEARMON & "' AND A.TAXNO = " & intTAXNO
                    strSQL = strSQL & " AND CAST(ISNULL(A.ATTR01,0) AS NUMERIC) = B.SEQ"
                End If

                If strMEDFLAG = "A2" Then '케이블 일반 매출
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('A2A','A2B','A2C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A2AA" Then '케이블 일반 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('A2AA','A2BB') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A2D" Then '케이블 대대행 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('A2D') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "T" Then '종합편성방송 일반 매출
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('TA','TB','TC') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "TAA" Then '종합편성방송 일반 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('TAA','TBB') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "TD" Then '종합편성방송 대대행 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('TD') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "B" Then '인쇄 일반 매출
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('BA','BB','BC') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "BAA" Then '인쇄 일반 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('BAA','BBB') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "BD" Then '인쇄 대대행 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('BD') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "LA" Then '라이나 일반매출
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'D' AND MEDFLAG IN ('LAA','LAB') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If


            End If
            '수수료 전표 업데이트
            If strGBN = "S" Then
                If strMEDFLAG = "D" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('D') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "O" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('O') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A2" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('A2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('A') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "G" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('G') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "T" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('T') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "K" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('K') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "Y" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('Y') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            'IFCMALL 대행매출
            If strGBN = "YO3" Then
                If strMEDFLAG = "YO3" Then
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'YO3' AND MEDFLAG IN ('YO3') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            '매입 전표 업데이트
            If strGBN = "O" Then
                If strMEDFLAG = "D2" Then '옥외매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND MEDFLAG IN ('D2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "O2" Then '인터넷 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('O2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A22" Then '케이블 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('A22') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "T2" Then '종합편성방송 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('T2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "B2" Then '인쇄 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('B2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "AE2" Then '공중파 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('AE2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "OUTALL" Then '전체 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' and RMSNO = 'ALL' AND MEDFLAG IN ('AE2', 'B22', 'A22','T2','D22') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "TO" Then
                If strMEDFLAG = "AAAO" Then '공중파 취급액 MC내부 비용매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'TO' AND MEDFLAG IN ('AAAO','ABBO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "BAO" Then '인쇄 취급액 MC내부 비용매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'TO' AND MEDFLAG IN ('BAO','BBO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "A2AO" Then '케이블 취급액 MC내부 비용매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'TO' AND MEDFLAG IN ('A2AO','A2BO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If

                If strMEDFLAG = "OAO" Then '케이블 취급액 MC내부 비용매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'TO' AND MEDFLAG IN ('OAO','OBO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "SO" Then
                If strMEDFLAG = "DSO" Then '케이블 취급액 MC내부 비용매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'SO' AND MEDFLAG IN ('DSO','DSBO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "GO" Then
                If strMEDFLAG = "GO" Then 'CGV 대행 수수료
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('GO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "KO" Then
                If strMEDFLAG = "KO" Then 'POINT 친구 AD 대행 수수료
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('KO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "GO2" Then
                If strMEDFLAG = "GO2" Then 'CGV 매입전표
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('GO2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "KO2" Then
                If strMEDFLAG = "KO2" Then 'KAKAO 매입전표
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('KO2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "L" Then
                If strMEDFLAG = "L2" Then '공중파 가상/간접광고 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('L2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "YO" Then
                If strMEDFLAG = "YO" Then 'IFC MALL 매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('YO') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "YO2" Then
                If strMEDFLAG = "YO2" Then 'IFC MALL 대행매입
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('YO2') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            If strGBN = "YS" Then
                If strMEDFLAG = "YS" Then 'IFC MALL 매입 수수료
                    strSQL = "UPDATE MD_TRUVOCH_MST "
                    strSQL = strSQL & " SET VOCHNO = '" & strVOCHNO & "', ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "', IF_GUBUN ='" & strIF_KEY & "'"
                    strSQL = strSQL & " WHERE GBN = 'O' AND MEDFLAG IN ('YS') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO
                End If
            End If

            '오류전표 아닌것만 세금계산서및 신탁 업데이트 시작
            If strDOC_STATUS = "" Then
                '매출
                '======================================================================== ======================================
                If strGBN = "T" Then
                    If strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag in ('B','C') "
                    Else
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = ''  and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = '" & strMEDFLAG & "' "
                    End If

                    '청약에 전표번호 업데이트
                    If strMEDFLAG = "A" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_electric_medium a , "
                        strSQL = strSQL & " (   select taxyearmon, taxno, vochno  "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST  "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "A2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_catv_medium a , "
                        strSQL = strSQL & " (   select taxyearmon, taxno, vochno  "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST  "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "T" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_TOTAL_medium a , "
                        strSQL = strSQL & " (   select taxyearmon, taxno, vochno  "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST  "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_booking_medium a , "
                        strSQL = strSQL & " (   select taxyearmon, taxno, vochno  "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST  "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "O" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_internet_medium a , "
                        strSQL = strSQL & " (   select taxyearmon, taxno, vochno  "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST  "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'T' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If
                End If

                '수수료
                '==============================================================================================================
                If strGBN = "S" Then
                    If strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_commitax_hdr a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'S' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag in('B','C') "
                    Else
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_commitax_hdr a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'S' and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = '" & strMEDFLAG & "' "
                    End If

                    If strMEDFLAG = "A" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_electric_medium a,    "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' "
                        strSQL = strSQL & "     and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "A2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_catv_medium a,    "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' "
                        strSQL = strSQL & "     and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "T" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_TOTAL_medium a,    "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' "
                        strSQL = strSQL & "     and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_booking_medium a,    "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' "
                        strSQL = strSQL & "     and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "O" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_internet_medium a,    "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' "
                        strSQL = strSQL & "     and  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "D" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_outdoor_medium a,   "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST"
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "G" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.commi_voch_no = b.vochno "
                        strSQL = strSQL & " from md_cloud_amt a,   "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST"
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_cloud_out a,   "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST"
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and gbn = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) b"
                        strSQL = strSQL & " where a.commi_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10)) "
                    ElseIf strMEDFLAG = "K" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.COMMI_VOCH_NO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_POINTAD_AMT A,   "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & "  SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & "  FROM MD_TRUVOCH_MST"
                        strSQL = strSQL & "  WHERE ISNULL(ERRCODE,'') = '' AND GBN = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) B"
                        strSQL = strSQL & " WHERE A.COMMI_TAX_NO = B.TAXYEARMON +'-' + CAST(CAST(B.TAXNO AS NUMERIC) AS VARCHAR(10)) "
                        strSQL = strSQL & " "
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_POINTAD_OUT A,   "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST"
                        strSQL = strSQL & " 	WHERE ISNULL(ERRCODE,'') = '' AND GBN = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) B"
                        strSQL = strSQL & " WHERE A.COMMI_TAX_NO = B.TAXYEARMON +'-' + CAST(CAST(B.TAXNO AS NUMERIC) AS VARCHAR(10)) "
                    ElseIf strMEDFLAG = "Y" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.COMMI_VOCH_NO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_IFCMALL_AMT A,   "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & "  SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & "  FROM MD_TRUVOCH_MST"
                        strSQL = strSQL & "  WHERE ISNULL(ERRCODE,'') = '' AND GBN = 'S' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) B"
                        strSQL = strSQL & " WHERE A.COMMI_TAX_NO = B.TAXYEARMON +'-' + CAST(CAST(B.TAXNO AS NUMERIC) AS VARCHAR(10)) "
                    End If
                End If

                If strGBN = "YO3" Then
                    If strMEDFLAG = "YO3" Then

                        strSQL = strSQL & " ;UPDATE A SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_COMMITAX_HDR A, (SELECT TAXYEARMON,TAXNO,VOCHNO FROM MD_TRUVOCH_MST WHERE ISNULL(ERRCODE,'') = '' AND GBN = 'YO3' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") B "
                        strSQL = strSQL & " WHERE A.TAXYEARMON = B.TAXYEARMON AND A.TAXNO = B.TAXNO AND A.MEDFLAG = 'Y' "

                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_IFCMALL_OUT A,   "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & "  SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & "  FROM MD_TRUVOCH_MST"
                        strSQL = strSQL & "  WHERE ISNULL(ERRCODE,'') = '' AND GBN = 'YO3' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " ) B"
                        strSQL = strSQL & " WHERE A.COMMI_TAX_NO = B.TAXYEARMON +'-' + CAST(CAST(B.TAXNO AS NUMERIC) AS VARCHAR(10)) "
                    End If
                End If

                '매입
                '==============================================================================================================
                If strGBN = "O" Then
                    '옥외매입
                    If strMEDFLAG = "D2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_outdoor_medium a,  "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'D2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon and cast(b.taxno as numeric) = a.seq "
                    End If

                    If strMEDFLAG = "O2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_INTERNET_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'O2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and a.SEQ = b.taxno "
                    End If

                    If strMEDFLAG = "A22" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_CATV_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'A22' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.seq,0) = b.taxno "
                    End If

                    If strMEDFLAG = "T2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_TOTAL_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'T2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and a.seq = b.taxno "
                    End If

                    If strMEDFLAG = "B2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_BOOKING_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'B2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and a.SEQ = b.taxno "
                    End If

                    If strMEDFLAG = "AE2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_ELECTRIC_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'AE2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.ATTR06,0) = b.taxno "
                    End If

                    If strMEDFLAG = "OUTALL" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_ELECTRIC_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'AE2' and RMSNO = 'ALL' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.ATTR06,0) = b.taxno "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_BOOKING_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'B22' and RMSNO = 'ALL' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.ATTR06,0) = b.taxno "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_CATV_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'A22' and RMSNO = 'ALL' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.ATTR06,0) = b.taxno "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.ex_voch_no = b.VOCHNO "
                        strSQL = strSQL & " from MD_TOTAL_MEDIUM a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'T2' and RMSNO = 'ALL' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and ISNULL(a.ATTR06,0) = b.taxno "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_outdoor_medium a,  "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'D22' and RMSNO = 'ALL' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon and cast(b.taxno as numeric) = a.seq "
                    End If
                End If

                If strGBN = "L" Then
                    If strMEDFLAG = "L2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.EX_VOCH_NO = b.VOCHNO "
                        strSQL = strSQL & " from MD_ELECTRIC_PPL a,   "
                        strSQL = strSQL & " (   select taxyearmon, taxno, VOCHNO "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'L2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon  and a.SEQ = b.taxno "
                    End If
                End If

                '일반
                '==============================================================================================================
                If strGBN = "D" Then
                    If strMEDFLAG = "O" Then
                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OC' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_internet_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "

                    ElseIf strMEDFLAG = "OAA" Then
                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OBB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        '인터넷 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'O' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_internet_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='OAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "

                    ElseIf strMEDFLAG = "A2AA" Then
                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2AA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2BB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2AA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_CATV_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2AA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "

                    ElseIf strMEDFLAG = "TAA" Then
                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='TAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='TBB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='TAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_TOTAL_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='TAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "

                    ElseIf strMEDFLAG = "BAA" Then
                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BBB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_BOOKING_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BAA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BB' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BC' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_booking_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='BA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "A2" Then
                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2A' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2B' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2C' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'A2' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_catv_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2A' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "T" Then
                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2A' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxgeneral_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2B' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        '케이블 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutaxoutlist_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='A2C' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag = 'T' "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_TOTAL_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'D' and medflag='TA' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    ElseIf strMEDFLAG = "OD" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.buy_voch_no = b.vochno "
                        strSQL = strSQL & " from MD_TRUTAXGENERAL_HDR a, (select taxyearmon,taxno,vochno, cast(case ATTR01 when '' then 0 else ATTR01 end as numeric) ATTR01 from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'O' and medflag = 'OD' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon  and a.taxno = b.taxno and a.seq = b.ATTR01 "
                    ElseIf strMEDFLAG = "BD" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.buy_voch_no = b.vochno "
                        strSQL = strSQL & " from MD_TRUTAXGENERAL_HDR a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'O' and medflag = 'BD' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon  and a.taxno = b.taxno "
                    ElseIf strMEDFLAG = "A2D" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.buy_voch_no = b.vochno "
                        strSQL = strSQL & " from MD_TRUTAXGENERAL_HDR a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'O' and medflag = 'A2D' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon  and a.taxno = b.taxno "
                    ElseIf strMEDFLAG = "TD" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.buy_voch_no = b.vochno "
                        strSQL = strSQL & " from MD_TRUTAXGENERAL_HDR a, (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'O' and medflag = 'TD' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon  and a.taxno = b.taxno "

                        '라이나생명 일반 매출
                    ElseIf strMEDFLAG = "LA" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_MMP_MEDIUM A, "
                        strSQL = strSQL & " 	("
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & " 	WHERE ISNULL(ERRCODE,'') = '' "
                        strSQL = strSQL & " 	AND GBN = 'D' "
                        strSQL = strSQL & " 	AND MEDFLAG IN ('LAA','LAB') "
                        strSQL = strSQL & " 	AND TAXYEARMON = '" & strTAXYEARMON & "' "
                        strSQL = strSQL & " 	AND TAXNO =  '" & intTAXNO & "' "
                        strSQL = strSQL & " 	) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON  AND A.SEQ = B.TAXNO "

                    End If

                End If

                If strGBN = "TO" Then
                    If strMEDFLAG = "AAAO" Then
                        '공중파 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='AAAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('A') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_ELECTRIC_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='AAAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If

                    If strMEDFLAG = "BAO" Then
                        '인쇄 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='BAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('B','C') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_BOOKING_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='BAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If

                    If strMEDFLAG = "A2AO" Then
                        '공중파 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='A2AO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('A2') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_CATV_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='A2AO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If

                    If strMEDFLAG = "OAO" Then
                        '공중파 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_trutax_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='OAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('O') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.tru_voch_no = b.vochno "
                        strSQL = strSQL & " from md_INTERNET_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'TO' and medflag='OAO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.tru_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If
                End If

                If strGBN = "SO" Then
                    If strMEDFLAG = "DSO" Then
                        '공중파 일반
                        strSQL = strSQL & " ;update a set a.vochno = b.vochno "
                        strSQL = strSQL & " from md_COMMITAX_hdr a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'SO' and medflag='DSO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.taxyearmon = b.taxyearmon and a.taxno = b.taxno and a.medflag IN('D') "

                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.COMMI_voch_no = b.vochno "
                        strSQL = strSQL & " from md_OUTDOOR_medium a, "
                        strSQL = strSQL & " (select taxyearmon,taxno,vochno from MD_TRUVOCH_MST where ISNULL(errcode,'') = '' and gbn = 'SO' and medflag='DSO' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & ") b "
                        strSQL = strSQL & " where a.COMMI_tax_no = b.taxyearmon +'-' + CAST(cast(b.taxno as numeric) as varchar(10))  "
                    End If
                End If

                If strGBN = "GO" Then
                    If strMEDFLAG = "GO" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.EX_voch_no = b.vochno "
                        strSQL = strSQL & " from MD_CLOUD_OUT a,  "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'GO' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon and cast(b.taxno as numeric) = a.seq "
                    End If
                End If

                If strGBN = "GO2" Then
                    If strMEDFLAG = "GO2" Then
                        strSQL = strSQL & " ;update a "
                        strSQL = strSQL & " set a.vochno = b.vochno "
                        strSQL = strSQL & " from MD_CLOUD_CGV a,  "
                        strSQL = strSQL & " (   select taxyearmon,taxno,vochno "
                        strSQL = strSQL & "     from MD_TRUVOCH_MST "
                        strSQL = strSQL & "     where ISNULL(errcode,'') = '' and TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & "     and gbn = 'O' and medflag = 'GO2' "
                        strSQL = strSQL & " ) b "
                        strSQL = strSQL & " where a.yearmon = b.taxyearmon and cast(b.taxno as numeric) = a.seq "
                    End If
                End If

                If strGBN = "KO" Then
                    If strMEDFLAG = "KO" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.EX_VOCH_NO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_POINTAD_OUT A,  "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & "     WHERE ISNULL(ERRCODE,'') = '' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " 	AND GBN = 'O' AND MEDFLAG = 'KO' "
                        strSQL = strSQL & " ) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON AND CAST(B.TAXNO AS NUMERIC) = A.SEQ "
                    End If
                End If

                If strGBN = "KO2" Then
                    If strMEDFLAG = "KO2" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_POINTAD_KAKAO A,  "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & "     WHERE ISNULL(ERRCODE,'') = '' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " 	AND GBN = 'O' AND MEDFLAG = 'KO2' "
                        strSQL = strSQL & " ) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON AND CAST(B.TAXNO AS NUMERIC) = A.SEQ "
                    End If
                End If

                If strGBN = "YO" Then
                    If strMEDFLAG = "YO" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.EX_VOCH_NO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_IFCMALL_AMT A,  "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & "     WHERE ISNULL(ERRCODE,'') = '' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " 	AND GBN = 'O' AND MEDFLAG = 'YO' "
                        strSQL = strSQL & " ) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON AND CAST(B.TAXNO AS NUMERIC) = A.SEQ "
                    End If
                End If

                If strGBN = "YO2" Then
                    If strMEDFLAG = "YO2" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_IFCMALL_OUT A,  "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & "     WHERE ISNULL(ERRCODE,'') = '' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " 	AND GBN = 'O' AND MEDFLAG = 'YO2' "
                        strSQL = strSQL & " ) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON AND CAST(B.TAXNO AS NUMERIC) = A.SEQ "
                    End If
                End If

                If strGBN = "YS" Then
                    If strMEDFLAG = "YS" Then
                        strSQL = strSQL & " ;UPDATE A "
                        strSQL = strSQL & " SET A.VOCHNO = B.VOCHNO "
                        strSQL = strSQL & " FROM MD_IFCMALL_SUSU A,  "
                        strSQL = strSQL & " (   "
                        strSQL = strSQL & " 	SELECT TAXYEARMON,TAXNO,VOCHNO "
                        strSQL = strSQL & " 	FROM MD_TRUVOCH_MST "
                        strSQL = strSQL & "     WHERE ISNULL(ERRCODE,'') = '' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " "
                        strSQL = strSQL & " 	AND GBN = 'O' AND MEDFLAG = 'YS' "
                        strSQL = strSQL & " ) B "
                        strSQL = strSQL & " WHERE A.YEARMON = B.TAXYEARMON AND CAST(B.TAXNO AS NUMERIC) = A.SEQ "
                    End If
                End If
            End If
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_VOCHNO")
        End Try
    End Function

    Public Function UpdateRtn_DELETEERR(ByVal strGBN As String, _
                                        ByVal strTAXYEARMON As String, _
                                        ByVal intTAXNO As Integer, _
                                        ByVal strDOC_STATUS As String, _
                                        ByVal strDOC_MESSAGE As String, _
                                        ByVal strVOCHNO As String) As Integer
        Dim strSQL As String
        Try
            '전표업데이트 시작
            strSQL = "UPDATE MD_TRUVOCH_MST "
            strSQL = strSQL & " SET ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "'"
            strSQL = strSQL & " WHERE GBN = '" & strGBN & "' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " AND VOCHNO = '" & strVOCHNO & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_DELETEERR")
        End Try
    End Function

    Public Function UpdateRtn_DELETEERR_BUY(ByVal strGBN As String, _
                                            ByVal strTAXYEARMON As String, _
                                            ByVal intTAXNO As Integer, _
                                            ByVal strDOC_STATUS As String, _
                                            ByVal strDOC_MESSAGE As String, _
                                            ByVal strVOCHNO As String) As Integer
        Dim strSQL As String
        Try
            '전표업데이트 시작
            strSQL = "UPDATE MD_TRUVOCH_MST "
            strSQL = strSQL & " SET ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "'"
            strSQL = strSQL & " WHERE GBN = 'O' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " AND BUY_VOCH_NO = '" & strVOCHNO & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_DELETEERR")
        End Try
    End Function

    Public Function UpdateRtn_DELETEERR_BUYALL(ByVal strGBN As String, _
                                               ByVal strTAXYEARMON As String, _
                                               ByVal intTAXNO As Integer, _
                                               ByVal strDOC_STATUS As String, _
                                               ByVal strDOC_MESSAGE As String, _
                                               ByVal strVOCHNO As String) As Integer
        Dim strSQL As String
        Try
            '전표업데이트 시작
            strSQL = "UPDATE MD_TRUVOCH_MST "
            strSQL = strSQL & " SET ERRCODE = '" & strDOC_STATUS & "', ERRMSG = '" & strDOC_MESSAGE & "'"
            strSQL = strSQL & " WHERE GBN = 'O' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = " & intTAXNO & " AND VOCHNO = '" & strVOCHNO & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_DELETEERR")
        End Try
    End Function

    Public Function Delete_vochno(ByVal strTAXYEARMON As String, _
                                  ByVal strVOCHNO As String, _
                                  ByVal strGBN As String) As Integer
        Dim strSQL As String
        Try

            strSQL = "DELETE FROM MD_TRUVOCH_MST "
            strSQL = strSQL & " WHERE TAXYEARMON ='" & strTAXYEARMON & "' "
            strSQL = strSQL & " AND ISNULL(GBN,'') = '" & strGBN & "'"
            strSQL = strSQL & " AND VOCHNO = '" & strVOCHNO & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete_vochno")
        End Try
    End Function

    Public Function UpdateDelete(ByVal strTAXYEARMON As String, _
                                 ByVal strTAXNO As Integer, _
                                 ByVal strMEDFLAG As String, _
                                 ByVal strGBN As String) As Integer
        Dim strSQL As String
        Try

            'A0 매입은 청약데이터로 하기때문에 여기서    업데이트하지않는다. (UpdateDelete는 세금계산서 VOCHONO업데이트)
            strSQL = ""

            If strMEDFLAG = "CATV" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "T" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "D" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "TOTAL" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "T" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "D" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "PRINT" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "T" Or strGBN = "TO" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "D" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "INTERNET" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "T" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "D" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "ELEC" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "T" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "TO" Then
                    strSQL = "UPDATE MD_TRUTAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "OUTDOOR" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='D' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "SO" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='D' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "CGV" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='G' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "POINTAD" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='K' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "IFCMALL" Then
                If strGBN = "S" Or strGBN = "YO3" Then
                    strSQL = "UPDATE MD_COMMITAX_HDR SET VOCHNO ='' WHERE ISNULL(MEDFLAG,'') ='Y' AND TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                End If
            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDelete")
        End Try
    End Function

    Public Function Update_vochno(ByVal strTAXYEARMON As String, _
                                  ByVal strTAXNO As Integer, _
                                  ByVal strMEDFLAG As String, _
                                  ByVal strGBN As String) As Integer
        Dim strSQL As String
        Try
            If strMEDFLAG = "CATV" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_CATV_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_CATV_MEDIUM SET TRU_VOCH_NO ='' WHERE TRU_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "TOTAL" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_TOTAL_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_TOTAL_MEDIUM SET TRU_VOCH_NO ='' WHERE TRU_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "PRINT" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_BOOKING_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_BOOKING_MEDIUM SET TRU_VOCH_NO ='' WHERE TRU_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "INTERNET" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_INTERNET_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_INTERNET_MEDIUM SET TRU_VOCH_NO ='' WHERE TRU_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "ELEC" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_ELECTRIC_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_ELECTRIC_MEDIUM SET TRU_VOCH_NO ='' WHERE TRU_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "OUTDOOR" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_OUTDOOR_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                ElseIf strGBN = "SO" Then
                    strSQL = "UPDATE MD_OUTDOOR_MEDIUM SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                Else
                    strSQL = "UPDATE MD_OUTDOOR_MEDIUM SET TRU_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                End If
            ElseIf strMEDFLAG = "CGV" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_CLOUD_AMT SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                ElseIf strGBN = "GO" Then
                    strSQL = "UPDATE MD_CLOUD_OUT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                ElseIf strGBN = "GO2" Then
                    strSQL = "UPDATE MD_CLOUD_CGV SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                End If

            ElseIf strMEDFLAG = "POINTAD" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_POINTAD_AMT SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                ElseIf strGBN = "KO" Then
                    strSQL = "UPDATE MD_POINTAD_OUT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                ElseIf strGBN = "KO2" Then
                    strSQL = "UPDATE MD_POINTAD_KAKAO SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                End If

            ElseIf strMEDFLAG = "IFCMALL" Then
                If strGBN = "S" Then
                    strSQL = "UPDATE MD_IFCMALL_AMT SET COMMI_VOCH_NO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                ElseIf strGBN = "YO" Then
                    strSQL = "UPDATE MD_IFCMALL_AMT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                ElseIf strGBN = "YO2" Then
                    strSQL = "UPDATE MD_IFCMALL_OUT SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                ElseIf strGBN = "YO3" Then
                    strSQL = "UPDATE MD_IFCMALL_OUT SET VOCHNO ='' WHERE COMMI_TAX_NO = '" & strTAXYEARMON & "-" & strTAXNO & "'"
                ElseIf strGBN = "YS" Then
                    strSQL = "UPDATE MD_IFCMALL_SUSU SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ =" & strTAXNO & ""
                End If

                '라이나생명 MMP 매출 전표번호 삭제
            ElseIf strMEDFLAG = "LA" Then
                If strGBN = "D" Then
                    strSQL = strSQL & " UPDATE MD_MMP_MEDIUM SET VOCHNO = '' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_vochno")
        End Try
    End Function

    '일반 매입에 대한 삭제 처리
    Public Function Delete_vochno_BUY(ByVal strTAXYEARMON As String, _
                                      ByVal strVOCHNO As String, _
                                      ByVal strGBN As String, _
                                      ByVal strFLAG As String) As Integer
        Dim strSQL As String
        Try

            If strFLAG = "OUTALL" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' "
                strSQL = strSQL & " AND ISNULL(GBN,'') = 'O' AND MEDFLAG IN ('AE2', 'B22', 'A22','D22','T2') "
                strSQL = strSQL & " AND vochno = '" & strVOCHNO & "'"
                strSQL = strSQL & " AND ISNULL(RMSNO,'') = 'ALL'"
            ElseIf strFLAG = "L2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' "
                strSQL = strSQL & " AND ISNULL(GBN,'') = 'O' AND MEDFLAG = '" & strFLAG & "'"
                strSQL = strSQL & " AND vochno = '" & strVOCHNO & "'"
            Else
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' "
                strSQL = strSQL & " AND ISNULL(GBN,'') = 'O' AND MEDFLAG = '" & strFLAG & "'"
                strSQL = strSQL & " AND vochno = '" & strVOCHNO & "'"
            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete_vochno")
        End Try
    End Function

    Public Function UpdateDelete_BUY(ByVal strTAXYEARMON As String, _
                                     ByVal strTAXNO As Integer, _
                                     ByVal strMEDFLAG As String, _
                                     ByVal strGBN As String, _
                                     ByVal strFLAG As String) As Integer
        Dim strSQL As String
        Try
            'A0 매입은 청약데이터로 하기때문에 여기서    업데이트하지않는다. (UpdateDelete는 세금계산서 VOCHONO업데이트)
            strSQL = ""
            If strMEDFLAG = "CATV" Then
                If strGBN = "D" Then
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET BUY_VOCH_NO ='' WHERE ISNULL(MEDFLAG,'') ='A2' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_CATV_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "TOTAL" Then
                If strGBN = "D" Then
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET BUY_VOCH_NO ='' WHERE ISNULL(MEDFLAG,'') ='T' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_TOTAL_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "PRINT" Then
                If strGBN = "D" Then
                    strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET BUY_VOCH_NO ='' WHERE ISNULL(MEDFLAG,'') IN ('B','C') AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_BOOKING_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "INTERNET" Then
                If strGBN = "D" Then
                    If strFLAG = "OD" Then

                    Else
                        strSQL = strSQL & ";UPDATE MD_TRUTAXGENERAL_HDR SET BUY_VOCH_NO ='' WHERE ISNULL(MEDFLAG,'') ='O' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                    End If

                ElseIf strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_INTERNET_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "ELEC" Then
                If strGBN = "D" Then
                    strSQL = strSQL & ";UPDATE MD_TRUTAXOUTLIST_HDR SET BUY_VOCH_NO ='' WHERE ISNULL(MEDFLAG,'') ='A' AND  TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & strTAXNO & "'"
                ElseIf strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_ELECTRIC_MEDIUM SET EX_VOCH_NO ='', ATTR06 = NULL WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                ElseIf strGBN = "L" Then
                    strSQL = strSQL & ";UPDATE MD_ELECTRIC_PPL SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "OUT" Then
                If strGBN = "O" Then
                    strSQL = strSQL & ";UPDATE MD_ELECTRIC_MEDIUM SET EX_VOCH_NO ='', ATTR06 = NULL WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_CATV_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_TOTAL_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_BOOKING_MEDIUM SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                    strSQL = strSQL & ";UPDATE MD_OUTDOOR_MEDIUM SET TRU_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "' AND PORTAL_SEQ = '1' "
                End If
            ElseIf strMEDFLAG = "CGV" Then
                If strGBN = "GO" Then
                    strSQL = strSQL & ";UPDATE MD_CLOUD_OUT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If

                If strGBN = "GO2" Then
                    strSQL = strSQL & ";UPDATE MD_CLOUD_CGV SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If

            ElseIf strMEDFLAG = "POINTAD" Then
                If strGBN = "KO" Then
                    strSQL = strSQL & ";UPDATE MD_POINTAD_OUT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If

                If strGBN = "KO2" Then
                    strSQL = strSQL & ";UPDATE MD_POINTAD_KAKAO SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If
            ElseIf strMEDFLAG = "IFCMALL" Then
                If strGBN = "YO" Then
                    strSQL = strSQL & ";UPDATE MD_IFCMALL_AMT SET EX_VOCH_NO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If

                If strGBN = "YO2" Then
                    strSQL = strSQL & ";UPDATE MD_IFCMALL_OUT SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If

                If strGBN = "YS" Then
                    strSQL = strSQL & ";UPDATE MD_IFCMALL_SUSU SET VOCHNO ='' WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                End If
            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDelete")
        End Try
    End Function

    Public Function Delete_ERR(ByVal strTAXYEARMON As String, _
                               ByVal strTAXNO As String, _
                               ByVal strGBN As String, _
                               ByVal strMEDFLAG As String) As Integer
        Dim strSQL As String

        Try
            If strMEDFLAG = "OA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('OA','OB','OC') AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('OA','OB','OC') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "A2A" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('A2A','A2B','A2C')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('A2A','A2B','A2C') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "TA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('TA','TB','TC')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('TA','TB','TC') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "BA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('BA','BB','BC')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('BA','BB','BC) AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "OAA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('OAA','OBB')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('OAA','OBB') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "A2AA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('A2AA','A2BB')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('A2AA','A2BB') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "TAA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('TAA','TBB')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('TAA','TBB') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "BAA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('BAA','BBB')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('BAA','BBB') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "AAAO" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('AAAO','ABBO')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('AAAO','ABBO') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "AE2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"

                strSQL = strSQL & "  ; UPDATE MD_ELECTRIC_MEDIUM"
                strSQL = strSQL & "  SET ATTR06 = NULL "
                strSQL = strSQL & "  WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                strSQL = strSQL & "  AND ISNULL(EX_VOCH_NO,'') = ''"
            ElseIf strMEDFLAG = "A22" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"

                strSQL = strSQL & "  ; UPDATE MD_CATV_MEDIUM"
                strSQL = strSQL & "  SET ATTR06 = NULL "
                strSQL = strSQL & "  WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                strSQL = strSQL & "  AND ISNULL(EX_VOCH_NO,'') = ''"
            ElseIf strMEDFLAG = "T2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "B2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"

                strSQL = strSQL & "  ; UPDATE MD_BOOKING_MEDIUM"
                strSQL = strSQL & "  SET ATTR06 = NULL "
                strSQL = strSQL & "  WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(ATTR06,0) = '" & strTAXNO & "'"
                strSQL = strSQL & "  AND ISNULL(EX_VOCH_NO,'') = ''"
            ElseIf strMEDFLAG = "D2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"

                strSQL = strSQL & "  ; UPDATE MD_OUTDOOR_MEDIUM"
                strSQL = strSQL & "  SET ATTR06 = NULL "
                strSQL = strSQL & "  WHERE YEARMON = '" & strTAXYEARMON & "' AND ISNULL(SEQ,0) = '" & strTAXNO & "'"
                strSQL = strSQL & "  AND ISNULL(TRU_VOCH_NO,'') = ''"
            ElseIf strMEDFLAG = "DSO" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('DSO','DSBO')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('DSO','DSBO') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "L2" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('L2')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('L2') AND ISNULL(VOCHNO,'') <> ''"
            ElseIf strMEDFLAG = "LA" Then
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG IN('LAA','LAB')  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG IN('LAA','LAB') AND ISNULL(VOCHNO,'') <> ''"
            Else
                strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE TAXYEARMON ='" & strTAXYEARMON & "' AND TAXNO ='" & strTAXNO & "' AND GBN ='" & strGBN & "' AND MEDFLAG = '" & strMEDFLAG & "'  AND ISNULL(VOCHNO,'') = ''"
                strSQL = strSQL & "  ; UPDATE MD_TRUVOCH_MST"
                strSQL = strSQL & "  SET ERRCODE = 0, ERRMSG = ''"
                strSQL = strSQL & "  WHERE TAXYEARMON ='" & strTAXYEARMON & "'"
                strSQL = strSQL & "  AND TAXNO ='" & strTAXNO & "'"
                strSQL = strSQL & "  AND GBN ='" & strGBN & "'"
                strSQL = strSQL & "  AND MEDFLAG = '" & strMEDFLAG & "' AND ISNULL(VOCHNO,'') <> ''"
            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete_ERR")
        End Try
    End Function
    '============================================================================================================================================================
    '============================================================================================================================================================
    '============================================================================================================================================================
    Public Function DeleteDo(Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, _
                             Optional ByVal strTAXNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String
        Try
            strSQL = "DELETE FROM  MD_TRUVOCH_MST WHERE TAXYEARMON='" & strTAXYEARMON & "' AND TAXNO =" & strTAXNO

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function


    Public Function DeleteDo_RMSNO(Optional ByVal strRMSNO As String = OPTIONAL_STR) As Integer
        Dim strSQL As String
        Try
            strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE RMSNO ='" & strRMSNO & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function


    Public Function DeleteDo_RMSNO_MEDFLAG(Optional ByVal strRMSNO As String = OPTIONAL_STR, _
                                           Optional ByVal strMEDFLAG As String = OPTIONAL_STR) As Integer
        Dim strSQL As String
        Try
            strSQL = "DELETE FROM MD_TRUVOCH_MST WHERE RMSNO ='" & strRMSNO & "' AND MEDFLAG ='" & strMEDFLAG & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function

    Public Function DeleteDo_FEE(Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, _
                                 Optional ByVal strTAXNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String
        Try

            strSQL = "DELETE FROM  MD_TRUVOCH_MST WHERE substring(RMSNO, 12, 1) = 'F' AND TAXYEARMON='" & strTAXYEARMON & "' AND TAXNO =" & strTAXNO

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete")
        End Try
    End Function

#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "MD_TRUVOCH_MST"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region

End Class
