'****************************************************************************************
'Generated By: JNF BY Solution
'시스템구분 : SolutionOLD/MD/ceMD_BOOKING_MEDIUM Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceMD_BOOKING_MEDIUM.vb ( MD_BOOKING_MEDIUM Entity 처리 Class)
'기      능 : MD_BOOKING_MEDIUM Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-08-18 오후 2:40:17 By Kim Tae Ho
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceMD_BOOKING_MEDIUM
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceMD_BOOKING_MEDIUM"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strYEARMON As String, _
                             ByVal dblSEQ As Double, _
                             ByVal strPUB_DATE As String, _
                             ByVal strCLIENTCODE As String, _
                             ByVal strTIMCODE As String, _
                             ByVal strREAL_MED_CODE As String, _
                             ByVal strMEDCODE As String, _
                             ByVal strMED_FLAG As String, _
                    Optional ByVal strSUBSEQ As String = OPTIONAL_STR, _
                    Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                    Optional ByVal strMATTERCODE As String = OPTIONAL_STR, _
                    Optional ByVal strPUB_FACE As String = OPTIONAL_STR, _
                    Optional ByVal strEXECUTE_FACE As String = OPTIONAL_STR, _
                    Optional ByVal strCOL_DEG As String = OPTIONAL_STR, _
                    Optional ByVal dblSTD_STEP As Double = OPTIONAL_NUM, _
                    Optional ByVal dblSTD_CM As Double = OPTIONAL_NUM, _
                    Optional ByVal dblSTD_FACE As Double = OPTIONAL_NUM, _
                    Optional ByVal strSTD As String = OPTIONAL_STR, _
                    Optional ByVal dblSTD_PAGE As Double = OPTIONAL_NUM, _
                    Optional ByVal strDIVMEDIA As String = OPTIONAL_STR, _
                    Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
                    Optional ByVal dblPRICE As Double = OPTIONAL_NUM, _
                    Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
                    Optional ByVal dblCOMMI_RATE As Double = OPTIONAL_NUM, _
                    Optional ByVal dblCOMMISSION As Double = OPTIONAL_NUM, _
                    Optional ByVal strGFLAG As String = OPTIONAL_STR, _
                    Optional ByVal strPROJECTION As String = OPTIONAL_STR, _
                    Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
                    Optional ByVal strVOCH_TYPE As String = OPTIONAL_STR, _
                    Optional ByVal strRECEIPT_GUBUN As String = OPTIONAL_STR, _
                    Optional ByVal strTRU_TAX_FLAG As String = OPTIONAL_STR, _
                    Optional ByVal strCOMMI_TAX_FLAG As String = OPTIONAL_STR, _
                    Optional ByVal strMEMO As String = OPTIONAL_STR, _
                    Optional ByVal strDUTYFLAG As String = OPTIONAL_STR)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now

        Try
            BuildNameValues(",", "YEARMON", strYEARMON, strFields, strValues)
            BuildNameValues(",", "SEQ", dblSEQ, strFields, strValues)
            BuildNameValues(",", "PUB_DATE", strPUB_DATE, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "TIMCODE", strTIMCODE, strFields, strValues)
            BuildNameValues(",", "REAL_MED_CODE", strREAL_MED_CODE, strFields, strValues)
            BuildNameValues(",", "MEDCODE", strMEDCODE, strFields, strValues)
            BuildNameValues(",", "MED_FLAG", strMED_FLAG, strFields, strValues)
            BuildNameValues(",", "SUBSEQ", strSUBSEQ, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "MATTERCODE", strMATTERCODE, strFields, strValues)
            BuildNameValues(",", "PUB_FACE", strPUB_FACE, strFields, strValues)
            BuildNameValues(",", "EXECUTE_FACE", strEXECUTE_FACE, strFields, strValues)
            BuildNameValues(",", "COL_DEG", strCOL_DEG, strFields, strValues)
            BuildNameValues(",", "STD_STEP", dblSTD_STEP, strFields, strValues)
            BuildNameValues(",", "STD_CM", dblSTD_CM, strFields, strValues)
            BuildNameValues(",", "STD_FACE", dblSTD_FACE, strFields, strValues)
            BuildNameValues(",", "STD", strSTD, strFields, strValues)
            BuildNameValues(",", "STD_PAGE", dblSTD_PAGE, strFields, strValues)
            BuildNameValues(",", "DIVMEDIA", strDIVMEDIA, strFields, strValues)
            BuildNameValues(",", "DEMANDDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "PRICE", dblPRICE, strFields, strValues)
            BuildNameValues(",", "AMT", dblAMT, strFields, strValues)
            BuildNameValues(",", "COMMI_RATE", dblCOMMI_RATE, strFields, strValues)
            BuildNameValues(",", "COMMISSION", dblCOMMISSION, strFields, strValues)
            BuildNameValues(",", "GFLAG", strGFLAG, strFields, strValues)
            BuildNameValues(",", "PROJECTION", strPROJECTION, strFields, strValues)
            BuildNameValues(",", "EXCLIENTCODE", strEXCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "VOCH_TYPE", strVOCH_TYPE, strFields, strValues)
            BuildNameValues(",", "RECEIPT_GUBUN", strRECEIPT_GUBUN, strFields, strValues)
            BuildNameValues(",", "TRU_TAX_FLAG", strTRU_TAX_FLAG, strFields, strValues)
            BuildNameValues(",", "COMMI_TAX_FLAG", strCOMMI_TAX_FLAG, strFields, strValues)
            BuildNameValues(",", "MEMO", strMEMO, strFields, strValues)
            BuildNameValues(",", "DUTYFLAG", strDUTYFLAG, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)

            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateDo(Optional ByVal strYEARMON As String = OPTIONAL_STR, _
                             Optional ByVal dblSEQ As Double = OPTIONAL_NUM, _
                             Optional ByVal strPUB_DATE As String = OPTIONAL_STR, _
                             Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strTIMCODE As String = OPTIONAL_STR, _
                             Optional ByVal strREAL_MED_CODE As String = OPTIONAL_STR, _
                             Optional ByVal strMEDCODE As String = OPTIONAL_STR, _
                             Optional ByVal strMED_FLAG As String = OPTIONAL_STR, _
                             Optional ByVal strSUBSEQ As String = OPTIONAL_STR, _
                             Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                             Optional ByVal strMATTERCODE As String = OPTIONAL_STR, _
                             Optional ByVal strPUB_FACE As String = OPTIONAL_STR, _
                             Optional ByVal strEXECUTE_FACE As String = OPTIONAL_STR, _
                             Optional ByVal strCOL_DEG As String = OPTIONAL_STR, _
                             Optional ByVal dblSTD_STEP As Double = OPTIONAL_NUM, _
                             Optional ByVal dblSTD_CM As Double = OPTIONAL_NUM, _
                             Optional ByVal dblSTD_FACE As Double = OPTIONAL_NUM, _
                             Optional ByVal strSTD As String = OPTIONAL_STR, _
                             Optional ByVal dblSTD_PAGE As Double = OPTIONAL_NUM, _
                             Optional ByVal strDIVMEDIA As String = OPTIONAL_STR, _
                             Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
                             Optional ByVal dblPRICE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
                             Optional ByVal dblCOMMI_RATE As Double = OPTIONAL_NUM, _
                             Optional ByVal dblCOMMISSION As Double = OPTIONAL_NUM, _
                             Optional ByVal strGFLAG As String = OPTIONAL_STR, _
                             Optional ByVal strPROJECTION As String = OPTIONAL_STR, _
                             Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
                             Optional ByVal strVOCH_TYPE As String = OPTIONAL_STR, _
                             Optional ByVal strRECEIPT_GUBUN As String = OPTIONAL_STR, _
                             Optional ByVal strTRU_TAX_FLAG As String = OPTIONAL_STR, _
                             Optional ByVal strCOMMI_TAX_FLAG As String = OPTIONAL_STR, _
                             Optional ByVal strMEMO As String = OPTIONAL_STR, _
                             Optional ByVal strDUTYFLAG As String = OPTIONAL_STR) As Integer

        Dim strSQL As String
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("PUB_DATE", strPUB_DATE), _
                        GetFieldNameValue("CLIENTCODE", strCLIENTCODE), _
                        GetFieldNameValue("TIMCODE", strTIMCODE), _
                        GetFieldNameValue("REAL_MED_CODE", strREAL_MED_CODE), _
                        GetFieldNameValue("MEDCODE", strMEDCODE), _
                        GetFieldNameValue("MED_FLAG", strMED_FLAG), _
                        GetFieldNameValue("SUBSEQ", strSUBSEQ), _
                        GetFieldNameValue("DEPT_CD", strDEPT_CD), _
                        GetFieldNameValue("MATTERCODE", strMATTERCODE), _
                        GetFieldNameValue("PUB_FACE", strPUB_FACE), _
                        GetFieldNameValue("EXECUTE_FACE", strEXECUTE_FACE), _
                        GetFieldNameValue("COL_DEG", strCOL_DEG), _
                        GetFieldNameValue("STD_STEP", dblSTD_STEP), _
                        GetFieldNameValue("STD_CM", dblSTD_CM), _
                        GetFieldNameValue("STD_FACE", dblSTD_FACE), _
                        GetFieldNameValue("STD", strSTD), _
                        GetFieldNameValue("STD_PAGE", dblSTD_PAGE), _
                        GetFieldNameValue("DIVMEDIA", strDIVMEDIA), _
                        GetFieldNameValue("DEMANDDAY", strDEMANDDAY), _
                        GetFieldNameValue("PRICE", dblPRICE), _
                        GetFieldNameValue("AMT", dblAMT), _
                        GetFieldNameValue("COMMI_RATE", dblCOMMI_RATE), _
                        GetFieldNameValue("COMMISSION", dblCOMMISSION), _
                        GetFieldNameValue("GFLAG", strGFLAG), _
                        GetFieldNameValue("PROJECTION", strPROJECTION), _
                        GetFieldNameValue("EXCLIENTCODE", strEXCLIENTCODE), _
                        GetFieldNameValue("VOCH_TYPE", strVOCH_TYPE), _
                        GetFieldNameValue("RECEIPT_GUBUN", strRECEIPT_GUBUN), _
                        GetFieldNameValue("TRU_TAX_FLAG", strTRU_TAX_FLAG), _
                        GetFieldNameValue("COMMI_TAX_FLAG", strCOMMI_TAX_FLAG), _
                        GetFieldNameValue("MEMO", strMEMO), _
                        GetFieldNameValue("DUTYFLAG", strDUTYFLAG), _
                        GetFieldNameValue("UUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("UDATE", strNOW)), _
                     BuildFields("AND", _
                        GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function update_EXCUTION(Optional ByVal strYEARMON As String = OPTIONAL_STR, _
                                    Optional ByVal dblSEQ As Double = OPTIONAL_NUM, _
                                    Optional ByVal strEXCLIENTCODE As String = OPTIONAL_STR, _
                                    Optional ByVal dblEXSUSURATE As Double = OPTIONAL_NUM, _
                                    Optional ByVal dblEXSUSU As Double = OPTIONAL_NUM, _
                                    Optional ByVal dblMCSUSU As Double = OPTIONAL_NUM, _
                                    Optional ByVal strMEMO As String = OPTIONAL_STR) As Integer
        Dim strSQL As String
        Dim strNOW As String
        strNOW = Now
        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("EXCLIENTCODE", strEXCLIENTCODE), _
                        GetFieldNameValue("EXSUSURATE", dblEXSUSURATE), _
                        GetFieldNameValue("EXSUSU", dblEXSUSU), _
                        GetFieldNameValue("MCSUSU", dblMCSUSU), _
                        GetFieldNameValue("EXUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("EXDATE", strNOW), _
                        GetFieldNameValue("MEMO", strMEMO)), _
                     BuildFields("AND", _
                        GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ)))
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".update_EXCUTION")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function DeleteDo(Optional ByVal strYEARMON As String = OPTIONAL_STR, Optional ByVal dblSEQ As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("DELETE FROM {0} WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리(대대행사 공백 및 NULL 로 업데이트 처리)
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function DeleteRtn_EXCUTION(Optional ByVal strYEARMON As String = OPTIONAL_STR, _
                                            Optional ByVal dblSEQ As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET EXCLIENTCODE= '',EXUSER=EXUSER+' 삭제',EXDATE='',EXSUSURATE=NULL,EXSUSU=NULL, MCSUSU=NULL WHERE YEARMON = '" & strYEARMON & "' AND SEQ =" & dblSEQ

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteRtn_EXCUTION")
        End Try
    End Function
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Select 처리
    '*****************************************************************
    Public Function SelectDo(ByRef intRowCnt As Integer, ByRef intColCnt As Integer, _
                            Optional ByVal strYEARMON As String = OPTIONAL_STR, _
Optional ByVal dblSEQ As Double = OPTIONAL_NUM, _
                            Optional ByVal strSelFields As String = "*", _
                            Optional ByVal intLimitRow As Integer = 0, _
                            Optional ByVal intSelMode As Integer = SELMODE.ARR, _
                            Optional ByVal blnBindingHeader As Boolean = False) As Object
        Dim strSQL As String
        Dim strKeyFields As String

        Try
            strKeyFields = BuildFields("AND", _
                                    GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ))

            Return SelectDoExt(intRowCnt, intColCnt, strSelFields, strKeyFields, intLimitRow, intSelMode, blnBindingHeader)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".SeleteDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL =SQL 문  By KTY
    '반환 : 처리건수
    '기능 : 해당 Entity에 해당년월 [그룹분담금] Delete 처리
    '*****************************************************************
    Public Function GroupDeleteDo(ByVal strYEARMON As String)

        Dim strSQL As String
        Try
            strSQL = "DELETE FROM  MD_BOOKING_MEDIUM WHERE YEARMON = '" & strYEARMON & "' AND ATTR01 = 'G'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".GroupDeleteDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁테이블의 세금계산서 번호 업데이트
    '*****************************************************************
    Public Function Update_TruTax(ByVal strTRANSNO As String, _
                                  ByVal strTAXNO As String) As Integer
        'strTRANSNO, strTAXNO
        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET TRU_TAX_NO = '" & strTAXNO & "' , GFLAG = 'S'"
            strSQL = strSQL & "  WHERE TRU_TRANS_NO = '" & strTRANSNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_TruTax")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UPDATE_TRANS_DO()
        Dim strSQL As String

        Try
            strSQL = " UPDATE MD_BOOKING_MEDIUM A"
            strSQL = strSQL & "   SET A.TRU_TRANS_NO = (SELECT TRANSYEARMON || '-' || TRANSNO  FROM MD_PRINTTRANS_DTL B  WHERE A.YEARMON = B.TRANSYEARMON AND A.SEQ= B.TRUST_SEQ) "
            strSQL = strSQL & "   WHERE EXISTS "
            strSQL = strSQL & "   ("
            strSQL = strSQL & " 	  SELECT B.TRUST_SEQ, B.ATTR01"
            strSQL = strSQL & " 	  FROM MD_PRINTTRANS_DTL B"
            strSQL = strSQL & " 	  WHERE A.YEARMON = B.TRANSYEARMON AND A.SEQ= B.TRUST_SEQ                      "
            strSQL = strSQL & "   )"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_TRANS_DO")
        End Try
    End Function

    Public Function Update_TruTrans(ByVal strTRUST_YEARMON As String, _
                                    ByVal lngTrust_seq As Double, _
                                    ByVal strTRUTRANS As String, _
                                    ByVal strDEMANDDAY As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET TRU_TRANS_NO = '" & strTRUTRANS & "' , GFLAG = 'J' , DEMANDDAY = '" & strDEMANDDAY & "'"
            strSQL = strSQL & " WHERE YEARMON = '" & strTRUST_YEARMON & "' AND SEQ = " & lngTrust_seq
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete_Batch")
        End Try
    End Function

    Public Function Update_CommiTrans(ByVal strTRUST_YEARMON As String, _
                                      ByVal lngTrust_seq As Double, _
                                      ByVal strTRUTRANS As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET COMMI_TRANS_NO = '" & strTRUTRANS & "' "
            strSQL = strSQL & " WHERE YEARMON = '" & strTRUST_YEARMON & "' AND SEQ = " & lngTrust_seq
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Delete_Batch")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : [그룹분담금] 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function TempInsertDo(ByVal strSQLTEMP As String)

        Dim strSQL As String
        Try
            strSQL = "INSERT INTO MD_BOOKING_MEDIUM (" & strSQLTEMP & ")"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".TempInsertDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁에 수수료세금계산서 번호 업데이트
    '*****************************************************************
    Public Function Update_CommiTax(ByVal strTRANSNO As String, _
                                    ByVal strTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET COMMI_TAX_NO = '" & strTAXNO & "' "
            strSQL = strSQL & "  WHERE COMMI_TRANS_NO = '" & strTRANSNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".Update_CommiTax")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁테이블의 세금계산서 삭제시 번호 업데이트
    '*****************************************************************
    Public Function CommiTaxDeleteUpdateDo(ByVal strTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET COMMI_TAX_NO = '' "
            strSQL = strSQL & "  WHERE COMMI_TAX_NO = '" & strTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".CommiTaxDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁테이블의 거래명세삭제시에 trans_trans_no 를 없애준다.
    '*****************************************************************
    Public Function TRANSDeleteUpdateDo(ByVal strTRANSYEARMON As String, _
                                        ByVal strTRANSNO As String) As Integer
        Dim strSQL As String
        Try

            strSQL = strSQL & "  UPDATE MD_BOOKING_MEDIUM "
            strSQL = strSQL & "  SET TRU_TRANS_NO = '' , GFLAG = 'B' "
            strSQL = strSQL & "  FROM MD_BOOKING_MEDIUM"
            strSQL = strSQL & "  WHERE YEARMON + '-' + CAST(SEQ AS VARCHAR(10)) IN("
            strSQL = strSQL & "  	SELECT TRUST_YEARMON + '-' + CAST(TRUST_SEQ AS VARCHAR(10))"
            strSQL = strSQL & "  	FROM MD_PRINTTRANS_DTL "
            strSQL = strSQL & "  	WHERE TRANSYEARMON = '" & strTRANSYEARMON & "'"
            strSQL = strSQL & "  	AND TRANSNO = '" & strTRANSNO & "'"
            strSQL = strSQL & "  )"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".TRANSDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁테이블의 거래명세삭제시에 commi_trans_no 를 없애준다.
    '*****************************************************************
    Public Function COMMIDeleteUpdateDo(ByVal strTRANSYEARMON As String, _
                                        ByVal strTRANSNO As String) As Integer
        Dim strSQL As String
        Try
            strSQL = strSQL & "  UPDATE MD_BOOKING_MEDIUM "
            strSQL = strSQL & "  SET COMMI_TRANS_NO = '' "
            strSQL = strSQL & "  FROM MD_BOOKING_MEDIUM"
            strSQL = strSQL & "  WHERE YEARMON + '-' + CAST(SEQ AS VARCHAR(10)) IN("
            strSQL = strSQL & "  	SELECT TRUST_YEARMON + '-' + CAST(TRUST_SEQ AS VARCHAR(10))"
            strSQL = strSQL & "  	FROM MD_PRINTCOMMI_DTL "
            strSQL = strSQL & "  	WHERE TRANSYEARMON = '" & strTRANSYEARMON & "'"
            strSQL = strSQL & "  	AND TRANSNO = '" & strTRANSNO & "'"
            strSQL = strSQL & "  )"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".COMMIDeleteUpdateDo")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTY
    '반환 : 처리건수
    '기능 : 신탁테이블의 세금계산서 삭제시 번호 업데이트
    '*****************************************************************
    Public Function TruTaxDeleteUpdateDo(ByVal strTAXNO As String) As Integer
        Dim strSQL As String
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET TRU_TAX_NO = '' , GFLAG = 'J'"
            strSQL = strSQL & "  WHERE TRU_TAX_NO = '" & strTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".TruTaxDeleteUpdateDo")
        End Try
    End Function

    Public Function GFLAGUpdate(ByVal strGFLAG As String, _
                                ByVal strYEARMON As String, _
                                ByVal strSEQ As Double) As Integer
        Dim strSQL
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Dim strUSER As String
        strUSER = mobjSCGLConfig.WRKUSR
        Try
            strSQL = "UPDATE MD_BOOKING_MEDIUM SET GFLAG = '" & strGFLAG & "'"
            strSQL = strSQL & " ,ATTR04 = '" & strUSER & "',ATTR05 =  '" & strNOW & "'"
            strSQL = strSQL & " WHERE YEARMON = '" & strYEARMON & "' AND SEQ = " & strSEQ

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".ConfirmUpdate")
        End Try
    End Function

#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "MD_BOOKING_MEDIUM"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region
End Class

'------->>엔티티 INSERT/UPDATE 샘플입니다. 반드시 자신의 환경에 맞추어서 변경하시기 바랍니다.
'=========================================================
'       'vntData Array를 사용할 때 Insert/Update 입니다.
'=========================================================
'        Dim intRtn As Integer
'        intRtn = mobjceMD_BOOKING_MEDIUM.InsertDo( _
'                                       GetElement(vntData,"YEARMON", intColCnt, intRow), _
'                                       GetElement(vntData,"SEQ", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"PUB_DATE", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"MEDCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"MED_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"SUBSEQ", intColCnt, intRow), _
'                                       GetElement(vntData,"DEPT_CD", intColCnt, intRow), _
'                                       GetElement(vntData,"PROGRAM_NAME", intColCnt, intRow), _
'                                       GetElement(vntData,"COL_DEG", intColCnt, intRow), _
'                                       GetElement(vntData,"PUB_FACE", intColCnt, intRow), _
'                                       GetElement(vntData,"STD_CM", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"STD_STEP", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"PRICE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"AMOUNT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMI_RATE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMISSION", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"GFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TAX_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TAX_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TRANS_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TAX_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_VOCH_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TRANS_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TAX_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_VOCH_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"NOTE", intColCnt, intRow), _
'                                       GetElement(vntData,"PROJECTION", intColCnt, intRow), _
'                                       GetElement(vntData,"SPONSOR", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR01", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR02", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR03", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR04", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR05", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR06", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR07", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR08", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR09", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR10", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"CUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"CDATE", intColCnt, intRow, NULL_DTM, true ), _
'                                       GetElement(vntData,"UUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"UDATE", intColCnt, intRow, NULL_DTM, true ) _
'                                       )
'        Return intRtn

'        Dim intRtn As Integer
'        intRtn = mobjceMD_BOOKING_MEDIUM.UpdateDo( _
'                                       GetElement(vntData,"YEARMON", intColCnt, intRow), _
'                                       GetElement(vntData,"SEQ", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"PUB_DATE", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"MEDCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"MED_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"SUBSEQ", intColCnt, intRow), _
'                                       GetElement(vntData,"DEPT_CD", intColCnt, intRow), _
'                                       GetElement(vntData,"PROGRAM_NAME", intColCnt, intRow), _
'                                       GetElement(vntData,"COL_DEG", intColCnt, intRow), _
'                                       GetElement(vntData,"PUB_FACE", intColCnt, intRow), _
'                                       GetElement(vntData,"STD_CM", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"STD_STEP", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"PRICE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"AMOUNT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMI_RATE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMISSION", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"GFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TAX_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TAX_FLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TRANS_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_TAX_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"TRU_VOCH_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TRANS_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_TAX_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"COMMI_VOCH_NO", intColCnt, intRow), _
'                                       GetElement(vntData,"NOTE", intColCnt, intRow), _
'                                       GetElement(vntData,"PROJECTION", intColCnt, intRow), _
'                                       GetElement(vntData,"SPONSOR", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR01", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR02", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR03", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR04", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR05", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR06", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR07", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR08", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR09", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR10", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"CUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"CDATE", intColCnt, intRow, NULL_DTM, true ), _
'                                       GetElement(vntData,"UUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"UDATE", intColCnt, intRow, NULL_DTM, true ) _
'                                       )
'        Return intRtn


'=========================================================
'       'XmlData 를 사용할 때 Insert/Update 입니다.
'=========================================================
'        Dim intRtn As Integer
'        intRtn = mobjceMD_BOOKING_MEDIUM.InsertDo( _
'                                       XMLGetElement(xmlRoot,"YEARMON"), _
'                                       XMLGetElement(xmlRoot,"SEQ", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"PUB_DATE"), _
'                                       XMLGetElement(xmlRoot,"CLIENTCODE"), _
'                                       XMLGetElement(xmlRoot,"MEDCODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_CODE"), _
'                                       XMLGetElement(xmlRoot,"MED_FLAG"), _
'                                       XMLGetElement(xmlRoot,"SUBSEQ"), _
'                                       XMLGetElement(xmlRoot,"DEPT_CD"), _
'                                       XMLGetElement(xmlRoot,"PROGRAM_NAME"), _
'                                       XMLGetElement(xmlRoot,"COL_DEG"), _
'                                       XMLGetElement(xmlRoot,"PUB_FACE"), _
'                                       XMLGetElement(xmlRoot,"STD_CM", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"STD_STEP", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"PRICE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"AMOUNT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMI_RATE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMISSION", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"GFLAG"), _
'                                       XMLGetElement(xmlRoot,"TRU_TAX_FLAG"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TAX_FLAG"), _
'                                       XMLGetElement(xmlRoot,"TRU_TRANS_NO"), _
'                                       XMLGetElement(xmlRoot,"TRU_TAX_NO"), _
'                                       XMLGetElement(xmlRoot,"TRU_VOCH_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TRANS_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TAX_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_VOCH_NO"), _
'                                       XMLGetElement(xmlRoot,"NOTE"), _
'                                       XMLGetElement(xmlRoot,"PROJECTION"), _
'                                       XMLGetElement(xmlRoot,"SPONSOR"), _
'                                       XMLGetElement(xmlRoot,"ATTR01"), _
'                                       XMLGetElement(xmlRoot,"ATTR02"), _
'                                       XMLGetElement(xmlRoot,"ATTR03"), _
'                                       XMLGetElement(xmlRoot,"ATTR04"), _
'                                       XMLGetElement(xmlRoot,"ATTR05"), _
'                                       XMLGetElement(xmlRoot,"ATTR06", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR07", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR08", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR09", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR10", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"CUSER"), _
'                                       XMLGetElement(xmlRoot,"CDATE", NULL_DTM, true ), _
'                                       XMLGetElement(xmlRoot,"UUSER"), _
'                                       XMLGetElement(xmlRoot,"UDATE", NULL_DTM, true ) _
'                                       )
'        Return intRtn

'        Dim intRtn As Integer
'        intRtn = mobjceMD_BOOKING_MEDIUM.UpdateDo( _
'                                       XMLGetElement(xmlRoot,"YEARMON"), _
'                                       XMLGetElement(xmlRoot,"SEQ", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"PUB_DATE"), _
'                                       XMLGetElement(xmlRoot,"CLIENTCODE"), _
'                                       XMLGetElement(xmlRoot,"MEDCODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_CODE"), _
'                                       XMLGetElement(xmlRoot,"MED_FLAG"), _
'                                       XMLGetElement(xmlRoot,"SUBSEQ"), _
'                                       XMLGetElement(xmlRoot,"DEPT_CD"), _
'                                       XMLGetElement(xmlRoot,"PROGRAM_NAME"), _
'                                       XMLGetElement(xmlRoot,"COL_DEG"), _
'                                       XMLGetElement(xmlRoot,"PUB_FACE"), _
'                                       XMLGetElement(xmlRoot,"STD_CM", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"STD_STEP", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"PRICE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"AMOUNT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMI_RATE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMISSION", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"GFLAG"), _
'                                       XMLGetElement(xmlRoot,"TRU_TAX_FLAG"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TAX_FLAG"), _
'                                       XMLGetElement(xmlRoot,"TRU_TRANS_NO"), _
'                                       XMLGetElement(xmlRoot,"TRU_TAX_NO"), _
'                                       XMLGetElement(xmlRoot,"TRU_VOCH_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TRANS_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_TAX_NO"), _
'                                       XMLGetElement(xmlRoot,"COMMI_VOCH_NO"), _
'                                       XMLGetElement(xmlRoot,"NOTE"), _
'                                       XMLGetElement(xmlRoot,"PROJECTION"), _
'                                       XMLGetElement(xmlRoot,"SPONSOR"), _
'                                       XMLGetElement(xmlRoot,"ATTR01"), _
'                                       XMLGetElement(xmlRoot,"ATTR02"), _
'                                       XMLGetElement(xmlRoot,"ATTR03"), _
'                                       XMLGetElement(xmlRoot,"ATTR04"), _
'                                       XMLGetElement(xmlRoot,"ATTR05"), _
'                                       XMLGetElement(xmlRoot,"ATTR06", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR07", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR08", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR09", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR10", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"CUSER"), _
'                                       XMLGetElement(xmlRoot,"CDATE", NULL_DTM, true ), _
'                                       XMLGetElement(xmlRoot,"UUSER"), _
'                                       XMLGetElement(xmlRoot,"UDATE", NULL_DTM, true ) _
'                                       )
'        Return intRtn


