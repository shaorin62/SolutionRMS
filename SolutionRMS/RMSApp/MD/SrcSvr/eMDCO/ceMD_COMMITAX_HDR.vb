'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 엔티티 클래스 메이커 - 한화 S&C
'시스템구분 : 솔루션명/시스템명/Server Entity Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceMD_COMMITAX_HDR.vb ( MD_COMMITAX_HDR Entity 처리 Class)
'기      능 : MD_COMMITAX_HDR Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-03-06 오후 8:11:36 By Making Entity Bean
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceMD_COMMITAX_HDR
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceMD_COMMITAX_HDR"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strTAXYEARMON As String, _
            ByVal dblTAXNO As Double, _
            ByVal strMEDFLAG As String, _
            ByVal strCLIENTCODE As String, _
            ByVal strCLIENTACCODE As String, _
            ByVal strREAL_MED_CODE As String, _
            ByVal strREAL_MED_ACCODE As String, _
            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
            Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblVAT As Double = OPTIONAL_NUM, _
            Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
            Optional ByVal strPRINTDAY As String = OPTIONAL_STR, _
            Optional ByVal strVOCHNO As String = OPTIONAL_STR, _
            Optional ByVal strMEMO As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTBISNO As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MED_BISNO As String = OPTIONAL_STR, _
            Optional ByVal strSUMM As String = OPTIONAL_STR, _
            Optional ByVal strMJFLAG As String = OPTIONAL_STR, _
            Optional ByVal strTAX_CODE As String = OPTIONAL_STR, _
            Optional ByVal strPAY_CODE As String = OPTIONAL_STR, _
            Optional ByVal dblREAL_AMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblCOMMI_RATE As Double = OPTIONAL_NUM, _
            Optional ByVal strREV_NA_CODE As String = OPTIONAL_STR, _
            Optional ByVal strREC_NA_CODE As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MED_NAME As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDOWNER As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDADDR1 As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDADDR2 As String = OPTIONAL_STR, _
            Optional ByVal strFEE_TAXYEARMON As String = OPTIONAL_STR, _
            Optional ByVal dblFEE_TAXNO As Double = OPTIONAL_NUM, _
            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
            Optional ByVal strATTR04 As String = OPTIONAL_STR, _
            Optional ByVal strATTR05 As String = OPTIONAL_STR, _
            Optional ByVal strATTR06 As String = OPTIONAL_STR, _
            Optional ByVal dblATTR07 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR08 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR09 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR10 As Double = OPTIONAL_NUM)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            BuildNameValues(",", "TAXYEARMON", strTAXYEARMON, strFields, strValues)
            BuildNameValues(",", "TAXNO", dblTAXNO, strFields, strValues)
            BuildNameValues(",", "MEDFLAG", strMEDFLAG, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "CLIENTACCODE", strCLIENTACCODE, strFields, strValues)
            BuildNameValues(",", "REAL_MED_CODE", strREAL_MED_CODE, strFields, strValues)
            BuildNameValues(",", "REAL_MED_ACCODE", strREAL_MED_ACCODE, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "AMT", dblAMT, strFields, strValues)
            BuildNameValues(",", "VAT", dblVAT, strFields, strValues)
            BuildNameValues(",", "DEMANDDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "PRINTDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "VOCHNO", strVOCHNO, strFields, strValues)
            BuildNameValues(",", "MEMO", strMEMO, strFields, strValues)
            BuildNameValues(",", "CLIENTBISNO", strCLIENTBISNO, strFields, strValues)
            BuildNameValues(",", "REAL_MED_BISNO", strREAL_MED_BISNO, strFields, strValues)
            BuildNameValues(",", "SUMM", strSUMM, strFields, strValues)
            BuildNameValues(",", "MJFLAG", strMJFLAG, strFields, strValues)
            BuildNameValues(",", "TAX_CODE", strTAX_CODE, strFields, strValues)
            BuildNameValues(",", "PAY_CODE", strPAY_CODE, strFields, strValues)
            BuildNameValues(",", "REAL_AMT", dblREAL_AMT, strFields, strValues)
            BuildNameValues(",", "COMMI_RATE", dblCOMMI_RATE, strFields, strValues)
            BuildNameValues(",", "REV_NA_CODE", strREV_NA_CODE, strFields, strValues)
            BuildNameValues(",", "REC_NA_CODE", strREC_NA_CODE, strFields, strValues)
            BuildNameValues(",", "REAL_MED_NAME", strREAL_MED_NAME, strFields, strValues)
            BuildNameValues(",", "REAL_MEDOWNER", strREAL_MEDOWNER, strFields, strValues)
            BuildNameValues(",", "REAL_MEDADDR1", strREAL_MEDADDR1, strFields, strValues)
            BuildNameValues(",", "REAL_MEDADDR2", strREAL_MEDADDR2, strFields, strValues)
            BuildNameValues(",", "FEE_TAXYEARMON", strFEE_TAXYEARMON, strFields, strValues)
            BuildNameValues(",", "FEE_TAXNO", dblFEE_TAXNO, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "ATTR02", strATTR02, strFields, strValues)
            BuildNameValues(",", "ATTR03", strATTR03, strFields, strValues)
            BuildNameValues(",", "ATTR04", strATTR04, strFields, strValues)
            BuildNameValues(",", "ATTR05", strATTR05, strFields, strValues)
            BuildNameValues(",", "ATTR06", strATTR06, strFields, strValues)
            BuildNameValues(",", "ATTR07", dblATTR07, strFields, strValues)
            BuildNameValues(",", "ATTR08", dblATTR08, strFields, strValues)
            BuildNameValues(",", "ATTR09", dblATTR09, strFields, strValues)
            BuildNameValues(",", "ATTR10", dblATTR10, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)

            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateDo(Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, _
            Optional ByVal dblTAXNO As Double = OPTIONAL_NUM, _
            Optional ByVal strMEDFLAG As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
            Optional ByVal dblCLIENTACCODE As Double = OPTIONAL_NUM, _
            Optional ByVal strREAL_MED_CODE As String = OPTIONAL_STR, _
            Optional ByVal dblREAL_MED_ACCODE As Double = OPTIONAL_NUM, _
            Optional ByVal strDEPTCODE As String = OPTIONAL_STR, _
            Optional ByVal dblSUMAMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblVAT As Double = OPTIONAL_NUM, _
            Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
            Optional ByVal strPRINTDAY As String = OPTIONAL_STR, _
            Optional ByVal strVOCHNO As String = OPTIONAL_STR, _
            Optional ByVal strMEMO As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTBISNO As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MED_BISNO As String = OPTIONAL_STR, _
            Optional ByVal strSUMM As String = OPTIONAL_STR, _
            Optional ByVal strMJFLAG As String = OPTIONAL_STR, _
            Optional ByVal strTAX_CODE As String = OPTIONAL_STR, _
            Optional ByVal strPAY_CODE As String = OPTIONAL_STR, _
            Optional ByVal dblREAL_AMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblCOMMI_RATE As Double = OPTIONAL_NUM, _
            Optional ByVal strREV_NA_CODE As String = OPTIONAL_STR, _
            Optional ByVal strREC_NA_CODE As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MED_NAME As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDOWNER As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDADDR1 As String = OPTIONAL_STR, _
            Optional ByVal strREAL_MEDADDR2 As String = OPTIONAL_STR, _
            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
            Optional ByVal strATTR04 As String = OPTIONAL_STR, _
            Optional ByVal strATTR05 As String = OPTIONAL_STR, _
            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR07 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR08 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR09 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR10 As Double = OPTIONAL_NUM) As Integer

        Dim strSQL As String
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("MEDFLAG", strMEDFLAG), _
                        GetFieldNameValue("CLIENTCODE", strCLIENTCODE), _
                        GetFieldNameValue("CLIENTACCODE", dblCLIENTACCODE), _
                        GetFieldNameValue("REAL_MED_CODE", strREAL_MED_CODE), _
                        GetFieldNameValue("REAL_MED_ACCODE", dblREAL_MED_ACCODE), _
                        GetFieldNameValue("DEPTCODE", strDEPTCODE), _
                        GetFieldNameValue("SUMAMT", dblSUMAMT), _
                        GetFieldNameValue("VAT", dblVAT), _
                        GetFieldNameValue("DEMANDDAY", strDEMANDDAY), _
                        GetFieldNameValue("PRINTDAY", strPRINTDAY), _
                        GetFieldNameValue("VOCHNO", strVOCHNO), _
                        GetFieldNameValue("MEMO", strMEMO), _
                        GetFieldNameValue("CLIENTBISNO", strCLIENTBISNO), _
                        GetFieldNameValue("REAL_MED_BISNO", strREAL_MED_BISNO), _
                        GetFieldNameValue("SUMM", strSUMM), _
                        GetFieldNameValue("MJFLAG", strMJFLAG), _
                        GetFieldNameValue("TAX_CODE", strTAX_CODE), _
                        GetFieldNameValue("PAY_CODE", strPAY_CODE), _
                        GetFieldNameValue("REAL_AMT", dblREAL_AMT), _
                        GetFieldNameValue("COMMI_RATE", dblCOMMI_RATE), _
                        GetFieldNameValue("REV_NA_CODE", strREV_NA_CODE), _
                        GetFieldNameValue("REC_NA_CODE", strREC_NA_CODE), _
                        GetFieldNameValue("REAL_MED_NAME", strREAL_MED_NAME), _
                        GetFieldNameValue("REAL_MEDOWNER", strREAL_MEDOWNER), _
                        GetFieldNameValue("REAL_MEDADDR1", strREAL_MEDADDR1), _
                        GetFieldNameValue("REAL_MEDADDR2", strREAL_MEDADDR2), _
                        GetFieldNameValue("ATTR01", strATTR01), _
                        GetFieldNameValue("ATTR02", strATTR02), _
                        GetFieldNameValue("ATTR03", strATTR03), _
                        GetFieldNameValue("ATTR04", strATTR04), _
                        GetFieldNameValue("ATTR05", strATTR05), _
                        GetFieldNameValue("ATTR06", dblATTR06), _
                        GetFieldNameValue("ATTR07", dblATTR07), _
                        GetFieldNameValue("ATTR08", dblATTR08), _
                        GetFieldNameValue("ATTR09", dblATTR09), _
                        GetFieldNameValue("ATTR10", dblATTR10), _
                        GetFieldNameValue("UUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("UDATE", strNOW)), _
                     BuildFields("AND", _
                        GetFieldNameValue("TAXYEARMON", strTAXYEARMON), GetFieldNameValue("TAXNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDo")
        End Try
    End Function
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 세금계산서 전체 삭제
    '*****************************************************************
    Public Function DeleteTAX(ByVal strTAXDEL As String) As Integer
        Dim strSQL As String
        Try
            strSQL = strTAXDEL
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteTAX")
        End Try
    End Function
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function DeleteDo(Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, Optional ByVal dblTAXNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("DELETE FROM {0} WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("TAXYEARMON", strTAXYEARMON), GetFieldNameValue("TAXNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDo")
        End Try
    End Function

    Public Function DeleteMark(Optional ByVal strTAXYEARMON As String = OPTIONAL_STR, Optional ByVal dblTAXNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("UPDATE {0} SET ATTR10 = 999999 WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("TAXYEARMON", strTAXYEARMON), GetFieldNameValue("TAXNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteMark")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 분할청구일때 거래명세서헤더 테이블에 분할을 표시하기 위한 함수
    '*****************************************************************
    Public Function UPDATE_PRINTCOMMIATTR02_HDR(ByVal strTAXYEARMON, ByVal dblTAXNO) As Integer
        Dim strSQL As String
        Try
            strSQL = String.Format("UPDATE MD_PRINTCOMMI_HDR SET ATTR02 = 'D'  WHERE {0}", _
                     BuildFields("AND", _
                                   GetFieldNameValue("TRANSYEARMON", strTAXYEARMON), GetFieldNameValue("TRANSNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_PRINTCOMMIATTR02_HDR")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 분할청구일때 거래명세서헤더 테이블에 분할을 표시하기 위한 함수
    '*****************************************************************
    Public Function UPDATE_ELECCOMMIATTR02_HDR(ByVal strTAXYEARMON, ByVal dblTAXNO) As Integer
        Dim strSQL As String
        Try
            strSQL = String.Format("UPDATE MD_ELECCOMMI_HDR SET ATTR02 = 'D'  WHERE {0}", _
                     BuildFields("AND", _
                                   GetFieldNameValue("TRANSYEARMON", strTAXYEARMON), GetFieldNameValue("TRANSNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_ELECCOMMIATTR02_HDR")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 분할청구일때 거래명세서헤더 테이블에 분할을 표시하기 위한 함수
    '*****************************************************************
    Public Function UPDATE_INTERNETCOMMIATTR02_HDR(ByVal strTAXYEARMON, ByVal dblTAXNO) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("UPDATE MD_INTERNETCOMMI_HDR SET ATTR02 = 'D'  WHERE {0}", _
                     BuildFields("AND", _
                                   GetFieldNameValue("TRANSYEARMON", strTAXYEARMON), GetFieldNameValue("TRANSNO", dblTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_INTERNETCOMMIATTR02_HDR")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UPDATE_PRINT_MEDIUM(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strTRUST_SEQ) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_BOOKING_MEDIUM "
            strSQL = strSQL & "   SET COMMI_TAX_NO = '" & strTAXYEARMON & "-" & intTAXNO & "'"
            strSQL = strSQL & "   SET GFLAG = 'S'"
            strSQL = strSQL & "   WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTRUST_SEQ & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_PRINT_MEDIUM")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UPDATE_ELECTRIC_MEDIUM(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strREAL_MED_CODE) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_ELECTRIC_MEDIUM "
            strSQL = strSQL & "   SET COMMI_TAX_NO = '" & strTAXYEARMON & "-" & intTAXNO & "'"
            strSQL = strSQL & "   WHERE YEARMON = '" & strTAXYEARMON & "' AND REAL_MED_CODE = '" & strREAL_MED_CODE & "' "
            strSQL = strSQL & "   AND SPONSOR = 'Y'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_ELECTRIC_MEDIUM")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UPDATE_INTERNET_MEDIUM(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strTRUST_SEQ) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_INTERNET_MEDIUM "
            strSQL = strSQL & "   SET COMMI_TAX_NO = '" & strTAXYEARMON & "-" & intTAXNO & "'"
            strSQL = strSQL & "   WHERE YEARMON = '" & strTAXYEARMON & "' AND SEQ = '" & strTRUST_SEQ & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_INTERNET_MEDIUM")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UPDATE_CATV_MEDIUM()
        Dim strSQL As String

        Try
            strSQL = " UPDATE MD_CATV_MEDIUM A"
            strSQL = strSQL & "   SET A.COMMI_TAX_NO = (SELECT TAXYEARMON || '-' || TAXNO  FROM MD_COMMITAX_HDR B  WHERE A.YEARMON = B.TAXYEARMON AND A.REAL_MED_CODE= B.REAL_MED_CODE AND A.SPONSOR= B.ATTR05) "
            strSQL = strSQL & "   WHERE EXISTS "
            strSQL = strSQL & "   ("
            strSQL = strSQL & " 	  SELECT B.TAXYEARMON || '-' || B.TAXNO"
            strSQL = strSQL & " 	  FROM MD_COMMITAX_HDR B"
            strSQL = strSQL & " 	  WHERE A.YEARMON = B.TAXYEARMON AND A.REAL_MED_CODE= B.REAL_MED_CODE AND A.SPONSOR= B.ATTR05  "
            strSQL = strSQL & "   )"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UPDATE_CATV_MEDIUM")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateRtn_COMMITAX_HDR_MERGE(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strMEDFLAG) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_COMMITAX_HDR "
            strSQL = strSQL & "   SET MERGEFLAG = '1'"
            strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & intTAXNO & "' AND MEDFLAG = '" & strMEDFLAG & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_COMMITAX_HDR_MERGE")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateRtn_COMMITAX_HDR_MERGE_CANCEL(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strMEDFLAG) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_COMMITAX_HDR "
            strSQL = strSQL & "   SET MERGEFLAG = ''"
            strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & intTAXNO & "' AND MEDFLAG = '" & strMEDFLAG & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_COMMITAX_HDR_MERGE_CANCEL")
        End Try
    End Function

	'*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : AOR 대행 매출 세금 계산서 생성시 바로 통합 청구로 보내기 위함.
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateRtn_COMMITAX_HDR_AORMERGE(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strFLAG) As Integer
        Dim strSQL As String 'strTAXYEARMON, intTAXNO, strTRUST_SEQ

        Try
            strSQL = " UPDATE MD_COMMITAX_HDR "
            strSQL = strSQL & "   SET MERGEFLAG = '1'"
            strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & intTAXNO & "' AND ATTR03 = '" & strFLAG & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_COMMITAX_HDR_AORMERGE")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 수수료 세금계산서 완료건에 대하여 적요,부가세 수정
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    'strTAXYEARMON, intTAXNO, strSUMM, lngSUMVAT

    Public Function SUMMUpdateDo(ByVal strTAXYEARMON, ByVal intTAXNO, ByVal strSUMM, ByVal lngSUMVAT) As Integer
        Dim strSQL As String

        Try
            strSQL = " UPDATE MD_COMMITAX_HDR "
            strSQL = strSQL & " SET SUMM = '" & strSUMM & "' , vat = " & lngSUMVAT
            strSQL = strSQL & " WHERE TAXYEARMON = '" & strTAXYEARMON & "' "
            strSQL = strSQL & " AND TAXNO = " & intTAXNO

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".SUMMUpdateDo")
        End Try
    End Function

#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "MD_COMMITAX_HDR"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region
End Class

'------->>엔티티 INSERT/UPDATE 샘플입니다. 반드시 자신의 환경에 맞추어서 변경하시기 바랍니다.
'=========================================================
'       'vntData Array를 사용할 때 Insert/Update 입니다.
'=========================================================
'        Dim intRtn As Integer
'        intRtn = mobjceMD_COMMITAX_HDR.InsertDo( _
'                                       GetElement(vntData,"TAXYEARMON", intColCnt, intRow), _
'                                       GetElement(vntData,"TAXNO", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"MEDFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTACCODE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"REAL_MED_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_ACCODE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"DEPTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"SUMAMT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"VAT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"DEMANDDAY", intColCnt, intRow), _
'                                       GetElement(vntData,"PRINTDAY", intColCnt, intRow), _
'                                       GetElement(vntData,"VOCHNO", intColCnt, intRow), _
'                                       GetElement(vntData,"MEMO", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTBISNO", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_BISNO", intColCnt, intRow), _
'                                       GetElement(vntData,"SUMM", intColCnt, intRow), _
'                                       GetElement(vntData,"MJFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TAX_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"PAY_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_AMT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMI_RATE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"REV_NA_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REC_NA_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_NAME", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDOWNER", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDADDR1", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDADDR2", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR01", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR02", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR03", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR04", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR05", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR06", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR07", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR08", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR09", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR10", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"CUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"CDATE", intColCnt, intRow, NULL_DTM, true ), _
'                                       GetElement(vntData,"UUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"UDATE", intColCnt, intRow, NULL_DTM, true ) _
'                                       )
'        Return intRtn

'        Dim intRtn As Integer
'        intRtn = mobjceMD_COMMITAX_HDR.UpdateDo( _
'                                       GetElement(vntData,"TAXYEARMON", intColCnt, intRow), _
'                                       GetElement(vntData,"TAXNO", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"MEDFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTACCODE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"REAL_MED_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_ACCODE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"DEPTCODE", intColCnt, intRow), _
'                                       GetElement(vntData,"SUMAMT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"VAT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"DEMANDDAY", intColCnt, intRow), _
'                                       GetElement(vntData,"PRINTDAY", intColCnt, intRow), _
'                                       GetElement(vntData,"VOCHNO", intColCnt, intRow), _
'                                       GetElement(vntData,"MEMO", intColCnt, intRow), _
'                                       GetElement(vntData,"CLIENTBISNO", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_BISNO", intColCnt, intRow), _
'                                       GetElement(vntData,"SUMM", intColCnt, intRow), _
'                                       GetElement(vntData,"MJFLAG", intColCnt, intRow), _
'                                       GetElement(vntData,"TAX_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"PAY_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_AMT", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"COMMI_RATE", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"REV_NA_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REC_NA_CODE", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MED_NAME", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDOWNER", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDADDR1", intColCnt, intRow), _
'                                       GetElement(vntData,"REAL_MEDADDR2", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR01", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR02", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR03", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR04", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR05", intColCnt, intRow), _
'                                       GetElement(vntData,"ATTR06", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR07", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR08", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR09", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"ATTR10", intColCnt, intRow, NULL_NUM, true ), _
'                                       GetElement(vntData,"CUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"CDATE", intColCnt, intRow, NULL_DTM, true ), _
'                                       GetElement(vntData,"UUSER", intColCnt, intRow), _
'                                       GetElement(vntData,"UDATE", intColCnt, intRow, NULL_DTM, true ) _
'                                       )
'        Return intRtn


'=========================================================
'       'XmlData 를 사용할 때 Insert/Update 입니다.
'=========================================================
'        Dim intRtn As Integer
'        intRtn = mobjceMD_COMMITAX_HDR.InsertDo( _
'                                       XMLGetElement(xmlRoot,"TAXYEARMON"), _
'                                       XMLGetElement(xmlRoot,"TAXNO", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"MEDFLAG"), _
'                                       XMLGetElement(xmlRoot,"CLIENTCODE"), _
'                                       XMLGetElement(xmlRoot,"CLIENTACCODE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_ACCODE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"DEPTCODE"), _
'                                       XMLGetElement(xmlRoot,"SUMAMT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"VAT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"DEMANDDAY"), _
'                                       XMLGetElement(xmlRoot,"PRINTDAY"), _
'                                       XMLGetElement(xmlRoot,"VOCHNO"), _
'                                       XMLGetElement(xmlRoot,"MEMO"), _
'                                       XMLGetElement(xmlRoot,"CLIENTBISNO"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_BISNO"), _
'                                       XMLGetElement(xmlRoot,"SUMM"), _
'                                       XMLGetElement(xmlRoot,"MJFLAG"), _
'                                       XMLGetElement(xmlRoot,"TAX_CODE"), _
'                                       XMLGetElement(xmlRoot,"PAY_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_AMT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMI_RATE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"REV_NA_CODE"), _
'                                       XMLGetElement(xmlRoot,"REC_NA_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_NAME"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDOWNER"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDADDR1"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDADDR2"), _
'                                       XMLGetElement(xmlRoot,"ATTR01"), _
'                                       XMLGetElement(xmlRoot,"ATTR02"), _
'                                       XMLGetElement(xmlRoot,"ATTR03"), _
'                                       XMLGetElement(xmlRoot,"ATTR04"), _
'                                       XMLGetElement(xmlRoot,"ATTR05"), _
'                                       XMLGetElement(xmlRoot,"ATTR06", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR07", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR08", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR09", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR10", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"CUSER"), _
'                                       XMLGetElement(xmlRoot,"CDATE", NULL_DTM, true ), _
'                                       XMLGetElement(xmlRoot,"UUSER"), _
'                                       XMLGetElement(xmlRoot,"UDATE", NULL_DTM, true ) _
'                                       )
'        Return intRtn

'        Dim intRtn As Integer
'        intRtn = mobjceMD_COMMITAX_HDR.UpdateDo( _
'                                       XMLGetElement(xmlRoot,"TAXYEARMON"), _
'                                       XMLGetElement(xmlRoot,"TAXNO", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"MEDFLAG"), _
'                                       XMLGetElement(xmlRoot,"CLIENTCODE"), _
'                                       XMLGetElement(xmlRoot,"CLIENTACCODE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_ACCODE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"DEPTCODE"), _
'                                       XMLGetElement(xmlRoot,"SUMAMT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"VAT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"DEMANDDAY"), _
'                                       XMLGetElement(xmlRoot,"PRINTDAY"), _
'                                       XMLGetElement(xmlRoot,"VOCHNO"), _
'                                       XMLGetElement(xmlRoot,"MEMO"), _
'                                       XMLGetElement(xmlRoot,"CLIENTBISNO"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_BISNO"), _
'                                       XMLGetElement(xmlRoot,"SUMM"), _
'                                       XMLGetElement(xmlRoot,"MJFLAG"), _
'                                       XMLGetElement(xmlRoot,"TAX_CODE"), _
'                                       XMLGetElement(xmlRoot,"PAY_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_AMT", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"COMMI_RATE", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"REV_NA_CODE"), _
'                                       XMLGetElement(xmlRoot,"REC_NA_CODE"), _
'                                       XMLGetElement(xmlRoot,"REAL_MED_NAME"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDOWNER"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDADDR1"), _
'                                       XMLGetElement(xmlRoot,"REAL_MEDADDR2"), _
'                                       XMLGetElement(xmlRoot,"ATTR01"), _
'                                       XMLGetElement(xmlRoot,"ATTR02"), _
'                                       XMLGetElement(xmlRoot,"ATTR03"), _
'                                       XMLGetElement(xmlRoot,"ATTR04"), _
'                                       XMLGetElement(xmlRoot,"ATTR05"), _
'                                       XMLGetElement(xmlRoot,"ATTR06", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR07", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR08", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR09", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"ATTR10", NULL_NUM, true ), _
'                                       XMLGetElement(xmlRoot,"CUSER"), _
'                                       XMLGetElement(xmlRoot,"CDATE", NULL_DTM, true ), _
'                                       XMLGetElement(xmlRoot,"UUSER"), _
'                                       XMLGetElement(xmlRoot,"UDATE", NULL_DTM, true ) _
'                                       )
'        Return intRtn
