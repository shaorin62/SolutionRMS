'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커 - 한화 S&C
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccMDCMTRUTAX.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2004-03-30 오전 10:32:13 By MakeSFARV.2.0.0
'                  2) 2004-03-30 오전 10:32:13 By 작성자명을 씁니다.
'****************************************************************************************

Imports System.Xml                  ' XML처리
Imports SCGLControl                 ' ControlClass의 Base Class
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr          ' 오류처리 클래스
Imports SCGLUtil.cbSCGLXml          ' XML처리 클래스
Imports SCGLUtil.cbSCGLUtil         ' 기타유틸리티 클래스
Imports eMDCO

Public Class ccMDCOSENDTRUTAX
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccMDCOSENDTRUTAX"                  '자신의 클래스명
    Private mobjceMD_TRUTAX_HDR As eMDCO.ceMD_TRUTAX_HDR              '사용할 Entity 변수 선언
    Private mobjceMD_TRUTAX_DTL As eMDCO.ceMD_TRUTAX_DTL
    Private mobjceMD_COMMITAX_HDR As eMDCO.ceMD_COMMITAX_HDR
    Private mobjceMD_COMMITAX_DTL As eMDCO.ceMD_COMMITAX_DTL
    Private mobjceMD_SENDTAX_MST As eMDCO.ceMD_SENDTAX_MST
    Private mobjceMD_SENDTAXFILE_MST As eMDCO.ceMD_SENDTAXFILE_MST

#End Region

#Region "GROUP BLOCK : Property 선언"
#End Region

#Region "GROUP BLOCK : Event 선언"
    Public Function Get_COMBOREQFLAG_VALUE(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer) As Object

        Dim strSQL, strFormat, strSelFields As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        '조회 필드 설정
        strSelFields = "CODE, CODE_NAME"

        'SQL문 생성

        strFormat = "SELECT {0} " & _
                    "FROM SC_CODE " & _
                    "WHERE CLASS_CODE = 'REQFLAG' " & _
                    "ORDER BY SORT_SEQ "

        With mobjSCGLConfig
            strSQL = String.Format(strFormat, strSelFields)

            ''데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetDataType")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function Get_COMBOBILLFLAG_VALUE(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer) As Object

        Dim strSQL, strFormat, strSelFields As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        '조회 필드 설정
        strSelFields = "CODE, CODE_NAME"

        'SQL문 생성

        strFormat = "SELECT {0} " & _
                    "FROM SC_CODE " & _
                    "WHERE CLASS_CODE = 'BILLFLAG' " & _
                    "ORDER BY SORT_SEQ "

        With mobjSCGLConfig
            strSQL = String.Format(strFormat, strSelFields)

            ''데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetDataType")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function Get_COMBOEDITTYPECD_VALUE(ByVal strInfoXML As String, _
                                              ByRef intRowCnt As Integer, _
                                              ByRef intColCnt As Integer) As Object

        Dim strSQL, strFormat, strSelFields As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        '조회 필드 설정
        strSelFields = "CODE, CODE_NAME"

        'SQL문 생성
        strFormat = "  SELECT "
        strFormat = strFormat & "  {0}"
        strFormat = strFormat & "  FROM ("
        strFormat = strFormat & "  	SELECT '' CODE, '' CODE_NAME, 1 SORT_SEQ"
        strFormat = strFormat & "  	UNION ALL"
        strFormat = strFormat & "  	SELECT CODE, CODE_NAME, 2 SORT_SEQ"
        strFormat = strFormat & "  	FROM SC_CODE  "
        strFormat = strFormat & "  	WHERE CLASS_CODE = 'EDITTYPECD'  "
        strFormat = strFormat & "  ) A"
        strFormat = strFormat & "  ORDER BY SORT_SEQ "

        With mobjSCGLConfig
            strSQL = String.Format(strFormat, strSelFields)

            ''데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetDataType")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    ' =============== 원세금계산서 번호조회
    Public Function GetFIRSTBILLNO(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strTAXYEARMON As String, _
                                   ByVal strTAXNO As String, _
                                   ByVal strCLIENTNAME As String, _
                                   ByVal strMEDFLAG As String, _
                                   ByVal strGUBUN As String) As Object

        Dim strCols As String        '컬럼변수
        Dim strWhere As String       'Where조건 변수
        Dim strFormat As String      'SQL Format 변수
        Dim strSQL As String         'SQL 변수
        Dim vntData As Object        'Array Return 변수(Array 를사용할 때 선언)
        Dim intCnt
        Dim intRtn
        Dim Con1, Con2, Con3, Con4
        SetConfig(strInfoXML)

        Con1 = "" : Con2 = "" : Con3 = "" : Con4 = ""

        If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (TAXYEARMON = '{0}')", strTAXYEARMON)
        If strTAXNO <> "" Then Con2 = String.Format(" AND (TAXNO = '{0}')", strTAXNO)
        If strCLIENTNAME <> "" Then Con3 = String.Format(" AND (CLIENTNAME = '{0}')", strCLIENTNAME)

        If strGUBUN = "PRINT" Then
            If strMEDFLAG = "" Then
                Con4 = " AND (MEDFLAG IN('B','C'))"
            Else
                Con4 = String.Format(" AND (MEDFLAG = '{0}')", strMEDFLAG)
            End If
        Else
            Con4 = String.Format(" AND (MEDFLAG = '{0}')", strMEDFLAG)
        End If


        strWhere = BuildFields(" ", Con1, Con2, Con3, Con4)

        strFormat = "  SELECT "
        strFormat = strFormat & "  taxyearmon,"
        strFormat = strFormat & "  taxno,"
        strFormat = strFormat & "  taxyearmon +'MT'+ dbo.LPAD(taxno, 5, '0') billno,"
        strFormat = strFormat & "  clientname,"
        strFormat = strFormat & "  clientbisno,"
        strFormat = strFormat & "  real_med_name,"
        strFormat = strFormat & "  real_med_bisno,"
        strFormat = strFormat & "  isnull(amt,0) amt,"
        strFormat = strFormat & "  isnull(vat,0) vat,"
        strFormat = strFormat & "  isnull(amt,0) + isnull(vat,0) sumamtvat,"
        strFormat = strFormat & "  summ"
        strFormat = strFormat & "  FROM MD_TRUTAX_HDR"
        strFormat = strFormat & "  WHERE 1=1"
        strFormat = strFormat & "  {0} "
        strFormat = strFormat & "  AND ISNULL(ATTR10,0) <> 999999"
        strFormat = strFormat & "  ORDER BY TAXNO"

        strSQL = String.Format(strFormat, strWhere)

        '기본정보 Setting
        With mobjSCGLConfig '기본정보 Config 개체
            Try
                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                ' ------ Array 데이터 조회 (True 일때 헤더정보 포함 조회(Sheet Data Binding 할 경우 사용), False 일때 데이터만 조회)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)

                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "GROUP BLOCK : 외부에 공개 Method"
    Public Function Get_SENDED_TAX(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strTAXYEARMON As String, _
                                   ByVal strCLIENTCODE As String, _
                                   ByVal strMEDFLAG As String, _
                                   ByVal strGUBUN As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)
            If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (a.CLIENTCODE = '{0}')", strCLIENTCODE)

            If strGUBUN = "PRINT" Then
                If strMEDFLAG = "" Then
                    Con3 = " AND (a.MEDFLAG IN('B','C'))"
                Else
                    Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
                End If
            ElseIf strGUBUN = "ELEC" Then
                Con3 = String.Format(" AND A.REAL_MED_CODE NOT IN('B00107','B00108','B00109','B00110','B00111') AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            Else

                Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            End If

            strWhere = BuildFields(" ", Con1, Con2, Con3)

            strFormat = "  select 0 CHK, "
            strFormat = strFormat & "  case when isnull(a.rmsno,'') = '' then '미전송'"
            strFormat = strFormat & "  else"
            strFormat = strFormat & "  	case when (isnull(b.send_gbn,'') = 'Y' and isnull(b.endflag,'') = 'N') then '진행중'"
            strFormat = strFormat & "  	when (isnull(b.send_gbn,'') = 'N' and isnull(b.endflag,'') = 'Y') then '미전송'"
            strFormat = strFormat & "  	else '' "
            strFormat = strFormat & "  	end"
            strFormat = strFormat & "  end as STAT,"
            strFormat = strFormat & "  a.TAXYEARMON, a.TAXNO, a.MEDFLAG, '5000' companycd,"
            strFormat = strFormat & "  case a.clientcode when 'A00212' then '1'+'MT'+substring(A.DEMANDDAY,1,6) +  dbo.LPAD(a.taxno, 5, '0') else '2'+'MT'+substring(A.DEMANDDAY,1,6) +  dbo.LPAD(a.taxno, 5, '0') end billno,"
            strFormat = strFormat & "  substring(a.taxyearmon,1,4) fiscallyy,"
            strFormat = strFormat & "  case isnull(c.billflag,'') when '' then case isnull(vat,0) when 0 then '02' else '01' end else c.billflag end  billflag,"
            strFormat = strFormat & "  replace(a.real_med_bisno,'-','') suppbsn,"
            strFormat = strFormat & "  rtrim(a.real_med_name) suppldscr,"
            strFormat = strFormat & "  rtrim(a.real_medowner) suppceo,"
            strFormat = strFormat & "  rtrim(a.real_medaddr1) + ' ' + rtrim(a.real_medaddr2) suppaddr,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busitype_fun(a.real_med_code)) suppbusicond,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busistat_fun(a.real_med_code)) suppbusiitem,"
            strFormat = strFormat & "  replace(a.clientbisno,'-','') buybsn,"
            strFormat = strFormat & "  rtrim(a.clientname) buyldscr,"
            strFormat = strFormat & "  rtrim(a.clientowner) buyceo,"
            strFormat = strFormat & "  rtrim(a.clientaddr1) + ' ' + rtrim(a.clientaddr2) buyaddr,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busitype_fun(a.clientcode)) buybusicond,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busistat_fun(a.clientcode)) buybusiitem,"
            strFormat = strFormat & "  a.demandday regdate,"
            strFormat = strFormat & "  isnull(a.amt,0) + isnull(a.vat,0) totamt,"
            strFormat = strFormat & "  isnull(a.amt,0) suppamt,"
            strFormat = strFormat & "  isnull(a.vat,0) vatamt,"
            strFormat = strFormat & "  '에스케이 플래닛 (주) - 위수탁세금계산서' billrmrk,"
            strFormat = strFormat & "  '에스케이 플래닛 (주)' title,"
            strFormat = strFormat & "  case c.reqflag when '' then '02' else c.reqflag end reqflag,"
            strFormat = strFormat & "  'R1' normflag,"
            strFormat = strFormat & "  a.CUSER receiptid,"
            strFormat = strFormat & "  dbo.sc_empno_dept_name_fun(a.cuser) receiptnm,"
            strFormat = strFormat & "  dbo.sc_empno_dept_code_fun(a.cuser) purteamcd,"
            strFormat = strFormat & "  a.printday insdate,"
            strFormat = strFormat & "  '1' billseq,"
            strFormat = strFormat & "  substring(a.demandday,5,4) suppdate,"
            strFormat = strFormat & "  a.summ itemnm,"
            strFormat = strFormat & "  '' size,"
            strFormat = strFormat & "  '' qty,"
            strFormat = strFormat & "  '' unitprc,"
            strFormat = strFormat & "  '' itemrmrk,"
            strFormat = strFormat & "  '' edittypecd,"
            strFormat = strFormat & "  '' firstbillno,"
            strFormat = strFormat & "  case isnull(c.buynm,'') when '' then  dbo.SC_CUSTEMPNAME_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') else c.buynm end buynm,"
            strFormat = strFormat & "  case isnull(c.buyemail,'') when '' then  dbo.SC_CUSTEMPEMAIL_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') else c.buyemail end buyemail,"
            strFormat = strFormat & "  case isnull(c.suppnm,'') when '' then  dbo.SC_CUSTEMPNAME_FUN(a.taxyearmon, a.taxno, a.medflag, 'R') else c.suppnm end suppnm,"
            strFormat = strFormat & "  case isnull(c.suppemail,'') when '' then  dbo.SC_CUSTEMPEMAIL_FUN(a.taxyearmon, a.taxno, a.medflag, 'R') else c.suppemail end suppemail,"
            strFormat = strFormat & "  case c.sendnts_yn when '' then 'Y' else c.sendnts_yn end sendnts_yn,"
            strFormat = strFormat & "  'Y' istrust_yn,"
            strFormat = strFormat & "  replace(dbo.sc_get_busino_fun('A00212'),'-','') trust_cuscd, "
            strFormat = strFormat & "  a.rmsno,"
            strFormat = strFormat & "  a.errcode,"
            strFormat = strFormat & "  a.clientcode,"
            strFormat = strFormat & "  a.real_med_code,"
            strFormat = strFormat & "  DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') timcode,"
            strFormat = strFormat & "  DBO.SC_GET_CUSTNAME_FUN(DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'C')) timname,"
            strFormat = strFormat & "  DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'R') medcode,"
            strFormat = strFormat & "  DBO.SC_GET_CUSTNAME_FUN(DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'R')) medname"
            strFormat = strFormat & "  from md_trutax_hdr a"
            strFormat = strFormat & "  left join MD_SENDTAXFILE_MST b"
            strFormat = strFormat & "  on a.rmsno = b.rmsno"
            strFormat = strFormat & "  left join md_sendtax_mst c on a.taxyearmon = c.taxyearmon and a.taxno = c.taxno and a.rmsno = c.rmsno"
            strFormat = strFormat & "  where 1=1 {0} "
            strFormat = strFormat & "  and (isnull(a.rmsno,'') = '' "
            strFormat = strFormat & "  OR (isnull(b.send_gbn,'') = 'N' and isnull(b.endflag,'') = 'Y') "
            strFormat = strFormat & "  OR (isnull(b.send_gbn,'') = 'Y' and isnull(b.endflag,'') = 'N'))"
            strFormat = strFormat & "  and a.voch_type in('0','1') "
            strFormat = strFormat & "  and a.clientcode not in(select highcustcode from sc_cust_hdr where isnull(attr10,0) = 1) "
            strFormat = strFormat & "  and ISNULL(a.ATTR10,0) <> 999999"
            strFormat = strFormat & "  order by a.taxno"


            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_TAX")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    Public Function Get_SEND_TAX(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strTAXYEARMON As String, _
                                   ByVal strCLIENTCODE As String, _
                                   ByVal strMEDFLAG As String, _
                                   ByVal strGUBUN As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)
            If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (b.CLIENTCODE = '{0}')", strCLIENTCODE)

            If strGUBUN = "PRINT" Then
                If strMEDFLAG = "" Then
                    Con3 = " AND (a.MEDFLAG IN('B','C'))"
                Else
                    Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
                End If
            Else
                Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            End If

            strWhere = BuildFields(" ", Con1, Con2, Con3)

            strFormat = "  select 0 chk,"
            strFormat = strFormat & "  case when (isnull(m.send_gbn,'') = 'N' and isnull(m.endflag,'') = 'N') then '삭제진행중'"
            strFormat = strFormat & "  else"
            strFormat = strFormat & "  	'전송'"
            strFormat = strFormat & "  end as STAT,"
            strFormat = strFormat & "  a.taxyearmon, a.taxno, a.medflag, a.companycd,"
            strFormat = strFormat & "  a.billno,"
            strFormat = strFormat & "  a.fiscallyy,"
            strFormat = strFormat & "  case isnull(a.billflag,'') when '' then '01' else a.billflag end billflag,"
            strFormat = strFormat & "  a.suppbsn,"
            strFormat = strFormat & "  a.suppldscr,"
            strFormat = strFormat & "  a.suppceo,"
            strFormat = strFormat & "  a.suppaddr,"
            strFormat = strFormat & "  a.suppbusicond,"
            strFormat = strFormat & "  a.suppbusiitem,"
            strFormat = strFormat & "  a.buybsn,"
            strFormat = strFormat & "  a.buyldscr,"
            strFormat = strFormat & "  a.buyceo,"
            strFormat = strFormat & "  a.buyaddr,"
            strFormat = strFormat & "  a.buybusicond,"
            strFormat = strFormat & "  a.buybusiitem,"
            strFormat = strFormat & "  a.regdate,"
            strFormat = strFormat & "  a.totamt,"
            strFormat = strFormat & "  a.suppamt,"
            strFormat = strFormat & "  a.vatamt,"
            strFormat = strFormat & "  a.billrmrk,"
            strFormat = strFormat & "  a.title,"
            strFormat = strFormat & "  a.reqflag,"
            strFormat = strFormat & "  a.normflag,"
            strFormat = strFormat & "  a.receiptid,"
            strFormat = strFormat & "  a.receiptnm,"
            strFormat = strFormat & "  a.purteamcd,"
            strFormat = strFormat & "  a.insdate,"
            strFormat = strFormat & "  a.billseq,"
            strFormat = strFormat & "  a.suppdate,"
            strFormat = strFormat & "  a.itemnm,"
            strFormat = strFormat & "  a.size,"
            strFormat = strFormat & "  a.qty,"
            strFormat = strFormat & "  a.unitprc,"
            strFormat = strFormat & "  a.itemrmrk,"
            strFormat = strFormat & "  a.edittypecd,"
            strFormat = strFormat & "  a.firstbillno,"
            strFormat = strFormat & "  a.buynm,"
            strFormat = strFormat & "  a.buyemail,"
            strFormat = strFormat & "  a.suppnm,"
            strFormat = strFormat & "  a.suppemail,"
            strFormat = strFormat & "  a.sendnts_yn,"
            strFormat = strFormat & "  a.istrust_yn,"
            strFormat = strFormat & "  a.trust_cuscd,"
            strFormat = strFormat & "  a.rmsno, b.errcode"
            strFormat = strFormat & "  from md_sendtax_mst a"
            strFormat = strFormat & "  inner join md_trutax_hdr b"
            strFormat = strFormat & "  on a.rmsno = b.rmsno  "
            strFormat = strFormat & "  and a.taxyearmon = b.taxyearmon  "
            strFormat = strFormat & "  and a.taxno = b.taxno "
            strFormat = strFormat & "  and a.medflag = b.medflag "
            strFormat = strFormat & "  left join MD_SENDTAXFILE_MST m"
            strFormat = strFormat & "  on b.rmsno = m.rmsno"
            strFormat = strFormat & "  where 1=1 and ((isnull(b.rmsno,'') <> '' and isnull(m.send_gbn,'') = 'Y' and isnull(m.endflag,'') = 'Y') or (isnull(b.rmsno,'') <> '' and isnull(m.send_gbn,'') = 'N' and isnull(m.endflag,'') = 'N')) "
            strFormat = strFormat & "  and b.voch_type in('0','1') and ISNULL(b.ATTR10,0) <> 999999 {0} "
            strFormat = strFormat & "  order by taxno"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SEND_TAX")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    Public Function Get_SENDED_TAX_NO(ByVal strInfoXML As String, _
                                      ByRef intRowCnt As Integer, _
                                      ByRef intColCnt As Integer, _
                                      ByVal strTAXYEARMON As String, _
                                      ByVal strCLIENTCODE As String, _
                                      ByVal strMEDFLAG As String, _
                                      ByVal strGUBUN As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)
            If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (a.CLIENTCODE = '{0}')", strCLIENTCODE)

            If strGUBUN = "PRINT" Then
                If strMEDFLAG = "" Then
                    Con3 = " AND (a.MEDFLAG IN('B','C'))"
                Else
                    Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
                End If
            ElseIf strGUBUN = "ELEC" Then
                Con3 = String.Format(" AND A.REAL_MED_CODE IN('B00107','B00108','B00109','B00110','B00111') AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            Else

                Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            End If

            strWhere = BuildFields(" ", Con1, Con2, Con3)

            strFormat = "  select '' CHK, "
            strFormat = strFormat & "  case when isnull(a.rmsno,'') = '' then '미전송'"
            strFormat = strFormat & "  else"
            strFormat = strFormat & "  	case when (isnull(b.send_gbn,'') = 'Y' and isnull(b.endflag,'') = 'N') then '진행중'"
            strFormat = strFormat & "  	when (isnull(b.send_gbn,'') = 'N' and isnull(b.endflag,'') = 'Y') then '미전송'"
            strFormat = strFormat & "  	else '' "
            strFormat = strFormat & "  	end"
            strFormat = strFormat & "  end as STAT,"
            strFormat = strFormat & "  a.TAXYEARMON, a.TAXNO, a.MEDFLAG, '5000' companycd,"
            strFormat = strFormat & "  case a.clientcode when 'A00212' then '1'+'MT'+substring(A.DEMANDDAY,1,6) +  dbo.LPAD(a.taxno, 5, '0') else '2'+'MT'+substring(A.DEMANDDAY,1,6) +  dbo.LPAD(a.taxno, 5, '0') end billno,"
            strFormat = strFormat & "  substring(a.taxyearmon,1,4) fiscallyy,"
            strFormat = strFormat & "  case isnull(vat,0) when 0 then '02' else '01' end billflag,"
            strFormat = strFormat & "  replace(a.real_med_bisno,'-','') suppbsn,"
            strFormat = strFormat & "  rtrim(a.real_med_name) suppldscr,"
            strFormat = strFormat & "  rtrim(a.real_medowner) suppceo,"
            strFormat = strFormat & "  rtrim(a.real_medaddr1) + ' ' + rtrim(a.real_medaddr2) suppaddr,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busitype_fun(a.real_med_code)) suppbusicond,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busistat_fun(a.real_med_code)) suppbusiitem,"
            strFormat = strFormat & "  replace(a.clientbisno,'-','') buybsn,"
            strFormat = strFormat & "  rtrim(a.clientname) buyldscr,"
            strFormat = strFormat & "  rtrim(a.clientowner) buyceo,"
            strFormat = strFormat & "  rtrim(a.clientaddr1) + ' ' + rtrim(a.clientaddr2) buyaddr,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busitype_fun(a.clientcode)) buybusicond,"
            strFormat = strFormat & "  rtrim(dbo.sc_get_busistat_fun(a.clientcode)) buybusiitem,"
            strFormat = strFormat & "  a.demandday regdate,"
            strFormat = strFormat & "  isnull(a.amt,0) + isnull(a.vat,0) totamt,"
            strFormat = strFormat & "  isnull(a.amt,0) suppamt,"
            strFormat = strFormat & "  isnull(a.vat,0) vatamt,"
            strFormat = strFormat & "  '에스케이 플래닛 (주) - 위수탁세금계산서' billrmrk,"
            strFormat = strFormat & "  '에스케이 플래닛 (주)' title,"
            strFormat = strFormat & "  '02' reqflag,"
            strFormat = strFormat & "  'R1' normflag,"
            strFormat = strFormat & "  a.CUSER receiptid,"
            strFormat = strFormat & "  dbo.sc_empno_dept_name_fun(a.cuser) receiptnm,"
            strFormat = strFormat & "  dbo.sc_empno_dept_code_fun(a.cuser) purteamcd,"
            strFormat = strFormat & "  a.printday insdate,"
            strFormat = strFormat & "  '1' billseq,"
            strFormat = strFormat & "  substring(a.demandday,5,4) suppdate,"
            strFormat = strFormat & "  a.summ itemnm,"
            strFormat = strFormat & "  '' size,"
            strFormat = strFormat & "  '' qty,"
            strFormat = strFormat & "  '' unitprc,"
            strFormat = strFormat & "  '' itemrmrk,"
            strFormat = strFormat & "  '' edittypecd,"
            strFormat = strFormat & "  '' firstbillno,"
            strFormat = strFormat & "  dbo.SC_CUSTEMPNAME_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') buynm,"
            strFormat = strFormat & "  dbo.SC_CUSTEMPEMAIL_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') buyemail,"
            strFormat = strFormat & "  dbo.SC_CUSTEMPNAME_FUN(a.taxyearmon, a.taxno, a.medflag, 'R') suppnm,"
            strFormat = strFormat & "  dbo.SC_CUSTEMPEMAIL_FUN(a.taxyearmon, a.taxno, a.medflag, 'R')suppemail,"
            strFormat = strFormat & "  'Y' sendnts_yn,"
            strFormat = strFormat & "  'Y' istrust_yn,"
            strFormat = strFormat & "  replace(dbo.sc_get_busino_fun('A00212'),'-','') trust_cuscd, "
            strFormat = strFormat & "  a.rmsno,"
            strFormat = strFormat & "  a.errcode,"
            strFormat = strFormat & "  a.clientcode,"
            strFormat = strFormat & "  a.real_med_code,"
            strFormat = strFormat & "  DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'C') timcode,"
            strFormat = strFormat & "  DBO.SC_GET_CUSTNAME_FUN(DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'C')) timname,"
            strFormat = strFormat & "  DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'R') medcode,"
            strFormat = strFormat & "  DBO.SC_GET_CUSTNAME_FUN(DBO.SC_CUSTEMPCUSTCODE_FUN(a.taxyearmon, a.taxno, a.medflag, 'R')) medname"
            strFormat = strFormat & "  from md_trutax_hdr a"
            strFormat = strFormat & "  left join MD_SENDTAXFILE_MST b"
            strFormat = strFormat & "  on a.rmsno = b.rmsno"
            strFormat = strFormat & "  where 1=1 {0} "
            strFormat = strFormat & "  and (isnull(a.rmsno,'') = '' "
            strFormat = strFormat & "  OR (isnull(b.send_gbn,'') = 'N' and isnull(b.endflag,'') = 'Y') "
            strFormat = strFormat & "  OR (isnull(b.send_gbn,'') = 'Y' and isnull(b.endflag,'') = 'N'))"
            strFormat = strFormat & "  and a.voch_type in('0','1') "
            strFormat = strFormat & "  and a.clientcode in(select highcustcode from sc_cust_hdr where isnull(attr10,0) = 1) "
            strFormat = strFormat & "  and ISNULL(a.ATTR10,0) <> 999999"
            strFormat = strFormat & "  order by a.taxno"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_TAX")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    Public Function SelectRtn_RMSNO(ByVal strInfoXML As String, ByVal strYEARMON As String) As Object
        '여기부터 단순조회
        Dim strSQL, strFormat, strRtn As String
        Dim intRowCnt As Double
        Dim intColCnt As Double
        Dim vntData As Object

        SetConfig(strInfoXML) '기본정보 Setting
        With mobjSCGLConfig '기본정보 Config 개체
            Try
                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = " select "
                strSQL = strSQL & " '" & strYEARMON & "' yearmon,"
                strSQL = strSQL & " isnull(max(seq),0)+1 seq,"
                strSQL = strSQL & " '0918RMS601.' + CAST(DATEPART(YEAR,GETDATE()) AS VARCHAR(4))  "
                strSQL = strSQL & " + RIGHT('00' + CAST(DATEPART(MONTH,GETDATE()) AS VARCHAR(2)), 2)"
                strSQL = strSQL & " + RIGHT('00' + CAST(DATEPART(DAY,GETDATE()) AS VARCHAR(2)), 2)"
                strSQL = strSQL & " +'.'"
                strSQL = strSQL & " + RIGHT('00' + CAST(DATENAME(HH, GETDATE()) AS VARCHAR(2)),2)"
                strSQL = strSQL & " + RIGHT('00' + CAST(DATENAME(MI, GETDATE()) AS VARCHAR(2)),2)"
                strSQL = strSQL & " + RIGHT('00' + CAST(DATENAME(SS, GETDATE()) AS VARCHAR(2)),2)"
                strSQL = strSQL & " AS RMSNO"
                strSQL = strSQL & " from MD_SENDTAXFILE_MST"
                strSQL = strSQL & " where yearmon = '" & strYEARMON & "'"

                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)

                Return vntData
            Catch err As Exception
                ' 오류 전송
                '.mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_RMSNO")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
        '여기까지 단순조회
    End Function


    Public Function ProcessRtn_SENDTAX(ByVal strInfoXML As String, _
                                       ByVal vntData As Object, _
                                       ByVal strSENDGUBUN As String, _
                                       ByVal strSAVEYEARMON As String, _
                                       ByVal strSAVESEQ As Double, _
                                       ByVal strSAVERMSNO As String) As Integer

        Dim intRtn As Integer '결과값 변수
        Dim i, intColCnt, intRows As Integer '루프, 컬럼Cnt, 로우Cnt 변수
        Dim strCANCEL_YN
        Dim strBILLRMRK
        Dim strSEND_GBN

        '테스트
        SetConfig(strInfoXML) '기본정보 Setting
        With mobjSCGLConfig '기본정보를 가지고 있는 Config 개체
            Try

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                mobjceMD_SENDTAX_MST = New ceMD_SENDTAX_MST(mobjSCGLConfig)
                mobjceMD_SENDTAXFILE_MST = New ceMD_SENDTAXFILE_MST(mobjSCGLConfig)

                If strSENDGUBUN = "SEND" Then
                    strSEND_GBN = "Y"
                Else
                    strSEND_GBN = "N"
                End If

                mobjceMD_SENDTAXFILE_MST.FileInsertDo(strSAVEYEARMON, strSAVESEQ, strSAVERMSNO, "N", strSEND_GBN)

                intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)
                '''해당하는Row 만큼 Loop
                For i = 1 To intRows
                    ''' FLAG 조사 - INSERT/UPDATE 조사
                    If GetElement(vntData, "CHK", intColCnt, i, OPTIONAL_STR) = "1" Then
                        If strSENDGUBUN = "SEND" Then
                            strCANCEL_YN = "N"
                        Else
                            strCANCEL_YN = "Y"
                        End If

                        If GetElement(vntData, "EDITTYPECD", intColCnt, i, OPTIONAL_STR) = "01" Then
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서 (기재사항 정정.착오)"
                        ElseIf GetElement(vntData, "EDITTYPECD", intColCnt, i, OPTIONAL_STR) = "02" Then
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서 (공급가액의 변동)"
                        ElseIf GetElement(vntData, "EDITTYPECD", intColCnt, i, OPTIONAL_STR) = "03" Then
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서 (환입)"
                        ElseIf GetElement(vntData, "EDITTYPECD", intColCnt, i, OPTIONAL_STR) = "04" Then
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서 (계약의해제)"
                        ElseIf GetElement(vntData, "EDITTYPECD", intColCnt, i, OPTIONAL_STR) = "05" Then
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서 (내국신용장개설)"
                        Else
                            strBILLRMRK = "에스케이 플래닛 (주)  - 위수탁세금계산서"
                        End If

                        '헤더저장
                        intRtn = InsertRtn_MD_SENDTAX_MST(vntData, intColCnt, i, strCANCEL_YN, strSAVERMSNO, strBILLRMRK)
                        intRtn = UpdateRtn_RMSNO_MD_TRUTAX_HDR(vntData, intColCnt, i, strSAVERMSNO, strCANCEL_YN)
                    End If
                Next
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_SENDTAX")
            Finally
                'Resource해제
                mobjceMD_SENDTAX_MST.Dispose()
                mobjceMD_SENDTAXFILE_MST.Dispose()
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    Public Function Get_SENDED_CUST_LIST(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strTAXYEARMON As String, _
                                         ByVal strMEDFLAG As String, _
                                         ByVal strGUBUN As String, _
                                         ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)
            'If strCLIENTCODE <> "" Then Con2 = String.Format(" AND (a.CLIENTCODE = '{0}')", strCLIENTCODE)

            If strGUBUN = "PRINT" Then
                If strMEDFLAG = "" Then
                    Con3 = " AND (a.MEDFLAG IN('B','C'))"
                Else
                    Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
                End If
            ElseIf strGUBUN = "ELEC" Then
                Con3 = String.Format(" AND A.REAL_MED_CODE IN('B00107','B00108','B00109','B00110','B00111') AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            Else

                Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            End If

            strWhere = BuildFields(" ", Con1, Con3)

            strFormat = " select "
            strFormat = strFormat & " seq, medflagname, timname, billflag, mattername, memo, real_med_name, real_med_bisno,"
            strFormat = strFormat & " demandday, amt, "
            strFormat = strFormat & " case vat when 0 then null else vat end vat ,"
            strFormat = strFormat & " emp_name, "
            strFormat = strFormat & " emp_hp, "
            strFormat = strFormat & " emp_email,"
            strFormat = strFormat & " bigo, "
            strFormat = strFormat & " '' summ_date1,"
            strFormat = strFormat & " case a.timcode when 'A00019' then "
            strFormat = strFormat & " 	case a.voch_type when 1 then "
            strFormat = strFormat & " 		case when dbo.INSTR(1, mattername, '기사협찬') <> 0 then '기사협찬'"
            strFormat = strFormat & " 		else "
            strFormat = strFormat & " 			case right(rtrim(memo),2) when '협찬' then memo"
            strFormat = strFormat & " 			else memo + ' 협찬'"
            strFormat = strFormat & " 			end"
            strFormat = strFormat & " 		end"
            strFormat = strFormat & " 	else"
            strFormat = strFormat & " 		'인쇄광고 - ' + medname"
            strFormat = strFormat & " 	end"
            strFormat = strFormat & " else"
            strFormat = strFormat & " 	case a.voch_type when 1 then '협찬광고 - ' + medname"
            strFormat = strFormat & " 	else "
            strFormat = strFormat & " 		case medflag when 'B' then '신문 - ' + mattername + ' - ' + timname"
            strFormat = strFormat & " 		else '인쇄광고 - ' + medname"
            strFormat = strFormat & " 		end"
            strFormat = strFormat & " 	end"
            strFormat = strFormat & " end as summ1,"
            strFormat = strFormat & " '' summ_std1,"
            strFormat = strFormat & " '' summ_qty1,"
            strFormat = strFormat & " '' summ_price1,"
            strFormat = strFormat & " amt summ_amt1,"
            strFormat = strFormat & " case vat when 0 then null else vat end summ_vat1,"
            strFormat = strFormat & " '' summ_memo1,"
            strFormat = strFormat & " '' summ_date2,"
            strFormat = strFormat & " '' summ2,"
            strFormat = strFormat & " '' summ_std2,"
            strFormat = strFormat & " '' summ_qty2,"
            strFormat = strFormat & " '' summ_price2,"
            strFormat = strFormat & " '' summ_amt2,"
            strFormat = strFormat & " '' summ_vat2,"
            strFormat = strFormat & " '' summ_memo2,"
            strFormat = strFormat & " '' summ_date3,"
            strFormat = strFormat & " '' summ3,"
            strFormat = strFormat & " '' summ_std3,"
            strFormat = strFormat & " '' summ_qty3,"
            strFormat = strFormat & " '' summ_price3,"
            strFormat = strFormat & " '' summ_amt3,"
            strFormat = strFormat & " '' summ_vat3,"
            strFormat = strFormat & " '' summ_memo3,"
            strFormat = strFormat & " '' summ_date4,"
            strFormat = strFormat & " '' summ4,"
            strFormat = strFormat & " '' summ_std4,"
            strFormat = strFormat & " '' summ_qty4,"
            strFormat = strFormat & " '' summ_price4,"
            strFormat = strFormat & " '' summ_amt4,"
            strFormat = strFormat & " '' summ_vat4,"
            strFormat = strFormat & " '' summ_memo4"
            strFormat = strFormat & " from ("
            strFormat = strFormat & " 	select "
            strFormat = strFormat & " 	b.seq,"
            strFormat = strFormat & " 	case a.medflag when 'B' then '신문'"
            strFormat = strFormat & " 	when 'C' then '잡지'"
            strFormat = strFormat & " 	end medflagname,"
            strFormat = strFormat & " 	dbo.sc_get_custname_fun(a.timcode) timname,"
            strFormat = strFormat & " 	case isnull(a.vat,0) when 0 then '계산서'"
            strFormat = strFormat & " 	else '' end as billflag,"
            strFormat = strFormat & " 	DBO.MD_GET_MATTERNAME_FUN(b.mattercode) mattername,"
            strFormat = strFormat & " 	b.memo,"
            strFormat = strFormat & " 	c.real_med_name,"
            strFormat = strFormat & " 	REPLACE(c.real_med_bisno,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " 	c.DEMANDDAY,"
            strFormat = strFormat & " 	isnull(a.amt,0) amt,"
            strFormat = strFormat & " 	isnull(a.vat,0) vat,"
            strFormat = strFormat & " 	dbo.SC_GET_CUSTOWNERNAME_FUN(a.medcode) emp_name,"
            strFormat = strFormat & " 	case isnull(DBO.SC_GET_CUSTOWNERHP_FUN(a.medcode),'') when '' then '010-0000-0000' else DBO.SC_GET_CUSTOWNERHP_FUN(a.medcode) end  emp_hp,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNEREMAIL_FUN(a.medcode) emp_email,"
            strFormat = strFormat & " 	'' bigo, "
            strFormat = strFormat & " 	dbo.sc_get_custname_fun(a.medcode) medname, "
            strFormat = strFormat & " 	a.medflag, a.timcode, a.voch_type"
            strFormat = strFormat & " 	from md_trutax_dtl a"
            strFormat = strFormat & " 	left join md_trutax_hdr c on a.taxyearmon = c.taxyearmon and a.taxno = c.taxno and isnull(c.attr01,0)<> 999999"
            strFormat = strFormat & " 	left join md_booking_medium b"
            strFormat = strFormat & " 	on a.trust_yearmon = b.yearmon and a.trust_seq = b.seq and isnull(b.tru_tax_no,'') <> ''"
            strFormat = strFormat & "  where 1=1 {0} "
            strFormat = strFormat & " 	and a.clientcode = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	and isnull(a.attr10,0) <> 999999"
            strFormat = strFormat & " ) a"
            strFormat = strFormat & " ORDER BY seq"


            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_CUST_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function


    Public Function Get_SEND_CATVCUST_LIST(ByVal strInfoXML As String, _
                                            ByRef intRowCnt As Integer, _
                                            ByRef intColCnt As Integer, _
                                            ByVal strTAXYEARMON As String, _
                                            ByVal strMEDFLAG As String, _
                                            ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            If strMEDFLAG <> "" Then Con2 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)

            strWhere = BuildFields(" ", Con1, Con2)

            'strFormat = " select "
            'strFormat = strFormat & " seq, medflagname, timname, billflag, mattername, memo, real_med_name, real_med_bisno,"
            'strFormat = strFormat & " demandday, amt, "
            'strFormat = strFormat & " case vat when 0 then null else vat end vat ,"
            'strFormat = strFormat & " emp_name, "
            'strFormat = strFormat & " emp_hp, "
            'strFormat = strFormat & " emp_email,"
            'strFormat = strFormat & " bigo, "
            'strFormat = strFormat & " '' summ_date1,"
            'strFormat = strFormat & " '케이블 광고비 - '+ medname as summ1,"
            'strFormat = strFormat & " '' summ_std1,"
            'strFormat = strFormat & " '' summ_qty1,"
            'strFormat = strFormat & " '' summ_price1,"
            'strFormat = strFormat & " amt summ_amt1,"
            'strFormat = strFormat & " vat summ_vat1,"
            'strFormat = strFormat & " '' summ_memo1,"
            'strFormat = strFormat & " '' summ_date2,"
            'strFormat = strFormat & " '' summ2,"
            'strFormat = strFormat & " '' summ_std2,"
            'strFormat = strFormat & " '' summ_qty2,"
            'strFormat = strFormat & " '' summ_price2,"
            'strFormat = strFormat & " '' summ_amt2,"
            'strFormat = strFormat & " '' summ_vat2,"
            'strFormat = strFormat & " '' summ_memo2,"
            'strFormat = strFormat & " '' summ_date3,"
            'strFormat = strFormat & " '' summ3,"
            'strFormat = strFormat & " '' summ_std3,"
            'strFormat = strFormat & " '' summ_qty3,"
            'strFormat = strFormat & " '' summ_price3,"
            'strFormat = strFormat & " '' summ_amt3,"
            'strFormat = strFormat & " '' summ_vat3,"
            'strFormat = strFormat & " '' summ_memo3,"
            'strFormat = strFormat & " '' summ_date4,"
            'strFormat = strFormat & " '' summ4,"
            'strFormat = strFormat & " '' summ_std4,"
            'strFormat = strFormat & " '' summ_qty4,"
            'strFormat = strFormat & " '' summ_price4,"
            'strFormat = strFormat & " '' summ_amt4,"
            'strFormat = strFormat & " '' summ_vat4,"
            'strFormat = strFormat & " '' summ_memo4"
            'strFormat = strFormat & " from ("
            'strFormat = strFormat & " 	select "
            'strFormat = strFormat & " 	b.seq,"
            'strFormat = strFormat & " 	'케이블' medflagname,"
            'strFormat = strFormat & " 	dbo.sc_get_custname_fun(a.timcode) timname,"
            'strFormat = strFormat & " 	case isnull(a.vat,0) when 0 then '계산서'"
            'strFormat = strFormat & " 	else '' end as billflag,"
            'strFormat = strFormat & " 	DBO.MD_GET_MATTERNAME_FUN(b.mattercode) mattername,"
            'strFormat = strFormat & " 	b.memo,"
            'strFormat = strFormat & " 	c.real_med_name,"
            'strFormat = strFormat & " 	REPLACE(c.real_med_bisno,'-','') REAL_MED_BISNO,"
            'strFormat = strFormat & " 	c.DEMANDDAY,"
            'strFormat = strFormat & " 	isnull(a.amt,0) amt,"
            'strFormat = strFormat & " 	isnull(a.vat,0) vat,"
            'strFormat = strFormat & " 	dbo.SC_GET_CUSTOWNERNAME_FUN(a.medcode) emp_name,"
            'strFormat = strFormat & " 	case isnull(DBO.SC_GET_CUSTOWNERHP_FUN(a.medcode),'') when '' then '010-0000-0000' else DBO.SC_GET_CUSTOWNERHP_FUN(a.medcode) end  emp_hp,"
            'strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNEREMAIL_FUN(a.medcode) emp_email,"
            'strFormat = strFormat & " 	'' bigo, "
            'strFormat = strFormat & " 	dbo.sc_get_custname_fun(a.medcode) medname, "
            'strFormat = strFormat & " 	a.medflag, a.timcode, a.voch_type"
            'strFormat = strFormat & " 	from md_trutax_dtl a"
            'strFormat = strFormat & " 	left join md_trutax_hdr c on a.taxyearmon = c.taxyearmon and a.taxno = c.taxno and isnull(c.attr01,0)<> 999999"
            'strFormat = strFormat & " 	left join md_catv_medium b"
            'strFormat = strFormat & " 	on a.trust_yearmon = b.yearmon and a.trust_seq = b.seq and isnull(b.tru_tax_no,'') <> ''"
            'strFormat = strFormat & "  where 1=1 {0} "
            'strFormat = strFormat & " and a.clientcode = '" & strCLIENTCODE & "'  "
            'strFormat = strFormat & " 	and isnull(a.attr10,0) <> 999999"
            'strFormat = strFormat & " ) a"
            'strFormat = strFormat & " ORDER BY seq"



            strFormat = " SELECT "
            strFormat = strFormat & " SEQ, MEDFLAGNAME, TIMNAME, BILLFLAG, MATTERNAME, MEMO, REAL_MED_NAME, REAL_MED_BISNO,"
            strFormat = strFormat & " DEMANDDAY, AMT, "
            strFormat = strFormat & " CASE VAT WHEN 0 THEN NULL ELSE VAT END VAT ,"
            strFormat = strFormat & " EMP_NAME, "
            strFormat = strFormat & " EMP_HP, "
            strFormat = strFormat & " EMP_EMAIL,"
            strFormat = strFormat & " BIGO, "
            strFormat = strFormat & " '' SUMM_DATE1,"
            strFormat = strFormat & " '케이블 광고비 - '+ MEDNAME AS SUMM1,"
            strFormat = strFormat & " '' SUMM_STD1,"
            strFormat = strFormat & " '' SUMM_QTY1,"
            strFormat = strFormat & " '' SUMM_PRICE1,"
            strFormat = strFormat & " AMT SUMM_AMT1,"
            strFormat = strFormat & " VAT SUMM_VAT1,"
            strFormat = strFormat & " '' SUMM_MEMO1,"
            strFormat = strFormat & " '' SUMM_DATE2,"
            strFormat = strFormat & " '' SUMM2,"
            strFormat = strFormat & " '' SUMM_STD2,"
            strFormat = strFormat & " '' SUMM_QTY2,"
            strFormat = strFormat & " '' SUMM_PRICE2,"
            strFormat = strFormat & " '' SUMM_AMT2,"
            strFormat = strFormat & " '' SUMM_VAT2,"
            strFormat = strFormat & " '' SUMM_MEMO2,"
            strFormat = strFormat & " '' SUMM_DATE3,"
            strFormat = strFormat & " '' SUMM3,"
            strFormat = strFormat & " '' SUMM_STD3,"
            strFormat = strFormat & " '' SUMM_QTY3,"
            strFormat = strFormat & " '' SUMM_PRICE3,"
            strFormat = strFormat & " '' SUMM_AMT3,"
            strFormat = strFormat & " '' SUMM_VAT3,"
            strFormat = strFormat & " '' SUMM_MEMO3,"
            strFormat = strFormat & " '' SUMM_DATE4,"
            strFormat = strFormat & " '' SUMM4,"
            strFormat = strFormat & " '' SUMM_STD4,"
            strFormat = strFormat & " '' SUMM_QTY4,"
            strFormat = strFormat & " '' SUMM_PRICE4,"
            strFormat = strFormat & " '' SUMM_AMT4,"
            strFormat = strFormat & " '' SUMM_VAT4,"
            strFormat = strFormat & " '' SUMM_MEMO4"
            strFormat = strFormat & " FROM (	"
            strFormat = strFormat & " 	SELECT"
            strFormat = strFormat & "  	A.TAXNO SEQ,"
            strFormat = strFormat & " 	CASE A.MEDFLAG WHEN 'B' THEN '신문'"
            strFormat = strFormat & " 	WHEN 'C' THEN '잡지'"
            strFormat = strFormat & " 	END MEDFLAGNAME,"
            strFormat = strFormat & " 	DBO.MD_TAXTIMNAME_FUN(A.TAXYEARMON, A.TAXNO) TIMNAME,"
            strFormat = strFormat & " 	CASE ISNULL(A.VAT,0) WHEN 0 THEN '계산서'"
            strFormat = strFormat & " 	ELSE '' END AS BILLFLAG,"
            strFormat = strFormat & " 	DBO.MD_TAXMATTERNAME_FUN(A.TAXYEARMON,A.TAXNO) MATTERNAME,"
            strFormat = strFormat & " 	B.MEMO,"
            strFormat = strFormat & " 	A.REAL_MED_NAME,"
            strFormat = strFormat & " 	REPLACE(A.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " 	A.DEMANDDAY,"
            strFormat = strFormat & " 	ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " 	ISNULL(A.VAT,0) VAT,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNERNAME_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) EMP_NAME,"
            strFormat = strFormat & " 	CASE ISNULL(DBO.SC_GET_CUSTOWNERHP_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)),'') WHEN '' THEN '010-0000-0000' ELSE DBO.SC_GET_CUSTOWNERHP_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) END  EMP_HP,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNEREMAIL_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) EMP_EMAIL,"
            strFormat = strFormat & " 	'' BIGO,"
            strFormat = strFormat & " 	DBO.MD_TAXMEDNAME_FUN(A.TAXYEARMON, A.TAXNO) MEDNAME, "
            strFormat = strFormat & " 	A.MEDFLAG, DBO.MD_TAXTIMCODE_FUN(A.TAXYEARMON, A.TAXNO) TIMCODE,"
            strFormat = strFormat & " 	A.VOCH_TYPE"
            strFormat = strFormat & " 	FROM MD_TRUTAX_HDR A LEFT JOIN "
            strFormat = strFormat & " 	("
            strFormat = strFormat & " 		SELECT "
            strFormat = strFormat & " 		A.TAXYEARMON,A.TAXNO,B.MEMO"
            strFormat = strFormat & " 		FROM MD_TRUTAX_DTL A LEFT JOIN MD_CATV_MEDIUM B"
            strFormat = strFormat & " 		ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " 		WHERE 1=1"
            strFormat = strFormat & " 		AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & "       AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	    {0} "
            strFormat = strFormat & " 		GROUP BY A.TAXYEARMON,A.TAXNO,B.MEMO"
            strFormat = strFormat & " 	)B ON A.TAXYEARMON = B.TAXYEARMON AND A.TAXNO = B.TAXNO AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & " 	WHERE 1=1"
            strFormat = strFormat & "   AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	{0} "
            strFormat = strFormat & " 	AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & " ) a"
            strFormat = strFormat & " ORDER BY seq"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SEND_CATVCUST_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function


    Public Function Get_SEND_TOTALCUST_LIST(ByVal strInfoXML As String, _
                                            ByRef intRowCnt As Integer, _
                                            ByRef intColCnt As Integer, _
                                            ByVal strTAXYEARMON As String, _
                                            ByVal strMEDFLAG As String, _
                                            ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            If strMEDFLAG <> "" Then Con2 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)

            strWhere = BuildFields(" ", Con1, Con2)

            strFormat = " select "
            strFormat = strFormat & " seq, medflagname, timname, billflag, mattername, memo, real_med_name, real_med_bisno,"
            strFormat = strFormat & " demandday, amt, "
            strFormat = strFormat & " case vat when 0 then null else vat end vat ,"
            strFormat = strFormat & " emp_name, "
            strFormat = strFormat & " emp_hp, "
            strFormat = strFormat & " emp_email,"
            strFormat = strFormat & " bigo, "
            strFormat = strFormat & " '' summ_date1,"
            strFormat = strFormat & " '종합편성방송 광고비 - '+ medname as summ1,"
            strFormat = strFormat & " '' summ_std1,"
            strFormat = strFormat & " '' summ_qty1,"
            strFormat = strFormat & " '' summ_price1,"
            strFormat = strFormat & " amt summ_amt1,"
            strFormat = strFormat & " vat summ_vat1,"
            strFormat = strFormat & " '' summ_memo1,"
            strFormat = strFormat & " '' summ_date2,"
            strFormat = strFormat & " '' summ2,"
            strFormat = strFormat & " '' summ_std2,"
            strFormat = strFormat & " '' summ_qty2,"
            strFormat = strFormat & " '' summ_price2,"
            strFormat = strFormat & " '' summ_amt2,"
            strFormat = strFormat & " '' summ_vat2,"
            strFormat = strFormat & " '' summ_memo2,"
            strFormat = strFormat & " '' summ_date3,"
            strFormat = strFormat & " '' summ3,"
            strFormat = strFormat & " '' summ_std3,"
            strFormat = strFormat & " '' summ_qty3,"
            strFormat = strFormat & " '' summ_price3,"
            strFormat = strFormat & " '' summ_amt3,"
            strFormat = strFormat & " '' summ_vat3,"
            strFormat = strFormat & " '' summ_memo3,"
            strFormat = strFormat & " '' summ_date4,"
            strFormat = strFormat & " '' summ4,"
            strFormat = strFormat & " '' summ_std4,"
            strFormat = strFormat & " '' summ_qty4,"
            strFormat = strFormat & " '' summ_price4,"
            strFormat = strFormat & " '' summ_amt4,"
            strFormat = strFormat & " '' summ_vat4,"
            strFormat = strFormat & " '' summ_memo4"
            strFormat = strFormat & " from ("
            strFormat = strFormat & " 	    SELECT"
            strFormat = strFormat & " 	    A.TAXNO SEQ,"
            strFormat = strFormat & " 	    '종합편성방송' MEDFLAGNAME,"
            strFormat = strFormat & " 	    DBO.MD_TAXTIMNAME_FUN(A.TAXYEARMON, A.TAXNO) TIMNAME,"
            strFormat = strFormat & " 	    CASE ISNULL(A.VAT,0) WHEN 0 THEN '계산서'"
            strFormat = strFormat & " 	    ELSE '' END AS BILLFLAG,"
            strFormat = strFormat & " 	    DBO.MD_TAXMATTERNAME_FUN(A.TAXYEARMON,A.TAXNO) MATTERNAME,"
            strFormat = strFormat & " 	    B.MEMO,"
            strFormat = strFormat & " 	    A.REAL_MED_NAME,"
            strFormat = strFormat & " 	    REPLACE(A.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " 	    A.DEMANDDAY,"
            strFormat = strFormat & " 	    ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " 	    ISNULL(A.VAT,0) VAT,"
            strFormat = strFormat & " 	    DBO.SC_GET_CUSTOWNERNAME_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) EMP_NAME,"
            strFormat = strFormat & " 	    CASE ISNULL(DBO.SC_GET_CUSTOWNERHP_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)),'') WHEN '' THEN '010-0000-0000' ELSE DBO.SC_GET_CUSTOWNERHP_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) END  EMP_HP,"
            strFormat = strFormat & " 	    DBO.SC_GET_CUSTOWNEREMAIL_FUN(DBO.MD_TAXMEDCODE_FUN(A.TAXYEARMON, A.TAXNO)) EMP_EMAIL,"
            strFormat = strFormat & " 	    '' BIGO,"
            strFormat = strFormat & " 	    DBO.MD_TAXMEDNAME_FUN(A.TAXYEARMON, A.TAXNO) MEDNAME, "
            strFormat = strFormat & " 	    A.MEDFLAG, DBO.MD_TAXTIMCODE_FUN(A.TAXYEARMON, A.TAXNO) TIMCODE,"
            strFormat = strFormat & " 	    A.VOCH_TYPE"
            strFormat = strFormat & " 	    FROM MD_TRUTAX_HDR A LEFT JOIN "
            strFormat = strFormat & " 	    ("
            strFormat = strFormat & " 	    	SELECT "
            strFormat = strFormat & " 	    	A.TAXYEARMON,A.TAXNO,B.MEMO"
            strFormat = strFormat & " 	    	FROM MD_TRUTAX_DTL A LEFT JOIN MD_TOTAL_MEDIUM B"
            strFormat = strFormat & " 	    	ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " 	    	WHERE 1=1"
            strFormat = strFormat & " 	    	AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & "           AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	        {0} "
            strFormat = strFormat & " 	    	GROUP BY A.TAXYEARMON,A.TAXNO,B.MEMO"
            strFormat = strFormat & " 	    )B ON A.TAXYEARMON = B.TAXYEARMON AND A.TAXNO = B.TAXNO AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & " 	    WHERE 1=1"
            strFormat = strFormat & " 	    {0} "
            strFormat = strFormat & "       AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	    AND ISNULL(A.ATTR10,0)<> 999999"
            strFormat = strFormat & " ) a"
            strFormat = strFormat & " ORDER BY seq"


            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SEND_CATVCUST_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '온라인 거래처 발행 대량 업로드 
    Public Function Get_SENDED_INTERNETCUST_LIST(ByVal strInfoXML As String, _
                                                 ByRef intRowCnt As Integer, _
                                                 ByRef intColCnt As Integer, _
                                                 ByVal strTAXYEARMON As String, _
                                                 ByVal strMEDFLAG As String, _
                                                 ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            If strMEDFLAG <> "" Then Con2 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)

            strWhere = BuildFields(" ", Con1, Con2)

            strFormat = strFormat & " SELECT "
            strFormat = strFormat & " SEQ, MEDFLAGNAME, TIMNAME, BILLFLAG, MATTERNAME, MEMO, REAL_MED_NAME, REAL_MED_BISNO,"
            strFormat = strFormat & " DEMANDDAY, AMT, "
            strFormat = strFormat & " CASE VAT WHEN 0 THEN NULL ELSE VAT END VAT ,"
            strFormat = strFormat & " EMP_NAME, "
            strFormat = strFormat & " EMP_HP, "
            strFormat = strFormat & " EMP_EMAIL,"
            strFormat = strFormat & " BIGO, "
            strFormat = strFormat & " '' SUMM_DATE1,"
            strFormat = strFormat & " '온라인 광고비 - '+ MEDNAME AS SUMM1,"
            strFormat = strFormat & " '' SUMM_STD1,"
            strFormat = strFormat & " '' SUMM_QTY1,"
            strFormat = strFormat & " '' SUMM_PRICE1,"
            strFormat = strFormat & " AMT SUMM_AMT1,"
            strFormat = strFormat & " VAT SUMM_VAT1,"
            strFormat = strFormat & " '' SUMM_MEMO1,"
            strFormat = strFormat & " '' SUMM_DATE2,"
            strFormat = strFormat & " '' SUMM2,"
            strFormat = strFormat & " '' SUMM_STD2,"
            strFormat = strFormat & " '' SUMM_QTY2,"
            strFormat = strFormat & " '' SUMM_PRICE2,"
            strFormat = strFormat & " '' SUMM_AMT2,"
            strFormat = strFormat & " '' SUMM_VAT2,"
            strFormat = strFormat & " '' SUMM_MEMO2,"
            strFormat = strFormat & " '' SUMM_DATE3,"
            strFormat = strFormat & " '' SUMM3,"
            strFormat = strFormat & " '' SUMM_STD3,"
            strFormat = strFormat & " '' SUMM_QTY3,"
            strFormat = strFormat & " '' SUMM_PRICE3,"
            strFormat = strFormat & " '' SUMM_AMT3,"
            strFormat = strFormat & " '' SUMM_VAT3,"
            strFormat = strFormat & " '' SUMM_MEMO3,"
            strFormat = strFormat & " '' SUMM_DATE4,"
            strFormat = strFormat & " '' SUMM4,"
            strFormat = strFormat & " '' SUMM_STD4,"
            strFormat = strFormat & " '' SUMM_QTY4,"
            strFormat = strFormat & " '' SUMM_PRICE4,"
            strFormat = strFormat & " '' SUMM_AMT4,"
            strFormat = strFormat & " '' SUMM_VAT4,"
            strFormat = strFormat & " '' SUMM_MEMO4"
            strFormat = strFormat & " FROM ("
            strFormat = strFormat & " 	SELECT "
            strFormat = strFormat & " 	B.SEQ,"
            strFormat = strFormat & " 	'온라인' MEDFLAGNAME,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTNAME_FUN(A.TIMCODE) TIMNAME,"
            strFormat = strFormat & " 	CASE ISNULL(A.VAT,0) WHEN 0 THEN '계산서'"
            strFormat = strFormat & " 	ELSE '' END AS BILLFLAG,"
            strFormat = strFormat & " 	B.MATTERNAME,"
            strFormat = strFormat & " 	B.MEMO,"
            strFormat = strFormat & " 	C.REAL_MED_NAME,"
            strFormat = strFormat & " 	REPLACE(C.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " 	C.DEMANDDAY,"
            strFormat = strFormat & " 	ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " 	ISNULL(A.VAT,0) VAT,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNERNAME_FUN(A.MEDCODE) EMP_NAME,"
            strFormat = strFormat & " 	CASE ISNULL(DBO.SC_GET_CUSTOWNERHP_FUN(A.MEDCODE),'') WHEN '' THEN '010-0000-0000' ELSE DBO.SC_GET_CUSTOWNERHP_FUN(A.MEDCODE) END  EMP_HP,"
            strFormat = strFormat & " 	DBO.SC_GET_CUSTOWNEREMAIL_FUN(A.MEDCODE) EMP_EMAIL,"
            strFormat = strFormat & " 	'' BIGO, "
            strFormat = strFormat & " 	DBO.SC_GET_CUSTNAME_FUN(A.MEDCODE) MEDNAME, "
            strFormat = strFormat & " 	A.MEDFLAG, A.TIMCODE, A.VOCH_TYPE"
            strFormat = strFormat & " 	FROM MD_TRUTAX_DTL A"
            strFormat = strFormat & " 	LEFT JOIN MD_TRUTAX_HDR C ON A.TAXYEARMON = C.TAXYEARMON AND A.TAXNO = C.TAXNO AND ISNULL(C.ATTR01,0)<> 999999"
            strFormat = strFormat & " 	LEFT JOIN MD_INTERNET_MEDIUM B"
            strFormat = strFormat & " 	ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " 	WHERE 1=1{0} "
            strFormat = strFormat & "   AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " 	AND ISNULL(A.ATTR10,0) <> 999999"
            strFormat = strFormat & " ) A"
            strFormat = strFormat & " ORDER BY SEQ"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_INTERNETCUST_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function Get_SENDED_CLIENT_LIST(ByVal strInfoXML As String, _
                                           ByRef intRowCnt As Integer, _
                                           ByRef intColCnt As Integer, _
                                           ByVal strTAXYEARMON As String, _
                                           ByVal strMEDFLAG As String, _
                                           ByVal strGUBUN As String, _
                                           ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            If strGUBUN = "PRINT" Then
                If strMEDFLAG = "" Then
                    Con3 = " AND (a.MEDFLAG IN('B','C'))"
                Else
                    Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
                End If
            ElseIf strGUBUN = "ELEC" Then
                Con3 = String.Format(" AND A.REAL_MED_CODE IN('B00107','B00108','B00109','B00110','B00111') AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            Else
                Con3 = String.Format(" AND (a.MEDFLAG = '{0}')", strMEDFLAG)
            End If

            strWhere = BuildFields(" ", Con1, Con3)

            strFormat = " SELECT "
            strFormat = strFormat & " B.SEQ,"
            strFormat = strFormat & " REPLACE(C.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " DBO.SC_GET_CUSTOWNEREMAIL_FUN(A.MEDCODE) EMP_EMAIL,"
            strFormat = strFormat & " CASE SUBSTRING(A.TAXYEARMON,5,1) WHEN 0 THEN SUBSTRING(A.TAXYEARMON,6,1) + '월 인쇄광고' "
            strFormat = strFormat & " ELSE SUBSTRING(A.TAXYEARMON,5,2) + '월 인쇄광고' "
            strFormat = strFormat & " END TITLE,"
            strFormat = strFormat & " CASE TRU_TAX_FLAG WHEN 'Y' THEN 1 "
            strFormat = strFormat & " ELSE "
            strFormat = strFormat & " 	 CASE A.DUTYFLAG WHEN 'N' THEN 3 	"
            strFormat = strFormat & " 	 ELSE 2 "
            strFormat = strFormat & " 	 END"
            strFormat = strFormat & " END BILLFLAG,"
            strFormat = strFormat & " C.DEMANDDAY REGDATE,"
            strFormat = strFormat & " 'SK플래닛(주)-위수탁' BIGO,"
            strFormat = strFormat & " C.DEMANDDAY DEMANDDAY,"
            strFormat = strFormat & " C.SUMM,"
            strFormat = strFormat & " 'EA' STD,"
            strFormat = strFormat & " 1 QTY,"
            strFormat = strFormat & " ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " ISNULL(A.VAT,0) VAT"
            strFormat = strFormat & " FROM MD_TRUTAX_DTL A"
            strFormat = strFormat & " INNER JOIN MD_TRUTAX_HDR C "
            strFormat = strFormat & " ON A.TAXYEARMON = C.TAXYEARMON AND A.TAXNO = C.TAXNO AND ISNULL(C.ATTR10,0)<> 999999"
            strFormat = strFormat & " LEFT JOIN MD_BOOKING_MEDIUM B"
            strFormat = strFormat & " ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " WHERE 1=1 "
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " and a.clientcode = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " AND ISNULL(A.ATTR10,0) <> 999999"
            strFormat = strFormat & " order by seq"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_CLIENT_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    '케이블 대량 업로드 광고주별 
    Public Function SENDED_CATV_LIST(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strTAXYEARMON As String, _
                                     ByVal strMEDFLAG As String, _
                                     ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            Con3 = " AND (a.MEDFLAG IN('A2'))"

            strWhere = BuildFields(" ", Con1, Con3)

            strFormat = " SELECT "
            strFormat = strFormat & " B.SEQ,"
            strFormat = strFormat & " REPLACE(C.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " DBO.SC_GET_CUSTOWNEREMAIL_FUN(A.MEDCODE) EMP_EMAIL,"
            strFormat = strFormat & " CASE SUBSTRING(A.TAXYEARMON,5,1) WHEN 0 THEN SUBSTRING(A.TAXYEARMON,6,1) + '월 케이블광고' "
            strFormat = strFormat & " ELSE SUBSTRING(A.TAXYEARMON,5,2) + '월 케이블광고' "
            strFormat = strFormat & " END TITLE,"
            strFormat = strFormat & " CASE TRU_TAX_FLAG WHEN 'Y' THEN 1 "
            strFormat = strFormat & " ELSE "
            strFormat = strFormat & " 	 CASE A.DUTYFLAG WHEN 'N' THEN 3 	"
            strFormat = strFormat & " 	 ELSE 2 "
            strFormat = strFormat & " 	 END"
            strFormat = strFormat & " END BILLFLAG,"
            strFormat = strFormat & " C.DEMANDDAY REGDATE,"
            strFormat = strFormat & " 'SK플래닛(주)-위수탁' BIGO,"
            strFormat = strFormat & " C.DEMANDDAY DEMANDDAY,"
            strFormat = strFormat & " C.SUMM,"
            strFormat = strFormat & " 'EA' STD,"
            strFormat = strFormat & " 1 QTY,"
            strFormat = strFormat & " ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " ISNULL(A.VAT,0) VAT"
            strFormat = strFormat & " FROM MD_TRUTAX_DTL A"
            strFormat = strFormat & " INNER JOIN MD_TRUTAX_HDR C "
            strFormat = strFormat & " ON A.TAXYEARMON = C.TAXYEARMON AND A.TAXNO = C.TAXNO AND ISNULL(C.ATTR10,0)<> 999999"
            strFormat = strFormat & " left join md_catv_medium b"
            strFormat = strFormat & " ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " WHERE 1=1"
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " and a.clientcode = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " AND ISNULL(A.ATTR10,0) <> 999999"
            strFormat = strFormat & " ORDER BY SEQ"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SENDED_CATV_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With

    End Function

    '종합편성방송 대량 업로드
    Public Function SENDED_TOTAL_LIST(ByVal strInfoXML As String, _
                                     ByRef intRowCnt As Integer, _
                                     ByRef intColCnt As Integer, _
                                     ByVal strTAXYEARMON As String, _
                                     ByVal strMEDFLAG As String, _
                                     ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2, Con3 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = "" : Con3 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            Con3 = " AND (a.MEDFLAG IN('T'))"

            strWhere = BuildFields(" ", Con1, Con3)

            strFormat = " SELECT "
            strFormat = strFormat & " B.SEQ,"
            strFormat = strFormat & " REPLACE(C.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " DBO.SC_GET_CUSTOWNEREMAIL_FUN(A.MEDCODE) EMP_EMAIL,"
            strFormat = strFormat & " CASE SUBSTRING(A.TAXYEARMON,5,1) WHEN 0 THEN SUBSTRING(A.TAXYEARMON,6,1) + '월 종합편성방송 광고' "
            strFormat = strFormat & " ELSE SUBSTRING(A.TAXYEARMON,5,2) + '월 종합편성방송광고' "
            strFormat = strFormat & " END TITLE,"
            strFormat = strFormat & " CASE TRU_TAX_FLAG WHEN 'Y' THEN 1 "
            strFormat = strFormat & " ELSE "
            strFormat = strFormat & " 	 CASE A.DUTYFLAG WHEN 'N' THEN 3 	"
            strFormat = strFormat & " 	 ELSE 2 "
            strFormat = strFormat & " 	 END"
            strFormat = strFormat & " END BILLFLAG,"
            strFormat = strFormat & " C.DEMANDDAY REGDATE,"
            strFormat = strFormat & " 'SK플래닛(주)-위수탁' BIGO,"
            strFormat = strFormat & " C.DEMANDDAY DEMANDDAY,"
            strFormat = strFormat & " C.SUMM,"
            strFormat = strFormat & " 'EA' STD,"
            strFormat = strFormat & " 1 QTY,"
            strFormat = strFormat & " ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " ISNULL(A.VAT,0) VAT"
            strFormat = strFormat & " FROM MD_TRUTAX_DTL A"
            strFormat = strFormat & " INNER JOIN MD_TRUTAX_HDR C "
            strFormat = strFormat & " ON A.TAXYEARMON = C.TAXYEARMON AND A.TAXNO = C.TAXNO AND ISNULL(C.ATTR10,0)<> 999999"
            strFormat = strFormat & " left join MD_TOTAL_MEDIUM b"
            strFormat = strFormat & " ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " WHERE 1=1"
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " and a.clientcode = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " AND ISNULL(A.ATTR10,0) <> 999999"
            strFormat = strFormat & " ORDER BY SEQ"

            strSQL = String.Format(strFormat, strWhere)
            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SENDED_TOTAL_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '온라인 대량 업로드
    Public Function Get_SENDED_INTERNETCLIENT_LIST(ByVal strInfoXML As String, _
                                                   ByRef intRowCnt As Integer, _
                                                   ByRef intColCnt As Integer, _
                                                   ByVal strTAXYEARMON As String, _
                                                   ByVal strMEDFLAG As String, _
                                                   ByVal strCLIENTCODE As String) As Object

        Dim strSQL As String            'SQL문
        Dim strFormat As String         '임시 SQL문
        Dim strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String

        SetConfig(strInfoXML)   '기본정보 설정
        With mobjSCGLConfig

            Con1 = "" : Con2 = ""

            If strTAXYEARMON <> "" Then Con1 = String.Format(" AND (a.TAXYEARMON = '{0}')", strTAXYEARMON)

            Con2 = " AND (a.MEDFLAG IN('O'))"

            strWhere = BuildFields(" ", Con1, Con2)

            strFormat = " SELECT "
            strFormat = strFormat & " B.SEQ,"
            strFormat = strFormat & " REPLACE(C.REAL_MED_BISNO,'-','') REAL_MED_BISNO,"
            strFormat = strFormat & " DBO.SC_GET_CUSTOWNEREMAIL_FUN(A.MEDCODE) EMP_EMAIL,"
            strFormat = strFormat & " CASE SUBSTRING(A.TAXYEARMON,5,1) WHEN 0 THEN SUBSTRING(A.TAXYEARMON,6,1) + '월 온라인 광고' "
            strFormat = strFormat & " ELSE SUBSTRING(A.TAXYEARMON,5,2) + '월 온라인광고' "
            strFormat = strFormat & " END TITLE,"
            strFormat = strFormat & " CASE TRU_TAX_FLAG WHEN 'Y' THEN 1 "
            strFormat = strFormat & " ELSE "
            strFormat = strFormat & " 	 CASE A.DUTYFLAG WHEN 'N' THEN 3 	"
            strFormat = strFormat & " 	 ELSE 2 "
            strFormat = strFormat & " 	 END"
            strFormat = strFormat & " END BILLFLAG,"
            strFormat = strFormat & " C.DEMANDDAY REGDATE,"
            strFormat = strFormat & " 'SK플래닛(주)-위수탁' BIGO,"
            strFormat = strFormat & " C.DEMANDDAY DEMANDDAY,"
            strFormat = strFormat & " C.SUMM,"
            strFormat = strFormat & " 'EA' STD,"
            strFormat = strFormat & " 1 QTY,"
            strFormat = strFormat & " ISNULL(A.AMT,0) AMT,"
            strFormat = strFormat & " ISNULL(A.VAT,0) VAT"
            strFormat = strFormat & " FROM MD_TRUTAX_DTL A"
            strFormat = strFormat & " INNER JOIN MD_TRUTAX_HDR C "
            strFormat = strFormat & " ON A.TAXYEARMON = C.TAXYEARMON AND A.TAXNO = C.TAXNO AND ISNULL(C.ATTR10,0)<> 999999"
            strFormat = strFormat & " LEFT JOIN MD_INTERNET_MEDIUM b"
            strFormat = strFormat & " ON A.TRUST_YEARMON = B.YEARMON AND A.TRUST_SEQ = B.SEQ AND ISNULL(B.TRU_TAX_NO,'') <> ''"
            strFormat = strFormat & " WHERE 1=1"
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " AND A.CLIENTCODE = '" & strCLIENTCODE & "'  "
            strFormat = strFormat & " AND ISNULL(A.ATTR10,0) <> 999999"
            strFormat = strFormat & " ORDER BY SEQ"

            strSQL = String.Format(strFormat, strWhere)

            '데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_SENDED_INTERNETCLIENT_LIST")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function GetCLIENTLIST(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer) As Object

        Dim strSQL As String
        Dim strChkDate As String = ""
        Dim vntData As Object
        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML)   '기본정보 설정

                .mobjSCGLSql.SQLConnect(.DBConnStr)

                strSQL = strSQL & " SELECT HIGHCUSTCODE, CUSTNAME "
                strSQL = strSQL & " FROM SC_CUST_HDR"
                strSQL = strSQL & " WHERE 1=1 AND ISNULL(ATTR08,0) = 1 "

                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetCLIENTSUBLIST_PRINT")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : 외부에 비공개 Method"
    'InsertRtn_MD_SENDTAX_MST 

    Private Function InsertRtn_MD_SENDTAX_MST(ByVal vntData As Object, _
                                              ByVal intColCnt As Integer, _
                                              ByVal intRow As Integer, _
                                              ByVal strCANCEL_YN As String, _
                                              ByVal strSAVERMSNO As String, _
                                              ByVal strBILLRMRK As String) As Integer

        Dim intRtn As Integer
        intRtn = mobjceMD_SENDTAX_MST.InsertDo( _
                                       GetElement(vntData, "TAXYEARMON", intColCnt, intRow), _
                                       GetElement(vntData, "TAXNO", intColCnt, intRow), _
                                       GetElement(vntData, "MEDFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "COMPANYCD", intColCnt, intRow), _
                                       GetElement(vntData, "BILLNO", intColCnt, intRow), _
                                       GetElement(vntData, "FISCALLYY", intColCnt, intRow), _
                                       GetElement(vntData, "BILLFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPBSN", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPLDSCR", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPCEO", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPADDR", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPBUSICOND", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPBUSIITEM", intColCnt, intRow), _
                                       GetElement(vntData, "BUYBSN", intColCnt, intRow), _
                                       GetElement(vntData, "BUYLDSCR", intColCnt, intRow), _
                                       GetElement(vntData, "BUYCEO", intColCnt, intRow), _
                                       GetElement(vntData, "BUYADDR", intColCnt, intRow), _
                                       GetElement(vntData, "BUYBUSICOND", intColCnt, intRow), _
                                       GetElement(vntData, "BUYBUSIITEM", intColCnt, intRow), _
                                       GetElement(vntData, "REGDATE", intColCnt, intRow), _
                                       GetElement(vntData, "TOTAMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "SUPPAMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "VATAMT", intColCnt, intRow, NULL_NUM, True), _
                                       strBILLRMRK, _
                                       GetElement(vntData, "TITLE", intColCnt, intRow), _
                                       GetElement(vntData, "REQFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "NORMFLAG", intColCnt, intRow), _
                                       GetElement(vntData, "RECEIPTID", intColCnt, intRow), _
                                       GetElement(vntData, "RECEIPTNM", intColCnt, intRow), _
                                       GetElement(vntData, "PURTEAMCD", intColCnt, intRow), _
                                       GetElement(vntData, "INSDATE", intColCnt, intRow), _
                                       GetElement(vntData, "BILLSEQ", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPDATE", intColCnt, intRow), _
                                       GetElement(vntData, "ITEMNM", intColCnt, intRow), _
                                       GetElement(vntData, "SIZE", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "QTY", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "UNITPRC", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ITEMRMRK", intColCnt, intRow), _
                                       GetElement(vntData, "EDITTYPECD", intColCnt, intRow), _
                                       GetElement(vntData, "FIRSTBILLNO", intColCnt, intRow), _
                                       GetElement(vntData, "BUYNM", intColCnt, intRow), _
                                       GetElement(vntData, "BUYEMAIL", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPNM", intColCnt, intRow), _
                                       GetElement(vntData, "SUPPEMAIL", intColCnt, intRow), _
                                       strCANCEL_YN, _
                                       GetElement(vntData, "SENDNTS_YN", intColCnt, intRow), _
                                       GetElement(vntData, "ISTRUST_YN", intColCnt, intRow), _
                                       GetElement(vntData, "TRUST_CUSCD", intColCnt, intRow), _
                                       strSAVERMSNO, _
                                       GetElement(vntData, "ATTR01", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR02", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR03", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR04", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR05", intColCnt, intRow), _
                                       GetElement(vntData, "ATTR06", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR07", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR08", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR09", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData, "ATTR10", intColCnt, intRow, NULL_NUM, True))
        Return intRtn
    End Function

    Private Function UpdateRtn_RMSNO_MD_TRUTAX_HDR(ByVal vntData As Object, _
                                                   ByVal intColCnt As Integer, _
                                                   ByVal intRow As Integer, _
                                                   ByVal strSAVERMSNO As String, _
                                                   ByVal strCANCEL_YN As String) As Integer

        Dim intRtn As Integer
        intRtn = mobjceMD_SENDTAXFILE_MST.UpdateRtn_RMSNO_MD_TRUTAX_HDR( _
                                       GetElement(vntData, "TAXYEARMON", intColCnt, intRow), _
                                       GetElement(vntData, "TAXNO", intColCnt, intRow), _
                                       GetElement(vntData, "MEDFLAG", intColCnt, intRow), _
                                       strSAVERMSNO, _
                                       strCANCEL_YN)
        Return intRtn
    End Function
#End Region
End Class
