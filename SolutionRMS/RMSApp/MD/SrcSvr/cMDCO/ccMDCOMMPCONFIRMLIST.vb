'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccMDCMDEPTMST.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 
'            2) 
'****************************************************************************************

Imports System.Xml                  ' XML처리
Imports SCGLControl                 ' ControlClass의 Base Class
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr          '오류처리 클래스
Imports SCGLUtil.cbSCGLXml          'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil         '기타유틸리티 클래스
Imports eMDCO                       '엔터티 추가

' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트

Public Class ccMDCOMMPCONFIRMLIST
    Inherits ccControl
#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccMDCOMMPCONFIRMLIST"                  '자신의 클래스명
    Private mobjceMD_MMP_MEDIUM As eMDCO.ceMD_MMP_MEDIUM '사용할 Entity 변수 선언
    Private mobjceMD_MMP_LIST As eMDCO.ceMD_MMP_LIST '사용할 Entity 변수 선언
    Private mobjceMD_TRANS_TEMP As eMDCO.ceMD_TRANS_TEMP

#End Region

#Region "GROUP BLOCK : 외부에비공개"
    Public Function SelectRtn_HDR(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByVal strYEARMON As String, _
                                  ByVal strCLIENTNAME As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String

        Con1 = "" : Con2 = ""

        SetConfig(strInfoXML)   '기본정보 설정

        With mobjSCGLConfig

            If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = '{0}')", strYEARMON)
            If strCLIENTNAME <> "" Then Con2 = String.Format(" AND (DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) LIKE '%{0}%')", strCLIENTNAME)

            strWhere = BuildFields(" ", Con1, Con2)

            strFormat = " SELECT "
            strFormat = strFormat & " 0 CHK, "
            strFormat = strFormat & " CASE ISNULL(CONFIRMFLAG,'N') WHEN 'N' THEN '' ELSE '0' END CONFIRMGBN,"
            strFormat = strFormat & " YEARMON, SEQ, "
            strFormat = strFormat & " CLIENTCODE, "
            strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
            strFormat = strFormat & " REAL_MED_CODE,"
            strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
            strFormat = strFormat & " DEPT_CD,"
            strFormat = strFormat & " DBO.SC_DEPT_NAME_FUN(DEPT_CD) DEPT_NAME,"
            strFormat = strFormat & " DEMANDDAY,"
            strFormat = strFormat & " ISNULL(AMT,0) AMT,"
            strFormat = strFormat & " DBO.SC_MMPRATE_FUN(YEARMON) RATE,"
            strFormat = strFormat & " ISNULL(MMP_AMT,0) MMP_AMT,"
            strFormat = strFormat & " ISNULL(CONFIRMFLAG,'N') CONFIRMFLAG,"
            strFormat = strFormat & " REQUEST_USER,"
            strFormat = strFormat & " REQUEST_DATE,"
            strFormat = strFormat & " CONFIRM_USER,"
            strFormat = strFormat & " CONFIRM_DATE"
            strFormat = strFormat & " FROM MD_MMP_MEDIUM"
            strFormat = strFormat & " WHERE 1=1 "
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " ORDER BY SEQ "

            '데이터 조회
            Try
                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_HDR")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_DTL(ByVal strInfoXML As String, _
                                  ByRef intRowCnt As Integer, _
                                  ByRef intColCnt As Integer, _
                                  ByVal strYEARMON As String, _
                                  ByVal lngSEQ As Double, _
                                  ByVal strCLIENTCODE As String, _
                                  ByVal strREQUEST_USER As String) As Object

        Dim strSQL, strFormat As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        With mobjSCGLConfig

            If strREQUEST_USER <> "" Then
                strFormat = " SELECT "
                strFormat = strFormat & " YEARMON, SEQ,"
                strFormat = strFormat & " CLIENTCODE,"
                strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormat = strFormat & " CASE MED_FLAG WHEN 'A' THEN '전파' "
                strFormat = strFormat & " WHEN 'B' THEN '인쇄'"
                strFormat = strFormat & " WHEN 'C' THEN '인쇄'"
                strFormat = strFormat & " WHEN 'A2' THEN '케이블'"
                strFormat = strFormat & " WHEN 'T' THEN '종편'"
                strFormat = strFormat & " WHEN 'O' THEN '온라인'"
                strFormat = strFormat & " WHEN 'D' THEN '옥외' END MED_FLAG,"
                strFormat = strFormat & " ISNULL(AMTSUM,0) AMTSUM,"
                strFormat = strFormat & " ISNULL(AMT,0) AMT,"
                strFormat = strFormat & " RATE,"
                strFormat = strFormat & " ISNULL(HDR_AMT,0) HDR_AMT,"
                strFormat = strFormat & " ISNULL(DIVAMT,0) DIVAMT"
                strFormat = strFormat & " FROM MD_MMP_LIST"
                strFormat = strFormat & " WHERE 1=1"
                strFormat = strFormat & " AND MED_FLAG <> 'A'"
                strFormat = strFormat & " AND YEARMON = '" & strYEARMON & "'"
                strFormat = strFormat & " AND SEQ = '" & lngSEQ & "'"
                strFormat = strFormat & " AND CLIENTCODE = '" & strCLIENTCODE & "'"
            Else
                '지원팀 이윤숙 플래너님 케이블만 보여줘야 한다고 말씀 하셔서 수정 결국mmp금액은 케이블로 한정
                strFormat = " SELECT "
                strFormat = strFormat & " YEARMON, '' SEQ,"
                strFormat = strFormat & " CLIENTCODE,"
                strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
                strFormat = strFormat & " CASE MED_FLAG WHEN 'A' THEN '전파' "
                strFormat = strFormat & " WHEN 'B' THEN '인쇄'"
                strFormat = strFormat & " WHEN 'C' THEN '인쇄'"
                strFormat = strFormat & " WHEN 'A2' THEN '케이블'"
                strFormat = strFormat & " WHEN 'T' THEN '종편'"
                strFormat = strFormat & " WHEN 'O' THEN '온라인'"
                strFormat = strFormat & " WHEN 'D' THEN '옥외' END MED_FLAG,"
                strFormat = strFormat & " 0 AMTSUM,"
                strFormat = strFormat & " ISNULL(sum(AMT),0) AMT,"
                strFormat = strFormat & " 0.0 RATE,"
                strFormat = strFormat & " 0 HDR_AMT,"
                strFormat = strFormat & " 0 DIVAMT"
                strFormat = strFormat & " FROM MD_REPORT_MST_V"
                strFormat = strFormat & " WHERE 1=1"
                strFormat = strFormat & " AND MED_FLAG NOT IN ('01','02','03','10','20') "
                strFormat = strFormat & " AND MED_FLAG = 'A2' "
                strFormat = strFormat & " AND YEARMON = '" & strYEARMON & "'"
                strFormat = strFormat & " AND CLIENTCODE = '" & strCLIENTCODE & "'"
                strFormat = strFormat & " GROUP BY YEARMON,CLIENTCODE,MED_FLAG "

            End If

            '데이터 조회
            Try
                strSQL = String.Format(strFormat)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_DTL")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function DeleteRtn_temp(ByVal strInfoXML As String) As Integer   '데이터 DELETE

        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceMD_TRANS_TEMP = New ceMD_TRANS_TEMP(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출
                intRtn = mobjceMD_TRANS_TEMP.DeleteDo(.WRKUSR)
                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn_temp")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceMD_TRANS_TEMP.Dispose()
            End Try
        End With
    End Function

    ' ============== ProcessRtn_TEMP (Master & Detail) Sample Code 
    Public Function ProcessRtn_TEMP(ByVal strInfoXML As String, _
                                    ByRef strTRANSYEARMON As String, _
                                    ByRef strTRANSNO As String, _
                                    ByRef strCNT As String, _
                                    ByRef strUSERID As String) As Integer

        Dim intRtn As Integer
        Dim i, intColCnt, intRows As Integer
        Dim intCnt

        SetConfig(strInfoXML) '기본정보 Setting

        With mobjSCGLConfig '기본정보를 가지고 있는 Config 개체
            Try
                'DB접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                'Master 데이터 처리
                mobjceMD_TRANS_TEMP = New ceMD_TRANS_TEMP(mobjSCGLConfig)

                strUSERID = .WRKUSR 'USERID 를 받아야 출력시에 USERID에 따른 구분을 둘수있다.
                intRtn = InsertRtn_TRANS_TEMP(strTRANSYEARMON, strTRANSNO, strCNT)

                mobjceMD_TRANS_TEMP.Dispose()
                '트랜잭션Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_TEMP")
            Finally
                'Resource해제
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '청구 요청 로직
    Public Function ProcessRtn_Confirm_User(ByVal strInfoXML As String, _
                                            ByVal vntData As Object, _
                                            ByVal vntData_DTL As Object, _
                                            ByVal strEMPNO As String) As Integer   '데이터 DELETE

        Dim intRtn, i As Integer       'Return변수( 처리건수 또는 0 )
        Dim intColCnt, intRows As Integer
        Dim intColCnt_dtl, intRows_dtl As Integer
        Dim strYEARMON, strSEQ As String
        Dim strREQUEST_USER As String
        Dim strMEDFLAG

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceMD_MMP_MEDIUM = New ceMD_MMP_MEDIUM(mobjSCGLConfig)
                mobjceMD_MMP_LIST = New ceMD_MMP_LIST(mobjSCGLConfig)

                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출

                If IsArray(vntData) Then
                    intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)
                    '''해당하는Row 만큼 Loop
                    For i = 1 To intRows
                        If GetElement(vntData, "CHK", intColCnt, i, OPTIONAL_STR) = 1 Then
                            strYEARMON = GetElement(vntData, "YEARMON", intColCnt, i, OPTIONAL_STR)
                            strSEQ = GetElement(vntData, "SEQ", intColCnt, i, OPTIONAL_STR)

                            '요청자의 아이디를 저장한다.
                            strREQUEST_USER = .WRKUSR
                            intRtn = mobjceMD_MMP_MEDIUM.UserUpdateDo(strYEARMON, strSEQ, strEMPNO, strREQUEST_USER)
                        End If
                    Next
                End If

                '하단의 분담금 저장 로직(UPDATE 는 없다 요청하는순간 저장되며 승인취소하여 수정 저장 하는 방식.INSERT)
                If IsArray(vntData_DTL) Then
                    intColCnt_dtl = UBound(vntData_DTL, 1) : intRows_dtl = UBound(vntData_DTL, 2)
                    '''해당하는Row 만큼 Loop
                    For i = 1 To intRows_dtl

                        strYEARMON = GetElement(vntData_DTL, "YEARMON", intColCnt_dtl, i, OPTIONAL_STR)
                        strSEQ = GetElement(vntData_DTL, "SEQ", intColCnt_dtl, i, OPTIONAL_STR)
                        strMEDFLAG = GetElement(vntData_DTL, "MED_FLAG", intColCnt_dtl, i, OPTIONAL_STR)

                        If strMEDFLAG = "전파" Then
                            strMEDFLAG = "A"
                        ElseIf strMEDFLAG = "인쇄" Then
                            strMEDFLAG = "B"
                        ElseIf strMEDFLAG = "케이블" Then
                            strMEDFLAG = "A2"
                        ElseIf strMEDFLAG = "종편" Then
                            strMEDFLAG = "T"
                        ElseIf strMEDFLAG = "온라인" Then
                            strMEDFLAG = "O"
                        ElseIf strMEDFLAG = "옥외" Then
                            strMEDFLAG = "D"
                        Else
                            strMEDFLAG = ""
                        End If

                        intRtn = InsertRtn(vntData_DTL, intColCnt_dtl, i, strYEARMON, strSEQ, strMEDFLAG)
                    Next
                End If

                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "ProcessRtn_Confirm_User")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceMD_MMP_MEDIUM.Dispose()
                mobjceMD_MMP_LIST.Dispose()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : 외부에비공개"

    Public Function SelectRtn_HDRCONFIRM(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strYEARMON As String, _
                                         ByVal strCLIENTNAME As String) As Object

        Dim strSQL, strFormat, strWhere As String
        Dim vntData As Object
        Dim Con1, Con2 As String
        Dim strUSER

        Con1 = "" : Con2 = ""

        SetConfig(strInfoXML)   '기본정보 설정

        With mobjSCGLConfig

            If strYEARMON <> "" Then Con1 = String.Format(" AND (YEARMON = '{0}')", strYEARMON)
            If strCLIENTNAME <> "" Then Con2 = String.Format(" AND (DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) LIKE '%{0}%')", strCLIENTNAME)

            strWhere = BuildFields(" ", Con1, Con2)

            strUSER = .WRKUSR

            strFormat = " SELECT "
            strFormat = strFormat & " 0 CHK, "
            strFormat = strFormat & " CASE ISNULL(CONFIRMFLAG,'N') WHEN 'N' THEN '' ELSE '0' END CONFIRMGBN,"
            strFormat = strFormat & " YEARMON, SEQ, "
            strFormat = strFormat & " CLIENTCODE, "
            strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
            strFormat = strFormat & " REAL_MED_CODE,"
            strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(REAL_MED_CODE) REAL_MED_NAME,"
            strFormat = strFormat & " DEPT_CD,"
            strFormat = strFormat & " DBO.SC_DEPT_NAME_FUN(DEPT_CD) DEPT_NAME,"
            strFormat = strFormat & " DEMANDDAY,"
            strFormat = strFormat & " ISNULL(AMT,0) AMT,"
            strFormat = strFormat & " DBO.SC_MMPRATE_FUN(YEARMON) RATE,"
            strFormat = strFormat & " ISNULL(MMP_AMT,0) MMP_AMT,"
            strFormat = strFormat & " ISNULL(CONFIRMFLAG,'N') CONFIRMFLAG,"
            strFormat = strFormat & " REQUEST_USER,"
            strFormat = strFormat & " REQUEST_DATE,"
            strFormat = strFormat & " CONFIRM_USER,"
            strFormat = strFormat & " CONFIRM_DATE,"
            strFormat = strFormat & " ISNULL(VOCHNO,'') VOCHNO"
            strFormat = strFormat & " FROM MD_MMP_MEDIUM"
            strFormat = strFormat & " WHERE 1=1 "
            strFormat = strFormat & " {0} "
            strFormat = strFormat & " AND (CONFIRM_USER = '" & strUSER & "' or '" & strUSER & "' = 'RADMIN' )"
            strFormat = strFormat & " AND ISNULL(CONFIRM_USER,'') <> '' "
            strFormat = strFormat & " ORDER BY SEQ "

            '데이터 조회
            Try
                strSQL = String.Format(strFormat, strWhere)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_HDRCONFIRM")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_DTLCONFIRM(ByVal strInfoXML As String, _
                                         ByRef intRowCnt As Integer, _
                                         ByRef intColCnt As Integer, _
                                         ByVal strYEARMON As String, _
                                         ByVal lngSEQ As Double, _
                                         ByVal strCLIENTCODE As String) As Object

        Dim strSQL, strFormat As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        With mobjSCGLConfig

            strFormat = " SELECT "
            strFormat = strFormat & " YEARMON, SEQ,"
            strFormat = strFormat & " CLIENTCODE,"
            strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(CLIENTCODE) CLIENTNAME,"
            strFormat = strFormat & " CASE MED_FLAG WHEN 'A' THEN '전파' "
            strFormat = strFormat & " WHEN 'B' THEN '인쇄'"
            strFormat = strFormat & " WHEN 'C' THEN '인쇄'"
            strFormat = strFormat & " WHEN 'A2' THEN '케이블'"
            strFormat = strFormat & " WHEN 'T' THEN '종편'"
            strFormat = strFormat & " WHEN 'O' THEN '온라인'"
            strFormat = strFormat & " WHEN 'D' THEN '옥외' END MED_FLAG,"
            strFormat = strFormat & " ISNULL(AMTSUM,0) AMTSUM,"
            strFormat = strFormat & " ISNULL(AMT,0) AMT,"
            strFormat = strFormat & " RATE,"
            strFormat = strFormat & " ISNULL(HDR_AMT,0) HDR_AMT,"
            strFormat = strFormat & " ISNULL(DIVAMT,0) DIVAMT"
            strFormat = strFormat & " FROM MD_MMP_LIST"
            strFormat = strFormat & " WHERE 1=1"
            strFormat = strFormat & " AND MED_FLAG <> 'A'"
            strFormat = strFormat & " AND YEARMON = '" & strYEARMON & "'"
            strFormat = strFormat & " AND SEQ = '" & lngSEQ & "'"
            strFormat = strFormat & " AND CLIENTCODE = '" & strCLIENTCODE & "'"

            '데이터 조회
            Try
                strSQL = String.Format(strFormat)

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_DTLCONFIRM")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    '청구 승인 0  취소1
    Public Function Data_Confirm(ByVal strInfoXML As String, _
                                 ByVal vntData As Object, _
                                 ByVal strConfirmFlag As String) As Integer   '데이터 DELETE

        Dim intRtn, i As Integer       'Return변수( 처리건수 또는 0 )
        Dim intColCnt, intRows As Integer
        Dim intColCnt_dtl, intRows_dtl As Integer
        Dim strYEARMON, strSEQ As String

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceMD_MMP_MEDIUM = New ceMD_MMP_MEDIUM(mobjSCGLConfig)

                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출

                If IsArray(vntData) Then
                    intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)
                    '''해당하는Row 만큼 Loop
                    For i = 1 To intRows
                        strYEARMON = "" : strSEQ = ""

                        strYEARMON = GetElement(vntData, "YEARMON", intColCnt, i, OPTIONAL_STR)
                        strSEQ = GetElement(vntData, "SEQ", intColCnt, i, OPTIONAL_STR)

                        If GetElement(vntData, "CHK", intColCnt, i, OPTIONAL_STR) = 1 Then
                            If strConfirmFlag = "0" Then

                                intRtn = mobjceMD_MMP_MEDIUM.Confirm(strYEARMON, strSEQ, strConfirmFlag)
                            Else

                                intRtn = mobjceMD_MMP_MEDIUM.Confirm(strYEARMON, strSEQ, strConfirmFlag)
                            End If

                        End If
                    Next
                End If

                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "Data_Confirm")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceMD_MMP_MEDIUM.Dispose()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : 외부에 비공개 Method"
    Private Function InsertRtn(ByVal vntData_dtl As Object, _
                               ByVal intColCnt As Integer, _
                               ByVal intRow As Integer, _
                               ByVal strYEARMON As String, _
                               ByVal strSEQ As Double, _
                               ByVal strMEDFLAG As String) As Integer
        Dim intRtn As Integer

        intRtn = mobjceMD_MMP_LIST.InsertDo( _
                                       strYEARMON, _
                                       strSEQ, _
                                       GetElement(vntData_dtl, "CLIENTCODE", intColCnt, intRow), _
                                       strMEDFLAG, _
                                       GetElement(vntData_dtl, "AMTSUM", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "AMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "RATE", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "HDR_AMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "DIVAMT", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "MEMO", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR01", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR02", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR03", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR04", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR05", intColCnt, intRow), _
                                       GetElement(vntData_dtl, "ATTR06", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "ATTR07", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "ATTR08", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "ATTR09", intColCnt, intRow, NULL_NUM, True), _
                                       GetElement(vntData_dtl, "ATTR010", intColCnt, intRow, NULL_NUM, True))

        Return intRtn
    End Function

    Private Function InsertRtn_TRANS_TEMP(ByVal strTRANSYEARMON As String, _
                                      ByRef strTRANSNO As String, _
                                      ByRef datacnt As String) As Integer
        Dim intRtn As Integer
        intRtn = mobjceMD_TRANS_TEMP.InsertDo( _
                                       strTRANSYEARMON, _
                                       strTRANSNO, _
                                       datacnt)
        Return intRtn
    End Function

#End Region
End Class

