'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 엔티티 클래스 메이커 - 한화 S&C
'시스템구분 : 솔루션명/시스템명/Server Entity Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : cePD_TAX_HDR.vb ( PD_TAX_HDR Entity 처리 Class)
'기      능 : PD_TAX_HDR Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008-03-07 오후 12:37:08 By Making Entity Bean
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class cePD_MERGETAX_HDR
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "cePD_MERGETAX_HDR"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"
    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strMTAXYEARMON As String, _
            ByVal dblMTAXNO As Double, _
            ByVal strMEDFLAG As String, _
            ByVal strCLIENTCODE As String, _
            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
            Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblVAT As Double = OPTIONAL_NUM, _
            Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
            Optional ByVal strPRINTDAY As String = OPTIONAL_STR, _
            Optional ByVal strVOCHNO As String = OPTIONAL_STR, _
            Optional ByVal strVOCH_TYPE As String = OPTIONAL_STR, _
            Optional ByVal strSUMM As String = OPTIONAL_STR, _
            Optional ByVal strMJFLAG As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTBISNO As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTNAME As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTOWNER As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTADDR1 As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTADDR2 As String = OPTIONAL_STR, _
            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
            Optional ByVal strATTR04 As String = OPTIONAL_STR, _
            Optional ByVal strATTR05 As String = OPTIONAL_STR, _
            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR07 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR08 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR09 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR10 As Double = OPTIONAL_NUM)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            BuildNameValues(",", "MTAXYEARMON", strMTAXYEARMON, strFields, strValues)
            BuildNameValues(",", "MTAXNO", dblMTAXNO, strFields, strValues)
            BuildNameValues(",", "MEDFLAG", strMEDFLAG, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "AMT", dblAMT, strFields, strValues)
            BuildNameValues(",", "VAT", dblVAT, strFields, strValues)
            BuildNameValues(",", "DEMANDDAY", strDEMANDDAY, strFields, strValues)
            BuildNameValues(",", "PRINTDAY", strPRINTDAY, strFields, strValues)
            BuildNameValues(",", "VOCHNO", strVOCHNO, strFields, strValues)
            BuildNameValues(",", "VOCH_TYPE", strVOCH_TYPE, strFields, strValues)
            BuildNameValues(",", "SUMM", strSUMM, strFields, strValues)
            BuildNameValues(",", "MJFLAG", strMJFLAG, strFields, strValues)
            BuildNameValues(",", "CLIENTBISNO", strCLIENTBISNO, strFields, strValues)
            BuildNameValues(",", "CLIENTNAME", strCLIENTNAME, strFields, strValues)
            BuildNameValues(",", "CLIENTOWNER", strCLIENTOWNER, strFields, strValues)
            BuildNameValues(",", "CLIENTADDR1", strCLIENTADDR1, strFields, strValues)
            BuildNameValues(",", "CLIENTADDR2", strCLIENTADDR2, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "ATTR02", strATTR02, strFields, strValues)
            BuildNameValues(",", "ATTR03", strATTR03, strFields, strValues)
            BuildNameValues(",", "ATTR04", strATTR04, strFields, strValues)
            BuildNameValues(",", "ATTR05", strATTR05, strFields, strValues)
            BuildNameValues(",", "ATTR06", dblATTR06, strFields, strValues)
            BuildNameValues(",", "ATTR07", dblATTR07, strFields, strValues)
            BuildNameValues(",", "ATTR08", dblATTR08, strFields, strValues)
            BuildNameValues(",", "ATTR09", dblATTR09, strFields, strValues)
            BuildNameValues(",", "ATTR10", dblATTR10, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)

            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '참고 : Key 조건과 Value Field가선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function UpdateDo(Optional ByVal strMTAXYEARMON As String = OPTIONAL_STR, _
            Optional ByVal dblMTAXNO As Double = OPTIONAL_NUM, _
            Optional ByVal strMEDFLAG As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
            Optional ByVal dblAMT As Double = OPTIONAL_NUM, _
            Optional ByVal dblVAT As Double = OPTIONAL_NUM, _
            Optional ByVal strDEMANDDAY As String = OPTIONAL_STR, _
            Optional ByVal strPRINTDAY As String = OPTIONAL_STR, _
            Optional ByVal strVOCHNO As String = OPTIONAL_STR, _
            Optional ByVal strVOCH_TYPE As String = OPTIONAL_STR, _
            Optional ByVal strSUMM As String = OPTIONAL_STR, _
            Optional ByVal strMJFLAG As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTBISNO As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTNAME As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTOWNER As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTADDR1 As String = OPTIONAL_STR, _
            Optional ByVal strCLIENTADDR2 As String = OPTIONAL_STR, _
            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
            Optional ByVal strATTR04 As String = OPTIONAL_STR, _
            Optional ByVal strATTR05 As String = OPTIONAL_STR, _
            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR07 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR08 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR09 As Double = OPTIONAL_NUM, _
            Optional ByVal dblATTR10 As Double = OPTIONAL_NUM) As Integer

        Dim strSQL As String
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("MEDFLAG", strMEDFLAG), _
                        GetFieldNameValue("CLIENTCODE", strCLIENTCODE), _
                        GetFieldNameValue("DEPT_CD", strDEPT_CD), _
                        GetFieldNameValue("AMT", dblAMT), _
                        GetFieldNameValue("VAT", dblVAT), _
                        GetFieldNameValue("DEMANDDAY", strDEMANDDAY), _
                        GetFieldNameValue("PRINTDAY", strPRINTDAY), _
                        GetFieldNameValue("VOCHNO", strVOCHNO), _
                        GetFieldNameValue("VOCH_TYPE", strVOCH_TYPE), _
                        GetFieldNameValue("SUMM", strSUMM), _
                        GetFieldNameValue("MJFLAG", strMJFLAG), _
                        GetFieldNameValue("CLIENTBISNO", strCLIENTBISNO), _
                        GetFieldNameValue("CLIENTNAME", strCLIENTNAME), _
                        GetFieldNameValue("CLIENTOWNER", strCLIENTOWNER), _
                        GetFieldNameValue("CLIENTADDR1", strCLIENTADDR1), _
                        GetFieldNameValue("CLIENTADDR2", strCLIENTADDR2), _
                        GetFieldNameValue("ATTR01", strATTR01), _
                        GetFieldNameValue("ATTR02", strATTR02), _
                        GetFieldNameValue("ATTR03", strATTR03), _
                        GetFieldNameValue("ATTR04", strATTR04), _
                        GetFieldNameValue("ATTR05", strATTR05), _
                        GetFieldNameValue("ATTR06", dblATTR06), _
                        GetFieldNameValue("ATTR07", dblATTR07), _
                        GetFieldNameValue("ATTR08", dblATTR08), _
                        GetFieldNameValue("ATTR09", dblATTR09), _
                        GetFieldNameValue("ATTR10", dblATTR10), _
                        GetFieldNameValue("UUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("UDATE", strNOW)), _
                     BuildFields("AND", _
                        GetFieldNameValue("MTAXYEARMON", strMTAXYEARMON), GetFieldNameValue("MTAXNO", dblMTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDo")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Delete 처리
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function Update_MERGETaxNo(ByVal strTAXYEARMON, _
                                      ByVal lngTAXNO, _
                                      ByVal lngTAXNOSEQ, _
                                      ByVal strMEDFLAG, _
                                      ByVal strMTAXNO, _
                                      ByVal strVOCH_TYPE) As Integer
        Dim strSQL As String

        Try
            If strVOCH_TYPE = "3" Then
                strSQL = " UPDATE MD_COMMITAX_HDR "
                strSQL = strSQL & "   SET MTAXNO = '" & strMTAXNO & "'"
                strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' "
                strSQL = strSQL & "   AND TAXNO = '" & lngTAXNO & "' "
                strSQL = strSQL & "   AND MEDFLAG = '" & strMEDFLAG & "'"
                strSQL = strSQL & "   AND ISNULL(ATTR03,'') = 'AOR' "
            Else
                If strMEDFLAG = "D" Or strMEDFLAG = "G" Or strMEDFLAG = "Y" Or strMEDFLAG = "K" Then
                    strSQL = " UPDATE MD_COMMITAX_HDR "
                    strSQL = strSQL & "   SET MTAXNO = '" & strMTAXNO & "'"
                    strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & lngTAXNO & "' AND MEDFLAG = '" & strMEDFLAG & "'"
                ElseIf strMEDFLAG = "O" Then
                    strSQL = " UPDATE MD_COMMITAX_HDR "
                    strSQL = strSQL & "   SET MTAXNO = '" & strMTAXNO & "'"
                    strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & lngTAXNO & "' AND MEDFLAG = '" & strMEDFLAG & "'"
                ElseIf strMEDFLAG = "A2" Or strMEDFLAG = "B" Or strMEDFLAG = "C" Then
                    strSQL = " UPDATE MD_TRUTAX_HDR "
                    strSQL = strSQL & "   SET MTAXNO = '" & strMTAXNO & "'"
                    strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & lngTAXNO & "' AND MEDFLAG = '" & strMEDFLAG & "'"
                ElseIf strMEDFLAG = "P" Then
                    strSQL = " UPDATE PD_TAX_HDR "
                    strSQL = strSQL & "   SET MTAXNO = '" & strMTAXNO & "'"
                    strSQL = strSQL & "   WHERE TAXYEARMON = '" & strTAXYEARMON & "' AND TAXNO = '" & lngTAXNO & "'"
                End If

            End If

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateRtn_COMMITAX_HDR_MERGE")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 삭제시 거래명세 디테일 의 세금계산서 번호 삭제
    '*****************************************************************
    Public Function MDTaxDeleteUpdateDo(ByVal strMTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE  MD_COMMITAX_HDR SET MTAXNO = '' "
            strSQL = strSQL & "  WHERE MTAXNO = '" & strMTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".MDTaxDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 삭제시 거래명세 디테일 의 세금계산서 번호 삭제
    '*****************************************************************
    Public Function AORTaxDeleteUpdateDo(ByVal strMTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE  MD_COMMITAX_HDR SET MTAXNO = '' "
            strSQL = strSQL & "  WHERE MTAXNO = '" & strMTAXNO & "'"
            strSQL = strSQL & "  AND ISNULL(ATTR03,'') = 'AOR'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".AORTaxDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문 By KTH
    '반환 : 처리건수
    '기능 : 삭제시 거래명세 디테일 의 세금계산서 번호 삭제
    '*****************************************************************
    Public Function MDTruTaxDeleteUpdateDo(ByVal strMTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE  MD_TRUTAX_HDR SET MTAXNO = '' "
            strSQL = strSQL & "  WHERE MTAXNO = '" & strMTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".MDTruTaxDeleteUpdateDo")
        End Try
    End Function


    Public Function PDTaxDeleteUpdateDo(ByVal strMTAXNO As String) As Integer

        Dim strSQL As String
        Try
            strSQL = "UPDATE  PD_TAX_HDR SET MTAXNO = '' "
            strSQL = strSQL & "  WHERE MTAXNO = '" & strMTAXNO & "'"
            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".PDTaxDeleteUpdateDo")
        End Try
    End Function

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 세금계산서 완료건에 대하여 적요수정
    '참고 : Key 조건이 선택적임(OPTIONAL_STR/OPTIONAL_NUM/OPTIONAL_DTM)
    '*****************************************************************
    Public Function SUMMUpdateDo(ByVal strMTAXYEARMON, _
                                 ByVal intMTAXNO, _
                                 ByVal strSUMM, _
                                 ByVal strVAT) As Integer
        Dim strSQL As String

        Try
            strSQL = " UPDATE PD_MERGETAX_HDR "
            strSQL = strSQL & "   SET SUMM = '" & strSUMM & "'"
            strSQL = strSQL & "   , VAT = '" & strVAT & "'"
            strSQL = strSQL & "   WHERE MTAXYEARMON = '" & strMTAXYEARMON & "' AND MTAXNO = " & intMTAXNO

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".SUMMUpdateDo")
        End Try
    End Function

    Public Function DeleteMark(Optional ByVal strMTAXYEARMON As String = OPTIONAL_STR, Optional ByVal dblMTAXNO As Double = OPTIONAL_NUM) As Integer
        Dim strSQL As String

        Try
            strSQL = String.Format("UPDATE {0} SET ATTR10 = 999999 WHERE {1}", EntityName, _
                     BuildFields("AND", _
                                   GetFieldNameValue("MTAXYEARMON", strMTAXYEARMON), GetFieldNameValue("MTAXNO", dblMTAXNO)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteMark")
        End Try
    End Function


#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "PD_MERGETAX_HDR"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region
End Class
