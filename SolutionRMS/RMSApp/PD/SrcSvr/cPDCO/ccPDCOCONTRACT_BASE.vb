'****************************************************************************************
'Generated By  : Kim Tae Ho 
'시스템구분    : RMS/PD/Server Control Class
'실행   환경   : COM+ Service Server Package
'프로그램명    : ccPDCMPONO.vb
'기         능 : - Project Number 생성
'특이  사항    : - 
'                -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2008.11.07 Kim Tae Ho
'            2) 
'****************************************************************************************

Imports System.Xml                  ' XML처리
Imports SCGLControl                 ' ControlClass의 Base Class
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr          '오류처리 클래스
Imports SCGLUtil.cbSCGLXml          'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil         '기타유틸리티 클래스
Imports ePDCO                       '엔터티 추가

' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트
Public Class ccPDCOCONTRACT_BASE
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccPDCOCONTRACT_BASE"
    Private mobjcePD_CONTRACT_BASE As ePDCO.cePD_CONTRACT_BASE
    Private mobjcePD_CONTRACT_TEMP As ePDCO.cePD_CONTRACT_TEMP

#End Region

#Region "GROUP BLOCK : Function Validation"

    '=============== 계약서 계약서 validation 확인
    Public Function SelctRtn_validation(ByVal strInfoXML As String, _
                                        ByRef intRowCnt As Integer, _
                                        ByRef intColCnt As Integer, _
                                        ByVal strOUTSCODE As String, _
                                        ByVal strGBN As String) As Object

        Dim strWhere As String       'Where조건 변수
        Dim strFormat As String      'SQL Format 변수
        Dim strSQL As String          'SQL 변수
        Dim vntData As Object        'Array Return 변수(Array 를사용할 때 선언)
        Dim Con1, Con2 As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML) '기본정보 Setting

                Con1 = ""

                If strOUTSCODE <> "" Then Con1 = String.Format(" AND OUTSCODE = '{0}'", strOUTSCODE)
                If strGBN <> "" Then Con2 = String.Format(" AND GBN = '{0}'", strGBN)

                strWhere = BuildFields(" ", Con1, Con2)

                strFormat = strFormat & " SELECT "
                strFormat = strFormat & " GUBUN,"
                strFormat = strFormat & " GBN,"
                strFormat = strFormat & " CONTRACTNO,"
                strFormat = strFormat & " OUTSCODE,"
                strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(OUTSCODE) OUTSNAME,"
                strFormat = strFormat & " CONTRACTNAME,"
                strFormat = strFormat & " CONTRACTDAY,"
                strFormat = strFormat & " STDATE,"
                strFormat = strFormat & " EDDATE "
                strFormat = strFormat & " FROM PD_CONTRACT_BASE"
                strFormat = strFormat & " WHERE 1=1 {0}"
                strFormat = strFormat & " ORDER BY GUBUN DESC"

                strSQL = String.Format(strFormat, strWhere)

                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData

            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

#End Region

#Region "GROUP BLOCK : Function Section"
    '=============== 계약서 미등록 내역 조회 
    Public Function SelectRtn(ByVal strInfoXML As String, _
                              ByRef intRowCnt As Integer, _
                              ByRef intColCnt As Integer, _
                              ByVal strFROM As String, _
                              ByVal strTO As String, _
                              ByVal strOUTSCODE As String, _
                              ByVal strOUTSNAME As String, _
                              ByVal strCONFIRM As String, _
                              ByVal strCONTRACTNO As String, _
                              ByVal strCONTRACTNAME1 As String, _
                              ByVal strcmbGBN As String, _
                              ByVal strcmbGUBUN As String) As Object

        Dim strWhere As String       'Where조건 변수
        Dim strFormat As String      'SQL Format 변수
        Dim strSQL As String          'SQL 변수
        Dim vntData As Object        'Array Return 변수(Array 를사용할 때 선언)
        Dim Con1, Con2, Con3, Con4, Con5, Con6, Con7, Con8 As String

        With mobjSCGLConfig
            Try
                SetConfig(strInfoXML) '기본정보 Setting

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = "" : Con5 = "" : Con6 = "" : Con7 = ""

                If strFROM <> "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY BETWEEN '{0}' AND  '{1}')", Replace(strFROM, "-", ""), Replace(strTO, "-", ""))
                End If
                If strFROM <> "" And strTO = "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY >= '{0}')", Replace(strFROM, "-", ""))
                End If
                If strFROM = "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY <= '{0}')", Replace(strTO, "-", ""))
                End If

                If strOUTSCODE <> "" Then Con2 = String.Format(" AND OUTSCODE = '{0}'", strOUTSCODE)
                If strOUTSNAME <> "" Then Con3 = String.Format(" AND DBO.SC_GET_HIGHCUSTNAME_FUN(OUTSCODE) LIKE '%{0}%'", strOUTSNAME)
                If strCONFIRM <> "" Then Con4 = String.Format(" AND ISNULL(CONFIRMFLAG,0) = '{0}'", strCONFIRM)
                If strCONTRACTNO <> "" Then Con5 = String.Format(" AND CONTRACTNO LIKE '%{0}%'", strCONTRACTNO)
                If strCONTRACTNAME1 <> "" Then Con6 = String.Format(" AND CONTRACTNAME LIKE '%{0}%'", strCONTRACTNAME1)
                If strcmbGBN <> "" Then Con7 = String.Format(" AND GBN = '{0}'", strcmbGBN)
                If strcmbGUBUN <> "" Then Con8 = String.Format(" AND GUBUN = '{0}'", strcmbGUBUN)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5, Con6, Con7, Con8)

                strFormat = strFormat & " SELECT "
                strFormat = strFormat & " 0 CHK,"
                strFormat = strFormat & " GBN, "
                strFormat = strFormat & " GUBUN,"
                strFormat = strFormat & " CONTRACTNO,"
                strFormat = strFormat & " OUTSCODE,"
                strFormat = strFormat & " DBO.SC_GET_HIGHCUSTNAME_FUN(OUTSCODE) OUTSNAME,"
                strFormat = strFormat & " CONTRACTNAME,"
                strFormat = strFormat & " ISNULL(AMT,0) AMT,"
                strFormat = strFormat & " CONTRACTDAY,"
                strFormat = strFormat & " STDATE,"
                strFormat = strFormat & " EDDATE,"
                strFormat = strFormat & " COMENT,"
                strFormat = strFormat & " CONFIRMFLAG"
                strFormat = strFormat & " FROM PD_CONTRACT_BASE"
                strFormat = strFormat & " WHERE 1=1 {0}"
                strFormat = strFormat & " ORDER BY OUTSCODE"

                strSQL = String.Format(strFormat, strWhere)

                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)
                Return vntData

            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function ProcessRtn(ByVal strInfoXML As String, _
                               ByVal strMasterXML As String, _
                               ByVal vntData As Object, _
                               ByRef strCONTRACTNO As String, _
                               ByRef strOUTSCODE As String) As Integer

        Dim intRtn As Integer
        Dim intCnt As Integer
        Dim i, intColCnt, intRows As Integer '루프, 컬럼Cnt, 로우Cnt 변수 
        Dim strSQL As String
        Dim strCONFIRMFLAG
        Dim strSTDATE, strEDDATE, strCONTRACTDAY
        Dim strCOMENT
        Dim strGUBUN
        Dim strGBN

        SetConfig(strInfoXML)
        With mobjSCGLConfig
            Try
                Dim xmlRoot As XmlElement
                xmlRoot = XMLGetRoot(strMasterXML) 'XML 데이터

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()

                ''' 사용할 Entity 개체생성(Config 정보를 넘겨생성)
                mobjcePD_CONTRACT_BASE = New cePD_CONTRACT_BASE(mobjSCGLConfig)

                strSTDATE = "" : strEDDATE = "" : strCONTRACTDAY = "" : strCOMENT = "" : strGBN = "" : strGUBUN = ""

                intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)

                For i = 1 To intRows
                    If GetElement(vntData, "CONTRACTNO", intColCnt, i, OPTIONAL_STR) = "" Then
                        If XMLGetElement(xmlRoot, "STDATE") <> "" Then strSTDATE = Replace(XMLGetElement(xmlRoot, "STDATE"), "-", "")
                        If XMLGetElement(xmlRoot, "EDDATE") <> "" Then strEDDATE = Replace(XMLGetElement(xmlRoot, "EDDATE"), "-", "")
                        If XMLGetElement(xmlRoot, "CONTRACTDAY") <> "" Then strCONTRACTDAY = Replace(XMLGetElement(xmlRoot, "CONTRACTDAY"), "-", "")

                        strCOMENT = XMLGetElement(xmlRoot, "COMENT")

                        If XMLGetElement(xmlRoot, "CONFIRMFLAG") <> "" Then
                            If XMLGetElement(xmlRoot, "CONFIRMFLAG") = "1" Or XMLGetElement(xmlRoot, "CONFIRMFLAG") = "-1" Then
                                strCONFIRMFLAG = "1"
                            Else
                                strCONFIRMFLAG = "0"
                            End If
                        Else
                            strCONFIRMFLAG = "0"
                        End If

                        strGBN = XMLGetElement(xmlRoot, "GBN")
                        strGUBUN = XMLGetElement(xmlRoot, "GUBUN")

                        '계약서 번호생성
                        strCONTRACTNO = SelectRtn_CONTRACTSEQNO(strGBN, strGUBUN)
                        intRtn = InsertRtn_HDR(xmlRoot, strCONTRACTNO, strOUTSCODE, _
                                                   strSTDATE, strEDDATE, strCONTRACTDAY, _
                                                   strCOMENT, strGBN, strGUBUN)
                    Else

                        If GetElement(vntData, "STDATE", intColCnt, i, OPTIONAL_STR) <> "" Then strSTDATE = Replace(GetElement(vntData, "STDATE", intColCnt, i, OPTIONAL_STR), "-", "")
                        If GetElement(vntData, "EDDATE", intColCnt, i, OPTIONAL_STR) <> "" Then strEDDATE = Replace(GetElement(vntData, "EDDATE", intColCnt, i, OPTIONAL_STR), "-", "")
                        If GetElement(vntData, "CONTRACTDAY", intColCnt, i, OPTIONAL_STR) <> "" Then strCONTRACTDAY = Replace(GetElement(vntData, "ONTRACTDAY", intColCnt, i, OPTIONAL_STR), "-", "")

                        strCOMENT = GetElement(vntData, "COMENT", intColCnt, i, OPTIONAL_STR)

                        If GetElement(vntData, "CONFIRMFLAG", intColCnt, i) = "1" Then
                            strCONFIRMFLAG = "1"
                        Else
                            strCONFIRMFLAG = "0"
                        End If

                        '계약서 수정생성
                        intRtn = UpdateRtn_HDR(vntData, intColCnt, i, strCONFIRMFLAG, strSTDATE, strEDDATE, strCONTRACTDAY, strCOMENT)

                    End If
                Next

                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn")
            Finally
                .mobjSCGLSql.SQLDisconnect()
                mobjcePD_CONTRACT_BASE.Dispose()
            End Try
        End With
    End Function
    '기본& 단가 계약서 승인 및 취소
    Public Function Processrtn_CONFIRM(ByVal strInfoXML As String, _
                                       ByVal vntData As Object, _
                                       ByVal strCONFIRMFLAG As String) As Integer

        Dim intRtn As Integer
        Dim intCnt As Integer
        Dim i, intColCnt, intRows As Integer '루프, 컬럼Cnt, 로우Cnt 변수 
        Dim strSQL As String
        Dim strCONTRACTNO As String

        SetConfig(strInfoXML)
        With mobjSCGLConfig
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                If IsArray(vntData) Then

                    ''' 사용할 Entity 개체생성(Config 정보를 넘겨생성)
                    mobjcePD_CONTRACT_BASE = New cePD_CONTRACT_BASE(mobjSCGLConfig)
                    intColCnt = UBound(vntData, 1) : intRows = UBound(vntData, 2)

                    For i = 1 To intRows
                        strCONTRACTNO = GetElement(vntData, "CONTRACTNO", intColCnt, i, OPTIONAL_STR)

                        intRtn = UpdateRtn_CONFIRM(vntData, intColCnt, intRows, strCONTRACTNO, strCONFIRMFLAG)
                    Next
                End If

                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".Processrtn_CONFIRM")
            Finally
                .mobjSCGLSql.SQLDisconnect()
                mobjcePD_CONTRACT_BASE.Dispose()
            End Try
        End With
    End Function

    '============== ProcessRtn 계약서 CONTRACTCODE 생성
    Public Function SelectRtn_CONTRACTSEQNO(ByVal strGBN As String, _
                                            ByVal strGUBUN As String) As String
        '여기부터 단순조회
        Dim strSQL, strFormat, strRtn As String
        'SetConfig(strInfoXML) '기본정보 Setting
        With mobjSCGLConfig '기본정보 Config 개체

            Try

                strSQL = " SELECT '" & strGBN & "'+'" & strGUBUN & "' + '-' + DBO.LPAD(ISNULL(MAX(CAST(right(CONTRACTNO,4) AS NUMERIC)),0) + 1,5,0) "
                strSQL = strSQL & " FROM PD_CONTRACT_BASE"
                strSQL = strSQL & " WHERE 1=1"
                strSQL = strSQL & " and  SUBSTRING(CONTRACTNO,1,3) = '" & strGBN & "'"
                strSQL = strSQL & " and SUBSTRING(CONTRACTNO,4,2) = '" & strGUBUN & "'"


                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)
                Return strRtn
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CONTRACTSEQNO")
            Finally
            End Try
        End With
        '여기까지 단순조회
    End Function

    '================계약서 삭제
    Public Function DeleteRtn(ByVal strInfoXML As String, _
                              ByVal strCONTRACTNO As String) As Integer

        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjcePD_CONTRACT_BASE = New cePD_CONTRACT_BASE(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출
                intRtn = mobjcePD_CONTRACT_BASE.DeleteDo(strCONTRACTNO)
                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn")
            Finally
                '사용한 Entity(개체Dispose)
                mobjcePD_CONTRACT_BASE.Dispose()
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    ' ============== ProcessRtn_TEMP (Master & Detail) Sample Code 
    Public Function ProcessRtn_TEMP(ByVal strInfoXML As String, _
                                    ByRef strCONTACTNO As String, _
                                    ByRef dblNUM As Double, _
                                    ByRef strUSERID As String) As Integer

        Dim intRtn As Integer
        Dim i, intColCnt, intRows As Integer
        Dim intCnt

        SetConfig(strInfoXML) '기본정보 Setting

        With mobjSCGLConfig '기본정보를 가지고 있는 Config 개체
            Try
                'DB접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                'Master 데이터 처리
                mobjcePD_CONTRACT_TEMP = New cePD_CONTRACT_TEMP(mobjSCGLConfig)

                strUSERID = .WRKUSR 'USERID 를 받아야 출력시에 USERID에 따른 구분을 둘수있다.
                intRtn = InsertRtn_CONTRACT_TEMP(strCONTACTNO, dblNUM, strUSERID)

                '트랜잭션Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_TEMP")
            Finally
                'Resource해제
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjcePD_CONTRACT_TEMP.Dispose()
            End Try
        End With
    End Function

    Public Function DeleteRtn_temp(ByVal strInfoXML As String) As Integer   '데이터 DELETE

        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjcePD_CONTRACT_TEMP = New cePD_CONTRACT_TEMP(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출
                intRtn = mobjcePD_CONTRACT_TEMP.DeleteDo(.WRKUSR)
                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjcePD_CONTRACT_TEMP.Dispose()
            End Try
        End With
    End Function
#End Region

#Region "GROUP BLOCK : Entity Function Section"
    Private Function InsertRtn_HDR(ByVal xmlRoot As XmlElement, _
                                   ByVal strCONTRACTNO As String, _
                                   ByVal strOUTSCODE As String, _
                                   ByVal strSTDATE As String, _
                                   ByVal strEDDATE As String, _
                                   ByVal strCONTRACTDAY As String, _
                                   ByVal strCOMENT As String, _
                                   ByVal strGBN As String, _
                                   ByVal strGUBUN As String) As Integer


        Dim intRtn As Integer
        intRtn = mobjcePD_CONTRACT_BASE.InsertDo( _
                                       strCONTRACTNO, _
                                       strOUTSCODE, _
                                       XMLGetElement(xmlRoot, "CONTRACTNAME"), _
                                       strGBN, _
                                       XMLGetElement(xmlRoot, "AMT", NULL_NUM, True), _
                                       strSTDATE, _
                                       strEDDATE, _
                                       strCONTRACTDAY, _
                                       XMLGetElement(xmlRoot, "MANAGER"), _
                                       XMLGetElement(xmlRoot, "CONFIRMFLAG"), _
                                       strCOMENT, _
                                       strGUBUN, _
                                       XMLGetElement(xmlRoot, "ATTR01"), _
                                       XMLGetElement(xmlRoot, "ATTR02"), _
                                       XMLGetElement(xmlRoot, "ATTR03"), _
                                       XMLGetElement(xmlRoot, "ATTR04"), _
                                       XMLGetElement(xmlRoot, "ATTR05"), _
                                       XMLGetElement(xmlRoot, "ATTR06", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR07", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR08", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR09", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR10", NULL_NUM, True))

        Return intRtn
    End Function

    '청약 데이터 분할시 수정 저장
    Private Function UpdateRtn_HDR(ByVal vntData As Object, _
                                   ByVal intColCnt As Integer, _
                                   ByVal intRow As Integer, _
                                   ByVal strCONFIRMFLAG As String, _
                                   ByVal strSTDATE As String, _
                                   ByVal strEDDATE As String, _
                                   ByVal strCONTRACTDAY As String, _
                                   ByVal strCOMENT As String) As Integer
        Dim intRtn As Integer
        intRtn = mobjcePD_CONTRACT_BASE.UpdateDo(GetElement(vntData, "CONTRACTNO", intColCnt, intRow), _
                                                 GetElement(vntData, "OUTSCODE", intColCnt, intRow, NULL_STR, True), _
                                                 GetElement(vntData, "CONTRACTNAME", intColCnt, intRow, NULL_STR, True), _
                                                 GetElement(vntData, "GBN", intColCnt, intRow, NULL_STR, True), _
                                                 GetElement(vntData, "AMT", intColCnt, intRow, NULL_NUM, True), _
                                                 strSTDATE, _
                                                 strEDDATE, _
                                                 strCONTRACTDAY, _
                                                 GetElement(vntData, "MANAGER", intColCnt, intRow), _
                                                 strCONFIRMFLAG, _
                                                 strCOMENT, _
                                                 GetElement(vntData, "GUBUN", intColCnt, intRow))

        Return intRtn
    End Function

    Private Function InsertRtn_CONTRACT_TEMP(ByVal strCONTRACTNO As String, _
                                             ByRef dblNUM As String, _
                                             ByRef strUSERID As String) As Integer
        Dim intRtn As Integer
        intRtn = mobjcePD_CONTRACT_TEMP.InsertDo( _
                                       strCONTRACTNO, _
                                       dblNUM, _
                                       strUSERID)
        Return intRtn

    End Function


    Private Function UpdateRtn_CONFIRM(ByVal vntData As Object, _
                                       ByVal intColCnt As Integer, _
                                       ByVal intRow As Integer, _
                                       ByVal strCONTRACTNO As String, _
                                       ByVal strCONFIRMFLAG As String) As Integer

        Dim intRtn As Integer
        intRtn = mobjcePD_CONTRACT_BASE.UpdateDo_CONFIRM( _
                                                        strCONTRACTNO, _
                                                        strCONFIRMFLAG)
        Return intRtn
    End Function

#End Region
End Class

