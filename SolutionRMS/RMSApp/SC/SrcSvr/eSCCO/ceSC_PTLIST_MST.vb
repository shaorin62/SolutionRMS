'****************************************************************************************
'Generated By: JNF
'시스템구분 : RMS/SC/Server Entity Class
'실행  환경 : GAC(Global Assembly Cache)
'프로그램명 : ceSC_FEE_MST.vb ( SC_FEE_MST Entity 처리 Class)
'기      능 : SC_FEE_MST Entity에 대해Insert/Update/Delete/Select를 처리
'             - 부모엔티티 객체인 SCGLUtil.ceEntity를 상속
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2009-08-20 오후 06:18 By Making Entity Bean
'****************************************************************************************
Imports SCGLUtil.cbSCGLUtil     '공통 유틸리티 객체
Imports SCGLUtil.cbSCGLErr      '공통 오류처리 객체
Imports SCGLEntity              '엔티티 객체의 부모 객체

Public Class ceSC_PTLIST_MST
    Inherits ceEntity

#Region "GROUP BLOCk : 전역 또는 모듈레벨의 변수/상수 선언"
    Private Const CLASS_NAME = "ceSC_PTLIST_MST"    '자신의 클래스명
#End Region

#Region "GROUP BLOCk : 외부에 공개 Method"
#Region "SQL Insert/Update/Delete/Select"

    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Insert 처리
    '*****************************************************************
    Public Function InsertDo(ByVal strYEARMON As String, _
                            Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
                            Optional ByVal strCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strGREATCODE As String = OPTIONAL_STR, _
                            Optional ByVal strGREATNAME As String = OPTIONAL_STR, _
                            Optional ByVal strBUSINO As String = OPTIONAL_STR, _
                            Optional ByVal strPT_STATUS As String = OPTIONAL_STR, _
                            Optional ByVal strPT_LIST As String = OPTIONAL_STR, _
                            Optional ByVal dblEX_BILL As Double = OPTIONAL_NUM, _
                            Optional ByVal strOLDCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLASS As String = OPTIONAL_STR, _
                            Optional ByVal strEX_CONDITION As String = OPTIONAL_STR, _
                            Optional ByVal strEX_INFO As String = OPTIONAL_STR, _
                            Optional ByVal strOT_DATE As String = OPTIONAL_STR, _
                            Optional ByVal strOT_INFO As String = OPTIONAL_STR, _
                            Optional ByVal dblPT_ESTAMT As Double = OPTIONAL_NUM, _
                            Optional ByVal dblPT_ACTAMT As Double = OPTIONAL_NUM, _
                            Optional ByVal strPT_DATE1 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_DATE2 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_DATE3 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME1 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME2 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME3 As String = OPTIONAL_STR, _
                            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                            Optional ByVal strEXCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strPT_RESULT As String = OPTIONAL_STR, _
                            Optional ByVal strPT_TEXT As String = OPTIONAL_STR, _
                            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
                            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
                            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
                            Optional ByVal dblATTR04 As Double = OPTIONAL_NUM, _
                            Optional ByVal dblATTR05 As Double = OPTIONAL_NUM, _
                            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM)

        Dim strSQL As String
        Dim strFields As New System.Text.StringBuilder
        Dim strValues As New System.Text.StringBuilder
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            BuildNameValues(",", "YEARMON", strYEARMON, strFields, strValues)
            BuildNameValues(",", "CLIENTCODE", strCLIENTCODE, strFields, strValues)
            BuildNameValues(",", "CLIENTNAME", strCLIENTNAME, strFields, strValues)
            BuildNameValues(",", "GREATCODE", strGREATCODE, strFields, strValues)
            BuildNameValues(",", "GREATNAME", strGREATNAME, strFields, strValues)
            BuildNameValues(",", "BUSINO", strBUSINO, strFields, strValues)
            BuildNameValues(",", "PT_STATUS", strPT_STATUS, strFields, strValues)
            BuildNameValues(",", "PT_LIST", strPT_LIST, strFields, strValues)
            BuildNameValues(",", "EX_BILL", dblEX_BILL, strFields, strValues)
            BuildNameValues(",", "OLDCLIENTNAME", strOLDCLIENTNAME, strFields, strValues)
            BuildNameValues(",", "PT_CLASS", strPT_CLASS, strFields, strValues)
            BuildNameValues(",", "EX_CONDITION", strEX_CONDITION, strFields, strValues)
            BuildNameValues(",", "EX_INFO", strEX_INFO, strFields, strValues)
            BuildNameValues(",", "OT_DATE", strOT_DATE, strFields, strValues)
            BuildNameValues(",", "OT_INFO", strOT_INFO, strFields, strValues)
            BuildNameValues(",", "PT_ESTAMT", dblPT_ESTAMT, strFields, strValues)
            BuildNameValues(",", "PT_ACTAMT", dblPT_ACTAMT, strFields, strValues)
            BuildNameValues(",", "PT_DATE1", strPT_DATE1, strFields, strValues)
            BuildNameValues(",", "PT_DATE2", strPT_DATE2, strFields, strValues)
            BuildNameValues(",", "PT_DATE3", strPT_DATE3, strFields, strValues)
            BuildNameValues(",", "PT_CLIENTNAME1", strPT_CLIENTNAME1, strFields, strValues)
            BuildNameValues(",", "PT_CLIENTNAME2", strPT_CLIENTNAME2, strFields, strValues)
            BuildNameValues(",", "PT_CLIENTNAME3", strPT_CLIENTNAME3, strFields, strValues)
            BuildNameValues(",", "DEPT_CD", strDEPT_CD, strFields, strValues)
            BuildNameValues(",", "EXCLIENTNAME", strEXCLIENTNAME, strFields, strValues)
            BuildNameValues(",", "PT_RESULT", strPT_RESULT, strFields, strValues)
            BuildNameValues(",", "PT_TEXT", strPT_TEXT, strFields, strValues)
            BuildNameValues(",", "ATTR01", strATTR01, strFields, strValues)
            BuildNameValues(",", "ATTR02", strATTR02, strFields, strValues)
            BuildNameValues(",", "ATTR03", strATTR03, strFields, strValues)
            BuildNameValues(",", "ATTR04", dblATTR04, strFields, strValues)
            BuildNameValues(",", "ATTR05", dblATTR05, strFields, strValues)
            BuildNameValues(",", "ATTR06", dblATTR06, strFields, strValues)
            BuildNameValues(",", "CUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "CDATE", strNOW, strFields, strValues)
            BuildNameValues(",", "UUSER", mobjSCGLConfig.WRKUSR, strFields, strValues)
            BuildNameValues(",", "UDATE", strNOW, strFields, strValues)


            strSQL = String.Format("INSERT INTO {0} ({1}) VALUES({2})", EntityName, strFields, strValues)

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".InsertDo")
        End Try
    End Function


    '*****************************************************************
    '입력 : strSQL = SQL 문
    '반환 : 처리건수
    '기능 : 해당 Entity에 Update 처리
    '*****************************************************************
    '다음의 컬럼을 Update
    'CLIENTCODE,FDATE,EDATE,DEALTYPE1,DEALTYPE2,MONTHAMT,MED_TV,MED_RD,MED_DMB,MED_CATV,MED_PAP,MED_MAG,USEFLAG
    Public Function UpdateDo(ByVal strYEARMON As String, _
                            Optional ByVal dblSEQ As Double = OPTIONAL_NUM, _
                            Optional ByVal strCLIENTCODE As String = OPTIONAL_STR, _
                            Optional ByVal strCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strGREATCODE As String = OPTIONAL_STR, _
                            Optional ByVal strGREATNAME As String = OPTIONAL_STR, _
                            Optional ByVal strBUSINO As String = OPTIONAL_STR, _
                            Optional ByVal strPT_STATUS As String = OPTIONAL_STR, _
                            Optional ByVal strPT_LIST As String = OPTIONAL_STR, _
                            Optional ByVal dblEX_BILL As Double = OPTIONAL_NUM, _
                            Optional ByVal strOLDCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLASS As String = OPTIONAL_STR, _
                            Optional ByVal strEX_CONDITION As String = OPTIONAL_STR, _
                            Optional ByVal strEX_INFO As String = OPTIONAL_STR, _
                            Optional ByVal strOT_DATE As String = OPTIONAL_STR, _
                            Optional ByVal strOT_INFO As String = OPTIONAL_STR, _
                            Optional ByVal dblPT_ESTAMT As Double = OPTIONAL_NUM, _
                            Optional ByVal dblPT_ACTAMT As Double = OPTIONAL_NUM, _
                            Optional ByVal strPT_DATE1 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_DATE2 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_DATE3 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME1 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME2 As String = OPTIONAL_STR, _
                            Optional ByVal strPT_CLIENTNAME3 As String = OPTIONAL_STR, _
                            Optional ByVal strDEPT_CD As String = OPTIONAL_STR, _
                            Optional ByVal strEXCLIENTNAME As String = OPTIONAL_STR, _
                            Optional ByVal strPT_RESULT As String = OPTIONAL_STR, _
                            Optional ByVal strPT_TEXT As String = OPTIONAL_STR, _
                            Optional ByVal strATTR01 As String = OPTIONAL_STR, _
                            Optional ByVal strATTR02 As String = OPTIONAL_STR, _
                            Optional ByVal strATTR03 As String = OPTIONAL_STR, _
                            Optional ByVal dblATTR04 As Double = OPTIONAL_NUM, _
                            Optional ByVal dblATTR05 As Double = OPTIONAL_NUM, _
                            Optional ByVal dblATTR06 As Double = OPTIONAL_NUM) As Integer

        Dim strSQL As String
        Dim strNOW As String '데이트형의 처리는 변수를 받아 텍스트로 처리 한다.. 
        strNOW = Now
        Try
            strSQL = String.Format("UPDATE {0} SET {1} WHERE {2}", EntityName, _
                     BuildFields(",", _
                        GetFieldNameValue("YEARMON", strYEARMON), _
                        GetFieldNameValue("CLIENTCODE", strCLIENTCODE), _
                        GetFieldNameValue("CLIENTNAME", strCLIENTNAME), _
                        GetFieldNameValue("GREATCODE", strGREATCODE), _
                        GetFieldNameValue("GREATNAME", strGREATNAME), _
                        GetFieldNameValue("BUSINO", strBUSINO), _
                        GetFieldNameValue("PT_STATUS", strPT_STATUS), _
                        GetFieldNameValue("PT_LIST", strPT_LIST), _
                        GetFieldNameValue("EX_BILL", dblEX_BILL), _
                        GetFieldNameValue("OLDCLIENTNAME", strOLDCLIENTNAME), _
                        GetFieldNameValue("PT_CLASS", strPT_CLASS), _
                        GetFieldNameValue("EX_CONDITION", strEX_CONDITION), _
                        GetFieldNameValue("EX_INFO", strEX_INFO), _
                        GetFieldNameValue("OT_DATE", strOT_DATE), _
                        GetFieldNameValue("OT_INFO", strOT_INFO), _
                        GetFieldNameValue("PT_ESTAMT", dblPT_ESTAMT), _
                        GetFieldNameValue("PT_ACTAMT", dblPT_ACTAMT), _
                        GetFieldNameValue("PT_DATE1", strPT_DATE1), _
                        GetFieldNameValue("PT_DATE2", strPT_DATE2), _
                        GetFieldNameValue("PT_DATE3", strPT_DATE3), _
                        GetFieldNameValue("PT_CLIENTNAME1", strPT_CLIENTNAME1), _
                        GetFieldNameValue("PT_CLIENTNAME2", strPT_CLIENTNAME2), _
                        GetFieldNameValue("PT_CLIENTNAME3", strPT_CLIENTNAME3), _
                        GetFieldNameValue("DEPT_CD", strDEPT_CD), _
                        GetFieldNameValue("EXCLIENTNAME", strEXCLIENTNAME), _
                        GetFieldNameValue("PT_RESULT", strPT_RESULT), _
                        GetFieldNameValue("PT_TEXT", strPT_TEXT), _
                        GetFieldNameValue("ATTR01", strATTR01), _
                        GetFieldNameValue("ATTR02", strATTR02), _
                        GetFieldNameValue("ATTR03", strATTR03), _
                        GetFieldNameValue("ATTR04", dblATTR04), _
                        GetFieldNameValue("ATTR05", dblATTR05), _
                        GetFieldNameValue("ATTR06", dblATTR06), _
                        GetFieldNameValue("UUSER", mobjSCGLConfig.WRKUSR), _
                        GetFieldNameValue("UDATE", strNOW)), _
                     BuildFields("AND", _
                        GetFieldNameValue("YEARMON", strYEARMON), GetFieldNameValue("SEQ", dblSEQ)))

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".UpdateDo")
        End Try
    End Function

    Public Function DeleteDO(ByVal strYEARMON As String, _
                             ByVal dblSEQ As String) As Integer
        Dim strSQL As String
        Try
            strSQL = "DELETE FROM  SC_PTLIST_MST WHERE YEARMON='" & strYEARMON & "' AND SEQ = '" & dblSEQ & "'"

            Return ProcEntity(strSQL)
        Catch err As Exception
            Throw RaiseSysErr(err, CLASS_NAME & ".DeleteDO")
        End Try
    End Function
#End Region

#Region "객체 생성/해제"
    '*****************************************************************
    '입력 : strInfoXML = 공통기본정보에 대한 XML
    'objSCGLSql = DB 처리 객체 인스턴싱 변수    '반환 : 없음
    '기능 : DB 처리를 위한 공통기본정보 설정
    '*****************************************************************
    Public Sub New(Optional ByVal objSCGLConfig As SCGLUtil.cbSCGLConfig = Nothing, Optional ByVal strInfoXML As String = "")
        MyBase.SetConfig(objSCGLConfig, strInfoXML)
        MyBase.EntityName = "SC_PTLIST_MST"     'Entity Name 설정
    End Sub

    '해제 기능은 Base Class에서 구현되어 있음
#End Region
#End Region

End Class







