'****************************************************************************************
'Generated By: MakeSFAR V.2.0.0 - 컨트롤 클래스 메이커 - 한화 S&C
'시스템구분    : 솔루션명 /시스템명/Server Control Class
'실행   환경    : COM+ Service Server Package
'프로그램명    : ccPDCMCODETR.vb
'기         능    : - 기능을 명시 합니다.
'특이  사항     : - 특이사항에 대해 표현
'                     -
'----------------------------------------------------------------------------------------
'HISTORY    :1) 2004-03-30 오전 10:32:13 By MakeSFARV.2.0.0
'                  2) 2004-03-30 오전 10:32:13 By 작성자명을 씁니다.
'****************************************************************************************

Imports System.Xml                        ' XML처리
Imports SCGLControl                       ' ControlClass의 Base Class
Imports SCGLUtil.cbSCGLConfig       ' ConfigurationClass
Imports SCGLUtil.cbSCGLErr            '오류처리 클래스
Imports SCGLUtil.cbSCGLXml           'XML처리 클래스
Imports SCGLUtil.cbSCGLUtil            '기타유틸리티 클래스
Imports eSCCO
' 엔티티 클래스 사용시 해당 엔티티 클래스의 프로젝트를 참조한 후 Imports 하십시요. 
' Imports 엔티티프로젝트

Public Class ccSCCOCONTRACT
    Inherits ccControl

#Region "GROUP BLOCK : 전역 또는 모듈레벨의 변수/상수 선언"
    Private CLASS_NAME = "ccSCCOCONTRACT"                  '자신의 클래스명
    Private mobjceSC_CONTRACT_MST As eSCCO.ceSC_CONTRACT_MST
#End Region


#Region "GROUP BLOCK : Property 선언"
#End Region

#Region "GROUP BLOCK : Event 선언"
    Public Function Get_COMBO_VALUE(ByVal strInfoXML As String, _
                                    ByRef intRowCnt As Integer, _
                                    ByRef intColCnt As Integer) As Object

        Dim strSQL, strFormat As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        'SQL문 생성
        strSQL = " SELECT CODE, CODE_NAME"
        strSQL = strSQL & " FROM ( "
        strSQL = strSQL & "   SELECT '' CODE, '전체' CODE_NAME, 0 SORT_SEQ"
        strSQL = strSQL & "   UNION ALL"
        strSQL = strSQL & "   SELECT CODE, CODE_NAME, SORT_SEQ"
        strSQL = strSQL & "   FROM SC_CODE  "
        strSQL = strSQL & "   WHERE CLASS_CODE = 'SC_CONTRACT' AND USE_YN = 'Y' "
        strSQL = strSQL & " )A "
        strSQL = strSQL & " ORDER BY SORT_SEQ  "

        With mobjSCGLConfig
            ''데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetDataType")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function Get_COMBO_VALUE2(ByVal strInfoXML As String, _
                                    ByRef intRowCnt As Integer, _
                                    ByRef intColCnt As Integer) As Object

        Dim strSQL, strFormat, strSelFields As String
        Dim vntData As Object

        SetConfig(strInfoXML)   '기본정보 설정

        '조회 필드 설정
        strSelFields = "CODE, CODE_NAME"

        'SQL문 생성

        strFormat = " SELECT {0} " & _
                    " FROM ( " & _
                    "   SELECT '' CODE, '선택하세요' CODE_NAME, 0 SORT_SEQ" & _
                    "   UNION ALL" & _
                    "   SELECT {0}, SORT_SEQ" & _
                    "   FROM SC_CODE  " & _
                    "   WHERE CLASS_CODE = 'SC_CONTRACT' AND USE_YN = 'Y' " & _
                    " )A " & _
                    " ORDER BY SORT_SEQ  "

        With mobjSCGLConfig
            strSQL = String.Format(strFormat, strSelFields)

            ''데이터 조회
            Try
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt)
                Return vntData
            Catch err As Exception
                Throw RaiseSysErr(err, CLASS_NAME & ".GetDataType")
            Finally
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function
#End Region

#Region "GROUP BLOCK : 외부에 공개 Method"
    Public Function SelectRtn(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strGBN As String, _
                                   ByVal strFROM As String, _
                                   ByVal strTO As String, _
                                   ByVal strCUSTSCODE As String, _
                                   ByVal strCONTRACTNO As String, _
                                   ByVal strCONFIRMFLAG As String) As Object

        Dim strWhere As String       'Where조건 변수
        Dim strFormet As String      'SQL Format 변수
        Dim strSQL As String          'SQL 변수
        Dim vntData As Object        'Array Return 변수(Array 를사용할 때 선언)
        Dim Con1, Con2, Con3, Con4, Con5
        Dim strUSER
        With mobjSCGLConfig '기본정보 Config 개체
            Try

                SetConfig(strInfoXML) '기본정보 Setting

                strUSER = mobjSCGLConfig.WRKUSR

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = "" : Con5 = ""

                If strFROM <> "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY BETWEEN '{0}' AND  '{1}')", Replace(strFROM, "-", ""), Replace(strTO, "-", ""))
                End If
                If strFROM <> "" And strTO = "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY >= '{0}')", Replace(strFROM, "-", ""))
                End If
                If strFROM = "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY <= '{0}')", Replace(strTO, "-", ""))
                End If

                If strGBN <> "" Then Con2 = String.Format(" AND (GBN = '{0}')", strGBN)
                If strCUSTSCODE <> "" Then Con3 = String.Format(" AND (CUSTCODE = '{0}')", strCUSTSCODE)
                If strCONTRACTNO <> "" Then Con4 = String.Format(" AND (CONTRACTNO LIKE '%{0}%')", strCONTRACTNO)
                If strCONFIRMFLAG <> "" Then Con5 = String.Format(" AND (CONFIRMFLAG = '{0}')", strCONFIRMFLAG)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5)


                strFormet = "  SELECT "
                strFormet = strFormet & "  0 CHK,"
                strFormet = strFormet & "  CASE CONFIRMFLAG WHEN 'Y' THEN '승인' ELSE '미승인' END AS CONFIRMFLAGNAME,"
                strFormet = strFormet & "  B.CODE_NAME GBNNAME, "
                strFormet = strFormet & "  A.CONTRACTNO,"
                strFormet = strFormet & "  A.CONTRACTNAME,"
                strFormet = strFormet & "  A.CUSTNAME,"
                strFormet = strFormet & "  A.CONTRACTDAY,"
                strFormet = strFormet & "  A.STDATE,"
                strFormet = strFormet & "  A.EDDATE,"
                strFormet = strFormet & "  A.AMT,"
                strFormet = strFormet & "  A.CONDITION,"
                strFormet = strFormet & "  A.MEMO,"
                strFormet = strFormet & "  A.GBN,"
                strFormet = strFormet & "  A.CUSTCODE, A.SEQ, A.CONFIRMFLAG, A.CONFIRMDATE, dbo.SC_EMPNAME_FUN(A.CONFIRM_USER) CONFIRM_USER, dbo.SC_EMPNAME_FUN(A.CUSER) CUSER, A.CDATE"
                strFormet = strFormet & "  FROM SC_CONTRACT_MST A"
                strFormet = strFormet & "  LEFT JOIN ("
                strFormet = strFormet & "  	    SELECT "
                strFormet = strFormet & "  	    CODE, CODE_NAME"
                strFormet = strFormet & "  	    FROM SC_CODE"
                strFormet = strFormet & "  	    WHERE CLASS_CODE = 'SC_CONTRACT'"
                strFormet = strFormet & "  ) B ON A.GBN = B.CODE"
                strFormet = strFormet & "  WHERE 1=1 {0} "
                strFormet = strFormet & "  ORDER BY CONTRACTDAY DESC "

                strSQL = String.Format(strFormet, strWhere)

                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)

                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CODE")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_ALL(ByVal strInfoXML As String, _
                                   ByRef intRowCnt As Integer, _
                                   ByRef intColCnt As Integer, _
                                   ByVal strGBN As String, _
                                   ByVal strFROM As String, _
                                   ByVal strTO As String, _
                                   ByVal strCUSTSCODE As String, _
                                   ByVal strCONTRACTNO As String, _
                                   ByVal strCONFIRMFLAG As String) As Object

        Dim strWhere As String       'Where조건 변수
        Dim strFormet As String      'SQL Format 변수
        Dim strSQL As String          'SQL 변수
        Dim vntData As Object        'Array Return 변수(Array 를사용할 때 선언)
        Dim Con1, Con2, Con3, Con4, Con5
        With mobjSCGLConfig '기본정보 Config 개체
            Try
                SetConfig(strInfoXML) '기본정보 Setting

                Con1 = "" : Con2 = "" : Con3 = "" : Con4 = "" : Con5 = ""

                If strFROM <> "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY BETWEEN '{0}' AND  '{1}')", Replace(strFROM, "-", ""), Replace(strTO, "-", ""))
                End If
                If strFROM <> "" And strTO = "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY >= '{0}')", Replace(strFROM, "-", ""))
                End If
                If strFROM = "" And strTO <> "" Then
                    Con1 = String.Format(" AND (CONTRACTDAY <= '{0}')", Replace(strTO, "-", ""))
                End If

                If strGBN <> "" Then Con2 = String.Format(" AND (GBN = '{0}')", strGBN)
                If strCUSTSCODE <> "" Then Con3 = String.Format(" AND (CUSTCODE = '{0}')", strCUSTSCODE)
                If strCONTRACTNO <> "" Then Con4 = String.Format(" AND (CONTRACTNO LIKE '%{0}%')", strCONTRACTNO)
                If strCONFIRMFLAG <> "" Then Con5 = String.Format(" AND (CONFIRMFLAG = '{0}')", strCONFIRMFLAG)

                strWhere = BuildFields(" ", Con1, Con2, Con3, Con4, Con5)


                strFormet = strFormet & "  SELECT "
                strFormet = strFormet & "  0 CHK,"
                strFormet = strFormet & "  A.SEQ,"
                strFormet = strFormet & "  CASE CONFIRMFLAG WHEN 'Y' THEN '승인' ELSE '미승인' END AS CONFIRMFLAGNAME,"
                strFormet = strFormet & "  B.CODE_NAME GBNNAME, "
                strFormet = strFormet & "  A.CONTRACTNO,"
                strFormet = strFormet & "  A.CONTRACTNAME,"
                strFormet = strFormet & "  A.CUSTNAME,"
                strFormet = strFormet & "  A.CONTRACTDAY,"
                strFormet = strFormet & "  A.STDATE,"
                strFormet = strFormet & "  A.EDDATE,"
                strFormet = strFormet & "  A.AMT,"
                strFormet = strFormet & "  A.CONDITION,"
                strFormet = strFormet & "  A.MEMO,"
                strFormet = strFormet & "  A.GBN,"
                strFormet = strFormet & "  A.CUSTCODE, A.SEQ, A.CONFIRMFLAG, A.CONFIRMDATE, dbo.SC_EMPNAME_FUN(A.CONFIRM_USER) CONFIRM_USER, dbo.SC_EMPNAME_FUN(A.CUSER) CUSER, A.CDATE"
                strFormet = strFormet & "  FROM SC_CONTRACT_MST A"
                strFormet = strFormet & "  LEFT JOIN ("
                strFormet = strFormet & "  	    SELECT "
                strFormet = strFormet & "  	    CODE, CODE_NAME"
                strFormet = strFormet & "  	    FROM SC_CODE"
                strFormet = strFormet & "  	    WHERE CLASS_CODE = 'SC_CONTRACT'"
                strFormet = strFormet & "  ) B ON A.GBN = B.CODE"
                strFormet = strFormet & "  WHERE 1=1 {0} "
                strFormet = strFormet & "  ORDER BY CONTRACTDAY DESC "

                strSQL = String.Format(strFormet, strWhere)

                ' DB 접속
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                vntData = .mobjSCGLSql.SQLSelectArr(strSQL, intRowCnt, intColCnt, , True)

                Return vntData
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelectRtn_CODE")
            Finally
                ' DB 접속 종료
                .mobjSCGLSql.SQLDisconnect()
            End Try
        End With
    End Function

    Public Function SelectRtn_Contractno(ByVal strYEARMON As String, _
                                         ByVal strGBN As String) As String
        Dim strSQL, strFormat, strRtn As String

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                strSQL = "select   "
                strSQL = strSQL & " '" & strGBN & "' + SUBSTRING('" & strYEARMON & "',3,4) + '-' + CAST(isnull(max(case isnull(contractno,'') when '' then 0 else cast(substring(contractno,7, len(contractno)) as numeric) end) ,0)+1  AS VARCHAR(10))  "
                strSQL = strSQL & " From SC_CONTRACT_MST  "
                strSQL = strSQL & " WHERE GBN = '" & strGBN & "'"
                strSQL = strSQL & " AND SUBSTRING(CONTRACTDAY,1,6) = '" & strYEARMON & "'  "
                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)
                Return strRtn
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_NewSeqNo")
            End Try
        End With
    End Function


    Public Function SelectRtn_SEQ() As String
        Dim strSQL, strFormat, strRtn As String

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                strSQL = "select   "
                strSQL = strSQL & " ISNULL(MAX(seq),0)+1  "
                strSQL = strSQL & " From SC_CONTRACT_MST  "
                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)
                Return strRtn
            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".Get_NewSeqNo")
            End Try
        End With
    End Function

    Public Function ProcessRtn(ByVal strInfoXML As String, _
                               ByVal strMasterXML As String) As Object

        Dim intRtn As Integer
        Dim i, intColCnt, intRows As Integer
        Dim strCONTRACTNO As String
        Dim strSTDATE, strEDDATE, strCONTRACTDAY
        Dim strGBN
        Dim strSEQ
        Dim strCONFIRMUSER

        SetConfig(strInfoXML)
        With mobjSCGLConfig
            Try
                Dim xmlRoot As XmlElement
                xmlRoot = XMLGetRoot(strMasterXML) 'XML 데이터

                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()


                '''사용할 Entity 개체생성(Config 정보를 넘겨생성)
                mobjceSC_CONTRACT_MST = New ceSC_CONTRACT_MST(mobjSCGLConfig)
                '''vntData의 컬럼수, 로우수를 변수입력
                strSTDATE = ""
                strEDDATE = ""
                strCONTRACTDAY = ""
                strCONFIRMUSER = ""

                If XMLGetElement(xmlRoot, "STDATE") <> "" Then strSTDATE = XMLGetElement(xmlRoot, "STDATE").Substring(0, 4) & XMLGetElement(xmlRoot, "STDATE").Substring(5, 2) & XMLGetElement(xmlRoot, "STDATE").Substring(8, 2)
                If XMLGetElement(xmlRoot, "EDDATE") <> "" Then strEDDATE = XMLGetElement(xmlRoot, "EDDATE").Substring(0, 4) & XMLGetElement(xmlRoot, "EDDATE").Substring(5, 2) & XMLGetElement(xmlRoot, "EDDATE").Substring(8, 2)
                If XMLGetElement(xmlRoot, "CONTRACTDAY") <> "" Then strCONTRACTDAY = XMLGetElement(xmlRoot, "CONTRACTDAY").Substring(0, 4) & XMLGetElement(xmlRoot, "CONTRACTDAY").Substring(5, 2) & XMLGetElement(xmlRoot, "CONTRACTDAY").Substring(8, 2)

                If XMLGetElement(xmlRoot, "SEQ") = "" Then
                    strGBN = XMLGetElement(xmlRoot, "GBN")
                    strSEQ = SelectRtn_SEQ()
                    intRtn = InsertRtn_CONTRACT_MST(xmlRoot, strSEQ, strSTDATE, strEDDATE, strCONTRACTDAY)
                Else
                    strSEQ = XMLGetElement(xmlRoot, "SEQ")

                    strCONFIRMUSER = XMLGetElement(xmlRoot, "CONFIRM_USER")

                    strCONFIRMUSER = SelecRtn_CONFIRMUSER(strCONFIRMUSER)

                    intRtn = UpdateRtn_CONTRACT_MST(xmlRoot, strSEQ, strSTDATE, strEDDATE, strCONTRACTDAY, strCONFIRMUSER)
                End If


                .mobjSCGLSql.SQLCommitTrans()
                Return intRows
            Catch err As Exception
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & ".ProcessRtn_CODE")
            Finally
                .mobjSCGLSql.SQLDisconnect()
                mobjceSC_CONTRACT_MST.Dispose()
            End Try
        End With
    End Function

    '=================== 부킹 신규 시퀀스 생성
    Public Function SelecRtn_CONFIRMUSER(ByRef strCONFIRMUSER As String) As String
        '여기부터 단순조회
        Dim strSQL, strFormat, strRtn As String

        With mobjSCGLConfig '기본정보 Config 개체
            Try
                strSQL = " SELECT DBO.SC_EMPNO_FUN('" & strCONFIRMUSER & "') "

                strRtn = .mobjSCGLSql.SQLSelectOneScalar(strSQL)

                Return strRtn

            Catch err As Exception
                ' 오류 전송
                Throw RaiseSysErr(err, CLASS_NAME & ".SelecRtn_CONFIRMUSER")
            Finally
            End Try
        End With
        '여기까지 단순조회
    End Function

    Public Function ProcessRtn_CONFOK(ByVal strInfoXML As String, _
                                      ByVal strSEQ As String, _
                                      ByVal strGBN As String, _
                                      ByVal strYEARMON As String) As Integer


        Dim intRtn_desc As Integer      'Return변수( 처리건수 또는 0 )
        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )
        Dim strCONTRACTNO

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceSC_CONTRACT_MST = New ceSC_CONTRACT_MST(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출

                strCONTRACTNO = SelectRtn_Contractno(strYEARMON, strGBN)

                intRtn = mobjceSC_CONTRACT_MST.Update_ConfOK(strSEQ, strCONTRACTNO)
                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "DeleteRtn_DTL")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceSC_CONTRACT_MST.Dispose()
            End Try
        End With
    End Function

    '승인 취소
    Public Function ProcessRtn_CONFCAN(ByVal strInfoXML As String, _
                                       ByVal strSEQ As String) As Integer


        Dim intRtn_desc As Integer      'Return변수( 처리건수 또는 0 )
        Dim intRtn As Integer      'Return변수( 처리건수 또는 0 )
        Dim strCONTRACTNO

        SetConfig(strInfoXML)    '기본정보 Setting
        With mobjSCGLConfig    '기본정보 Config 개체
            Try
                ' 사용할Entity 개체생성(Config 정보를 넘겨생성)
                mobjceSC_CONTRACT_MST = New ceSC_CONTRACT_MST(mobjSCGLConfig)
                ' DB 접속 및 트랜잭션 시작
                .mobjSCGLSql.SQLConnect(.DBConnStr)
                .mobjSCGLSql.SQLBeginTrans()
                ' 엔티티 오브젝트의 Delete 메소드 호출



                intRtn = mobjceSC_CONTRACT_MST.Update_ConfCAN(strSEQ)
                ' 트랜잭션 Commit
                .mobjSCGLSql.SQLCommitTrans()
                Return intRtn
            Catch err As Exception
                '트랜잭션 RollBack 및 오류 전송
                .mobjSCGLSql.SQLRollbackTrans()
                Throw RaiseSysErr(err, CLASS_NAME & "ProcessRtn_CONFCAN")
            Finally
                'DB접속 종료
                .mobjSCGLSql.SQLDisconnect()
                '사용한 Entity(개체Dispose)
                mobjceSC_CONTRACT_MST.Dispose()
            End Try
        End With
    End Function
#End Region

#Region "GROUP BLOCK : 외부에 비공개 Method"
    Private Function InsertRtn_CONTRACT_MST(ByVal xmlRoot As XmlElement, _
                                            ByVal strSEQ As Double, _
                                            ByVal strSTDATE As String, _
                                            ByVal strEDDATE As String, _
                                            ByVal strCONTRACTDAY As String) As Integer

        Dim intRtn As Integer
        intRtn = mobjceSC_CONTRACT_MST.InsertDo( _
                                        strSEQ, _
                                        XMLGetElement(xmlRoot, "CUSTCODE"), _
                                        XMLGetElement(xmlRoot, "CUSTNAME"), _
                                        XMLGetElement(xmlRoot, "CONTRACTNO"), _
                                        XMLGetElement(xmlRoot, "CONTRACTNAME"), _
                                        XMLGetElement(xmlRoot, "GBN"), _
                                        XMLGetElement(xmlRoot, "AMT", NULL_NUM, True), _
                                        strSTDATE, _
                                        strEDDATE, _
                                        strCONTRACTDAY, _
                                        "N", _
                                        "", _
                                        "", _
                                       XMLGetElement(xmlRoot, "MEMO"), _
                                       XMLGetElement(xmlRoot, "CONDITION"), _
                                       XMLGetElement(xmlRoot, "ATTR01"), _
                                       XMLGetElement(xmlRoot, "ATTR02"), _
                                       XMLGetElement(xmlRoot, "ATTR03"), _
                                       XMLGetElement(xmlRoot, "ATTR04"), _
                                       XMLGetElement(xmlRoot, "ATTR05"), _
                                       XMLGetElement(xmlRoot, "ATTR06", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR07", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR08", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR09", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR10", NULL_NUM, True))

        Return intRtn
    End Function

    Private Function UpdateRtn_CONTRACT_MST(ByVal xmlRoot As XmlElement, _
                                            ByVal strSEQ As Double, _
                                            ByVal strSTDATE As String, _
                                            ByVal strEDDATE As String, _
                                            ByVal strCONTRACTDAY As String, _
                                            ByVal strCONFIRMUSER As String) As Integer

        Dim intRtn As Integer
        intRtn = mobjceSC_CONTRACT_MST.UpdateDo( _
                                       strSEQ, _
                                       XMLGetElement(xmlRoot, "CUSTCODE"), _
                                       XMLGetElement(xmlRoot, "CUSTNAME"), _
                                       XMLGetElement(xmlRoot, "CONTRACTNO"), _
                                       XMLGetElement(xmlRoot, "CONTRACTNAME"), _
                                       XMLGetElement(xmlRoot, "GBN"), _
                                       XMLGetElement(xmlRoot, "AMT", NULL_NUM, True), _
                                       strSTDATE, _
                                       strEDDATE, _
                                       strCONTRACTDAY, _
                                       XMLGetElement(xmlRoot, "CONFIRMFLAG"), _
                                       XMLGetElement(xmlRoot, "CONFIRMDATE"), _
                                       strCONFIRMUSER, _
                                       XMLGetElement(xmlRoot, "MEMO"), _
                                       XMLGetElement(xmlRoot, "CONDITION"), _
                                       XMLGetElement(xmlRoot, "ATTR01"), _
                                       XMLGetElement(xmlRoot, "ATTR02"), _
                                       XMLGetElement(xmlRoot, "ATTR03"), _
                                       XMLGetElement(xmlRoot, "ATTR04"), _
                                       XMLGetElement(xmlRoot, "ATTR05"), _
                                       XMLGetElement(xmlRoot, "ATTR06", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR07", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR08", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR09", NULL_NUM, True), _
                                       XMLGetElement(xmlRoot, "ATTR10", NULL_NUM, True))
        Return intRtn


    End Function
#End Region
End Class

